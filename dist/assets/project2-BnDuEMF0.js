import{j as pe,U as Je,k as ee,l as Zr,m as jr,n as qr,o as Kr,p as Ft,q as P,r as Lt,S as xi,s as Jr,M as A,L as yi,t as li,u as Gt,v as xt,F as ea,E as Sn,w as Ps,N as Ds,x as It,P as Di,y as ta,z as jt,H as $n,I as Rs,J as ks,K as Ae,X as Yn,Y as Os,V as R,g as ia,Q as Me,Z as Fs,_ as Ki,$ as Tn,a0 as Ls,a1 as oe,B as te,a2 as Xn,a3 as hi,a4 as ze,a5 as na,a6 as zt,a7 as sa,a8 as Is,a9 as Qn,c as wi,W as Bs,A as zs,D as Us,aa as Ns,G as Hs,C as ra}from"./GLTFLoader-4R7RM90X.js";function Ue(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Gs(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.__proto__=e}/*!
 * GSAP 3.12.3
 * https://gsap.com
 *
 * @license Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var _e={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Ct={duration:.5,overwrite:!1,delay:0},En,se,X,Se=1e8,N=1/Se,Ji=Math.PI*2,aa=Ji/4,oa=0,Vs=Math.sqrt,la=Math.cos,ha=Math.sin,J=function(e){return typeof e=="string"},Q=function(e){return typeof e=="function"},He=function(e){return typeof e=="number"},An=function(e){return typeof e>"u"},Ie=function(e){return typeof e=="object"},le=function(e){return e!==!1},Mn=function(){return typeof window<"u"},ci=function(e){return Q(e)||J(e)},$s=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},re=Array.isArray,en=/(?:-?\.?\d|\.)+/gi,Ys=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,St=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,zi=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,Xs=/[+-]=-?[.\d]+/,Qs=/[^,'"\[\]\s]+/gi,ca=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,$,be,tn,Cn,ve={},bi={},Ws,Zs=function(e){return(bi=_t(e,ve))&&de},Pn=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},qt=function(e,t){return!t&&console.warn(e)},js=function(e,t){return e&&(ve[e]=t)&&bi&&(bi[e]=t)||ve},Kt=function(){return 0},ua={suppressEvents:!0,isStart:!0,kill:!1},mi={suppressEvents:!0,kill:!1},da={suppressEvents:!0},Dn={},We=[],nn={},qs,fe={},Ui={},Wn=30,gi=[],Rn="",kn=function(e){var t=e[0],i,s;if(Ie(t)||Q(t)||(e=[e]),!(i=(t._gsap||{}).harness)){for(s=gi.length;s--&&!gi[s].targetTest(t););i=gi[s]}for(s=e.length;s--;)e[s]&&(e[s]._gsap||(e[s]._gsap=new wr(e[s],i)))||e.splice(s,1);return e},ft=function(e){return e._gsap||kn(Te(e))[0]._gsap},Ks=function(e,t,i){return(i=e[t])&&Q(i)?e[t]():An(i)&&e.getAttribute&&e.getAttribute(t)||i},he=function(e,t){return(e=e.split(",")).forEach(t)||e},W=function(e){return Math.round(e*1e5)/1e5||0},K=function(e){return Math.round(e*1e7)/1e7||0},Et=function(e,t){var i=t.charAt(0),s=parseFloat(t.substr(2));return e=parseFloat(e),i==="+"?e+s:i==="-"?e-s:i==="*"?e*s:e/s},fa=function(e,t){for(var i=t.length,s=0;e.indexOf(t[s])<0&&++s<i;);return s<i},Si=function(){var e=We.length,t=We.slice(0),i,s;for(nn={},We.length=0,i=0;i<e;i++)s=t[i],s&&s._lazy&&(s.render(s._lazy[0],s._lazy[1],!0)._lazy=0)},Js=function(e,t,i,s){We.length&&!se&&Si(),e.render(t,i,se&&t<0&&(e._initted||e._startAt)),We.length&&!se&&Si()},er=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(Qs).length<2?t:J(e)?e.trim():e},tr=function(e){return e},Ee=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},pa=function(e){return function(t,i){for(var s in i)s in t||s==="duration"&&e||s==="ease"||(t[s]=i[s])}},_t=function(e,t){for(var i in t)e[i]=t[i];return e},Zn=function n(e,t){for(var i in t)i!=="__proto__"&&i!=="constructor"&&i!=="prototype"&&(e[i]=Ie(t[i])?n(e[i]||(e[i]={}),t[i]):t[i]);return e},Ti=function(e,t){var i={},s;for(s in e)s in t||(i[s]=e[s]);return i},Qt=function(e){var t=e.parent||$,i=e.keyframes?pa(re(e.keyframes)):Ee;if(le(e.inherit))for(;t;)i(e,t.vars.defaults),t=t.parent||t._dp;return e},ma=function(e,t){for(var i=e.length,s=i===t.length;s&&i--&&e[i]===t[i];);return i<0},ir=function(e,t,i,s,r){var a=e[s],o;if(r)for(o=t[r];a&&a[r]>o;)a=a._prev;return a?(t._next=a._next,a._next=t):(t._next=e[i],e[i]=t),t._next?t._next._prev=t:e[s]=t,t._prev=a,t.parent=t._dp=e,t},Ri=function(e,t,i,s){i===void 0&&(i="_first"),s===void 0&&(s="_last");var r=t._prev,a=t._next;r?r._next=a:e[i]===t&&(e[i]=a),a?a._prev=r:e[s]===t&&(e[s]=r),t._next=t._prev=t.parent=null},et=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},pt=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var i=e;i;)i._dirty=1,i=i.parent;return e},ga=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},sn=function(e,t,i,s){return e._startAt&&(se?e._startAt.revert(mi):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,s))},_a=function n(e){return!e||e._ts&&n(e.parent)},jn=function(e){return e._repeat?Pt(e._tTime,e=e.duration()+e._rDelay)*e:0},Pt=function(e,t){var i=Math.floor(e/=t);return e&&i===e?i-1:i},Ei=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},ki=function(e){return e._end=K(e._start+(e._tDur/Math.abs(e._ts||e._rts||N)||0))},Oi=function(e,t){var i=e._dp;return i&&i.smoothChildTiming&&e._ts&&(e._start=K(i._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),ki(e),i._dirty||pt(i,e)),e},nr=function(e,t){var i;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(i=Ei(e.rawTime(),t),(!t._dur||ai(0,t.totalDuration(),i)-t._tTime>N)&&t.render(i,!0)),pt(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(i=e;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;e._zTime=-N}},Re=function(e,t,i,s){return t.parent&&et(t),t._start=K((He(i)?i:i||e!==$?we(e,i,t):e._time)+t._delay),t._end=K(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),ir(e,t,"_first","_last",e._sort?"_start":0),rn(t)||(e._recent=t),s||nr(e,t),e._ts<0&&Oi(e,e._tTime),e},sr=function(e,t){return(ve.ScrollTrigger||Pn("scrollTrigger",t))&&ve.ScrollTrigger.create(t,e)},rr=function(e,t,i,s,r){if(Fn(e,t,r),!e._initted)return 1;if(!i&&e._pt&&!se&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&qs!==me.frame)return We.push(e),e._lazy=[r,s],1},va=function n(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||n(t))},rn=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},xa=function(e,t,i,s){var r=e.ratio,a=t<0||!t&&(!e._start&&va(e)&&!(!e._initted&&rn(e))||(e._ts<0||e._dp._ts<0)&&!rn(e))?0:1,o=e._rDelay,l=0,h,c,d;if(o&&e._repeat&&(l=ai(0,e._tDur,t),c=Pt(l,o),e._yoyo&&c&1&&(a=1-a),c!==Pt(e._tTime,o)&&(r=1-a,e.vars.repeatRefresh&&e._initted&&e.invalidate())),a!==r||se||s||e._zTime===N||!t&&e._zTime){if(!e._initted&&rr(e,t,s,i,l))return;for(d=e._zTime,e._zTime=t||(i?N:0),i||(i=t&&!d),e.ratio=a,e._from&&(a=1-a),e._time=0,e._tTime=l,h=e._pt;h;)h.r(a,h.d),h=h._next;t<0&&sn(e,t,i,!0),e._onUpdate&&!i&&ge(e,"onUpdate"),l&&e._repeat&&!i&&e.parent&&ge(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===a&&(a&&et(e,1),!i&&!se&&(ge(e,a?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},ya=function(e,t,i){var s;if(i>t)for(s=e._first;s&&s._start<=i;){if(s.data==="isPause"&&s._start>t)return s;s=s._next}else for(s=e._last;s&&s._start>=i;){if(s.data==="isPause"&&s._start<t)return s;s=s._prev}},Dt=function(e,t,i,s){var r=e._repeat,a=K(t)||0,o=e._tTime/e._tDur;return o&&!s&&(e._time*=a/e._dur),e._dur=a,e._tDur=r?r<0?1e10:K(a*(r+1)+e._rDelay*r):a,o>0&&!s&&Oi(e,e._tTime=e._tDur*o),e.parent&&ki(e),i||pt(e.parent,e),e},qn=function(e){return e instanceof ae?pt(e):Dt(e,e._dur)},wa={_start:0,endTime:Kt,totalDuration:Kt},we=function n(e,t,i){var s=e.labels,r=e._recent||wa,a=e.duration()>=Se?r.endTime(!1):e._dur,o,l,h;return J(t)&&(isNaN(t)||t in s)?(l=t.charAt(0),h=t.substr(-1)==="%",o=t.indexOf("="),l==="<"||l===">"?(o>=0&&(t=t.replace(/=/,"")),(l==="<"?r._start:r.endTime(r._repeat>=0))+(parseFloat(t.substr(1))||0)*(h?(o<0?r:i).totalDuration()/100:1)):o<0?(t in s||(s[t]=a),s[t]):(l=parseFloat(t.charAt(o-1)+t.substr(o+1)),h&&i&&(l=l/100*(re(i)?i[0]:i).totalDuration()),o>1?n(e,t.substr(0,o-1),i)+l:a+l)):t==null?a:+t},Wt=function(e,t,i){var s=He(t[1]),r=(s?2:1)+(e<2?0:1),a=t[r],o,l;if(s&&(a.duration=t[1]),a.parent=i,e){for(o=a,l=i;l&&!("immediateRender"in o);)o=l.vars.defaults||{},l=le(l.vars.inherit)&&l.parent;a.immediateRender=le(o.immediateRender),e<2?a.runBackwards=1:a.startAt=t[r-1]}return new Z(t[0],a,t[r+1])},it=function(e,t){return e||e===0?t(e):t},ai=function(e,t,i){return i<e?e:i>t?t:i},ne=function(e,t){return!J(e)||!(t=ca.exec(e))?"":t[1]},ba=function(e,t,i){return it(i,function(s){return ai(e,t,s)})},an=[].slice,ar=function(e,t){return e&&Ie(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&Ie(e[0]))&&!e.nodeType&&e!==be},Sa=function(e,t,i){return i===void 0&&(i=[]),e.forEach(function(s){var r;return J(s)&&!t||ar(s,1)?(r=i).push.apply(r,Te(s)):i.push(s)})||i},Te=function(e,t,i){return X&&!t&&X.selector?X.selector(e):J(e)&&!i&&(tn||!Rt())?an.call((t||Cn).querySelectorAll(e),0):re(e)?Sa(e,i):ar(e)?an.call(e,0):e?[e]:[]},on=function(e){return e=Te(e)[0]||qt("Invalid scope")||{},function(t){var i=e.current||e.nativeElement||e;return Te(t,i.querySelectorAll?i:i===e?qt("Invalid scope")||Cn.createElement("div"):e)}},or=function(e){return e.sort(function(){return .5-Math.random()})},lr=function(e){if(Q(e))return e;var t=Ie(e)?e:{each:e},i=mt(t.ease),s=t.from||0,r=parseFloat(t.base)||0,a={},o=s>0&&s<1,l=isNaN(s)||o,h=t.axis,c=s,d=s;return J(s)?c=d={center:.5,edges:.5,end:1}[s]||0:!o&&l&&(c=s[0],d=s[1]),function(f,p,m){var u=(m||t).length,g=a[u],x,_,v,w,y,S,T,E,b;if(!g){if(b=t.grid==="auto"?0:(t.grid||[1,Se])[1],!b){for(T=-Se;T<(T=m[b++].getBoundingClientRect().left)&&b<u;);b<u&&b--}for(g=a[u]=[],x=l?Math.min(b,u)*c-.5:s%b,_=b===Se?0:l?u*d/b-.5:s/b|0,T=0,E=Se,S=0;S<u;S++)v=S%b-x,w=_-(S/b|0),g[S]=y=h?Math.abs(h==="y"?w:v):Vs(v*v+w*w),y>T&&(T=y),y<E&&(E=y);s==="random"&&or(g),g.max=T-E,g.min=E,g.v=u=(parseFloat(t.amount)||parseFloat(t.each)*(b>u?u-1:h?h==="y"?u/b:b:Math.max(b,u/b))||0)*(s==="edges"?-1:1),g.b=u<0?r-u:r,g.u=ne(t.amount||t.each)||0,i=i&&u<0?vr(i):i}return u=(g[f]-g.min)/g.max||0,K(g.b+(i?i(u):u)*g.v)+g.u}},ln=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(i){var s=K(Math.round(parseFloat(i)/e)*e*t);return(s-s%1)/t+(He(i)?0:ne(i))}},hr=function(e,t){var i=re(e),s,r;return!i&&Ie(e)&&(s=i=e.radius||Se,e.values?(e=Te(e.values),(r=!He(e[0]))&&(s*=s)):e=ln(e.increment)),it(t,i?Q(e)?function(a){return r=e(a),Math.abs(r-a)<=s?r:a}:function(a){for(var o=parseFloat(r?a.x:a),l=parseFloat(r?a.y:0),h=Se,c=0,d=e.length,f,p;d--;)r?(f=e[d].x-o,p=e[d].y-l,f=f*f+p*p):f=Math.abs(e[d]-o),f<h&&(h=f,c=d);return c=!s||h<=s?e[c]:a,r||c===a||He(a)?c:c+ne(a)}:ln(e))},cr=function(e,t,i,s){return it(re(e)?!t:i===!0?!!(i=0):!s,function(){return re(e)?e[~~(Math.random()*e.length)]:(i=i||1e-5)&&(s=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((e-i/2+Math.random()*(t-e+i*.99))/i)*i*s)/s})},Ta=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(s){return t.reduce(function(r,a){return a(r)},s)}},Ea=function(e,t){return function(i){return e(parseFloat(i))+(t||ne(i))}},Aa=function(e,t,i){return dr(e,t,0,1,i)},ur=function(e,t,i){return it(i,function(s){return e[~~t(s)]})},Ma=function n(e,t,i){var s=t-e;return re(e)?ur(e,n(0,e.length),t):it(i,function(r){return(s+(r-e)%s)%s+e})},Ca=function n(e,t,i){var s=t-e,r=s*2;return re(e)?ur(e,n(0,e.length-1),t):it(i,function(a){return a=(r+(a-e)%r)%r||0,e+(a>s?r-a:a)})},Jt=function(e){for(var t=0,i="",s,r,a,o;~(s=e.indexOf("random(",t));)a=e.indexOf(")",s),o=e.charAt(s+7)==="[",r=e.substr(s+7,a-s-7).match(o?Qs:en),i+=e.substr(t,s-t)+cr(o?r:+r[0],o?0:+r[1],+r[2]||1e-5),t=a+1;return i+e.substr(t,e.length-t)},dr=function(e,t,i,s,r){var a=t-e,o=s-i;return it(r,function(l){return i+((l-e)/a*o||0)})},Pa=function n(e,t,i,s){var r=isNaN(e+t)?0:function(p){return(1-p)*e+p*t};if(!r){var a=J(e),o={},l,h,c,d,f;if(i===!0&&(s=1)&&(i=null),a)e={p:e},t={p:t};else if(re(e)&&!re(t)){for(c=[],d=e.length,f=d-2,h=1;h<d;h++)c.push(n(e[h-1],e[h]));d--,r=function(m){m*=d;var u=Math.min(f,~~m);return c[u](m-u)},i=t}else s||(e=_t(re(e)?[]:{},e));if(!c){for(l in t)On.call(o,e,l,"get",t[l]);r=function(m){return Bn(m,o)||(a?e.p:e)}}}return it(i,r)},Kn=function(e,t,i){var s=e.labels,r=Se,a,o,l;for(a in s)o=s[a]-t,o<0==!!i&&o&&r>(o=Math.abs(o))&&(l=a,r=o);return l},ge=function(e,t,i){var s=e.vars,r=s[t],a=X,o=e._ctx,l,h,c;if(r)return l=s[t+"Params"],h=s.callbackScope||e,i&&We.length&&Si(),o&&(X=o),c=l?r.apply(h,l):r.call(h),X=a,c},Vt=function(e){return et(e),e.scrollTrigger&&e.scrollTrigger.kill(!!se),e.progress()<1&&ge(e,"onInterrupt"),e},Tt,fr=[],pr=function(e){if(Mn()&&e){e=!e.name&&e.default||e;var t=e.name,i=Q(e),s=t&&!i&&e.init?function(){this._props=[]}:e,r={init:Kt,render:Bn,add:On,kill:Ya,modifier:$a,rawVars:0},a={targetTest:0,get:0,getSetter:In,aliases:{},register:0};if(Rt(),e!==s){if(fe[t])return;Ee(s,Ee(Ti(e,r),a)),_t(s.prototype,_t(r,Ti(e,a))),fe[s.prop=t]=s,e.targetTest&&(gi.push(s),Dn[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}js(t,s),e.register&&e.register(de,s,ce)}else e&&fr.push(e)},U=255,$t={aqua:[0,U,U],lime:[0,U,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,U],navy:[0,0,128],white:[U,U,U],olive:[128,128,0],yellow:[U,U,0],orange:[U,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[U,0,0],pink:[U,192,203],cyan:[0,U,U],transparent:[U,U,U,0]},Ni=function(e,t,i){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(i-t)*e*6:e<.5?i:e*3<2?t+(i-t)*(2/3-e)*6:t)*U+.5|0},mr=function(e,t,i){var s=e?He(e)?[e>>16,e>>8&U,e&U]:0:$t.black,r,a,o,l,h,c,d,f,p,m;if(!s){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),$t[e])s=$t[e];else if(e.charAt(0)==="#"){if(e.length<6&&(r=e.charAt(1),a=e.charAt(2),o=e.charAt(3),e="#"+r+r+a+a+o+o+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return s=parseInt(e.substr(1,6),16),[s>>16,s>>8&U,s&U,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),s=[e>>16,e>>8&U,e&U]}else if(e.substr(0,3)==="hsl"){if(s=m=e.match(en),!t)l=+s[0]%360/360,h=+s[1]/100,c=+s[2]/100,a=c<=.5?c*(h+1):c+h-c*h,r=c*2-a,s.length>3&&(s[3]*=1),s[0]=Ni(l+1/3,r,a),s[1]=Ni(l,r,a),s[2]=Ni(l-1/3,r,a);else if(~e.indexOf("="))return s=e.match(Ys),i&&s.length<4&&(s[3]=1),s}else s=e.match(en)||$t.transparent;s=s.map(Number)}return t&&!m&&(r=s[0]/U,a=s[1]/U,o=s[2]/U,d=Math.max(r,a,o),f=Math.min(r,a,o),c=(d+f)/2,d===f?l=h=0:(p=d-f,h=c>.5?p/(2-d-f):p/(d+f),l=d===r?(a-o)/p+(a<o?6:0):d===a?(o-r)/p+2:(r-a)/p+4,l*=60),s[0]=~~(l+.5),s[1]=~~(h*100+.5),s[2]=~~(c*100+.5)),i&&s.length<4&&(s[3]=1),s},gr=function(e){var t=[],i=[],s=-1;return e.split(Ze).forEach(function(r){var a=r.match(St)||[];t.push.apply(t,a),i.push(s+=a.length+1)}),t.c=i,t},Jn=function(e,t,i){var s="",r=(e+s).match(Ze),a=t?"hsla(":"rgba(",o=0,l,h,c,d;if(!r)return e;if(r=r.map(function(f){return(f=mr(f,t,1))&&a+(t?f[0]+","+f[1]+"%,"+f[2]+"%,"+f[3]:f.join(","))+")"}),i&&(c=gr(e),l=i.c,l.join(s)!==c.c.join(s)))for(h=e.replace(Ze,"1").split(St),d=h.length-1;o<d;o++)s+=h[o]+(~l.indexOf(o)?r.shift()||a+"0,0,0,0)":(c.length?c:r.length?r:i).shift());if(!h)for(h=e.split(Ze),d=h.length-1;o<d;o++)s+=h[o]+r[o];return s+h[d]},Ze=function(){var n="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in $t)n+="|"+e+"\\b";return new RegExp(n+")","gi")}(),Da=/hsl[a]?\(/,_r=function(e){var t=e.join(" "),i;if(Ze.lastIndex=0,Ze.test(t))return i=Da.test(t),e[1]=Jn(e[1],i),e[0]=Jn(e[0],i,gr(e[1])),!0},ei,me=function(){var n=Date.now,e=500,t=33,i=n(),s=i,r=1e3/240,a=r,o=[],l,h,c,d,f,p,m=function u(g){var x=n()-s,_=g===!0,v,w,y,S;if(x>e&&(i+=x-t),s+=x,y=s-i,v=y-a,(v>0||_)&&(S=++d.frame,f=y-d.time*1e3,d.time=y=y/1e3,a+=v+(v>=r?4:r-v),w=1),_||(l=h(u)),w)for(p=0;p<o.length;p++)o[p](y,f,S,g)};return d={time:0,frame:0,tick:function(){m(!0)},deltaRatio:function(g){return f/(1e3/(g||60))},wake:function(){Ws&&(!tn&&Mn()&&(be=tn=window,Cn=be.document||{},ve.gsap=de,(be.gsapVersions||(be.gsapVersions=[])).push(de.version),Zs(bi||be.GreenSockGlobals||!be.gsap&&be||{}),c=be.requestAnimationFrame,fr.forEach(pr)),l&&d.sleep(),h=c||function(g){return setTimeout(g,a-d.time*1e3+1|0)},ei=1,m(2))},sleep:function(){(c?be.cancelAnimationFrame:clearTimeout)(l),ei=0,h=Kt},lagSmoothing:function(g,x){e=g||1/0,t=Math.min(x||33,e)},fps:function(g){r=1e3/(g||240),a=d.time*1e3+r},add:function(g,x,_){var v=x?function(w,y,S,T){g(w,y,S,T),d.remove(v)}:g;return d.remove(g),o[_?"unshift":"push"](v),Rt(),v},remove:function(g,x){~(x=o.indexOf(g))&&o.splice(x,1)&&p>=x&&p--},_listeners:o},d}(),Rt=function(){return!ei&&me.wake()},C={},Ra=/^[\d.\-M][\d.\-,\s]/,ka=/["']/g,Oa=function(e){for(var t={},i=e.substr(1,e.length-3).split(":"),s=i[0],r=1,a=i.length,o,l,h;r<a;r++)l=i[r],o=r!==a-1?l.lastIndexOf(","):l.length,h=l.substr(0,o),t[s]=isNaN(h)?h.replace(ka,"").trim():+h,s=l.substr(o+1).trim();return t},Fa=function(e){var t=e.indexOf("(")+1,i=e.indexOf(")"),s=e.indexOf("(",t);return e.substring(t,~s&&s<i?e.indexOf(")",i+1):i)},La=function(e){var t=(e+"").split("("),i=C[t[0]];return i&&t.length>1&&i.config?i.config.apply(null,~e.indexOf("{")?[Oa(t[1])]:Fa(e).split(",").map(er)):C._CE&&Ra.test(e)?C._CE("",e):i},vr=function(e){return function(t){return 1-e(1-t)}},xr=function n(e,t){for(var i=e._first,s;i;)i instanceof ae?n(i,t):i.vars.yoyoEase&&(!i._yoyo||!i._repeat)&&i._yoyo!==t&&(i.timeline?n(i.timeline,t):(s=i._ease,i._ease=i._yEase,i._yEase=s,i._yoyo=t)),i=i._next},mt=function(e,t){return e&&(Q(e)?e:C[e]||La(e))||t},yt=function(e,t,i,s){i===void 0&&(i=function(l){return 1-t(1-l)}),s===void 0&&(s=function(l){return l<.5?t(l*2)/2:1-t((1-l)*2)/2});var r={easeIn:t,easeOut:i,easeInOut:s},a;return he(e,function(o){C[o]=ve[o]=r,C[a=o.toLowerCase()]=i;for(var l in r)C[a+(l==="easeIn"?".in":l==="easeOut"?".out":".inOut")]=C[o+"."+l]=r[l]}),r},yr=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},Hi=function n(e,t,i){var s=t>=1?t:1,r=(i||(e?.3:.45))/(t<1?t:1),a=r/Ji*(Math.asin(1/s)||0),o=function(c){return c===1?1:s*Math.pow(2,-10*c)*ha((c-a)*r)+1},l=e==="out"?o:e==="in"?function(h){return 1-o(1-h)}:yr(o);return r=Ji/r,l.config=function(h,c){return n(e,h,c)},l},Gi=function n(e,t){t===void 0&&(t=1.70158);var i=function(a){return a?--a*a*((t+1)*a+t)+1:0},s=e==="out"?i:e==="in"?function(r){return 1-i(1-r)}:yr(i);return s.config=function(r){return n(e,r)},s};he("Linear,Quad,Cubic,Quart,Quint,Strong",function(n,e){var t=e<5?e+1:e;yt(n+",Power"+(t-1),e?function(i){return Math.pow(i,t)}:function(i){return i},function(i){return 1-Math.pow(1-i,t)},function(i){return i<.5?Math.pow(i*2,t)/2:1-Math.pow((1-i)*2,t)/2})});C.Linear.easeNone=C.none=C.Linear.easeIn;yt("Elastic",Hi("in"),Hi("out"),Hi());(function(n,e){var t=1/e,i=2*t,s=2.5*t,r=function(o){return o<t?n*o*o:o<i?n*Math.pow(o-1.5/e,2)+.75:o<s?n*(o-=2.25/e)*o+.9375:n*Math.pow(o-2.625/e,2)+.984375};yt("Bounce",function(a){return 1-r(1-a)},r)})(7.5625,2.75);yt("Expo",function(n){return n?Math.pow(2,10*(n-1)):0});yt("Circ",function(n){return-(Vs(1-n*n)-1)});yt("Sine",function(n){return n===1?1:-la(n*aa)+1});yt("Back",Gi("in"),Gi("out"),Gi());C.SteppedEase=C.steps=ve.SteppedEase={config:function(e,t){e===void 0&&(e=1);var i=1/e,s=e+(t?0:1),r=t?1:0,a=1-N;return function(o){return((s*ai(0,a,o)|0)+r)*i}}};Ct.ease=C["quad.out"];he("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(n){return Rn+=n+","+n+"Params,"});var wr=function(e,t){this.id=oa++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:Ks,this.set=t?t.getSetter:In},ti=function(){function n(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,Dt(this,+t.duration,1,1),this.data=t.data,X&&(this._ctx=X,X.data.push(this)),ei||me.wake()}var e=n.prototype;return e.delay=function(i){return i||i===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+i-this._delay),this._delay=i,this):this._delay},e.duration=function(i){return arguments.length?this.totalDuration(this._repeat>0?i+(i+this._rDelay)*this._repeat:i):this.totalDuration()&&this._dur},e.totalDuration=function(i){return arguments.length?(this._dirty=0,Dt(this,this._repeat<0?i:(i-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(i,s){if(Rt(),!arguments.length)return this._tTime;var r=this._dp;if(r&&r.smoothChildTiming&&this._ts){for(Oi(this,i),!r._dp||r.parent||nr(r,this);r&&r.parent;)r.parent._time!==r._start+(r._ts>=0?r._tTime/r._ts:(r.totalDuration()-r._tTime)/-r._ts)&&r.totalTime(r._tTime,!0),r=r.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&i<this._tDur||this._ts<0&&i>0||!this._tDur&&!i)&&Re(this._dp,this,this._start-this._delay)}return(this._tTime!==i||!this._dur&&!s||this._initted&&Math.abs(this._zTime)===N||!i&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=i),Js(this,i,s)),this},e.time=function(i,s){return arguments.length?this.totalTime(Math.min(this.totalDuration(),i+jn(this))%(this._dur+this._rDelay)||(i?this._dur:0),s):this._time},e.totalProgress=function(i,s){return arguments.length?this.totalTime(this.totalDuration()*i,s):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},e.progress=function(i,s){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-i:i)+jn(this),s):this.duration()?Math.min(1,this._time/this._dur):this.ratio},e.iteration=function(i,s){var r=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(i-1)*r,s):this._repeat?Pt(this._tTime,r)+1:1},e.timeScale=function(i,s){if(!arguments.length)return this._rts===-N?0:this._rts;if(this._rts===i)return this;var r=this.parent&&this._ts?Ei(this.parent._time,this):this._tTime;return this._rts=+i||0,this._ts=this._ps||i===-N?0:this._rts,this.totalTime(ai(-Math.abs(this._delay),this._tDur,r),s!==!1),ki(this),ga(this)},e.paused=function(i){return arguments.length?(this._ps!==i&&(this._ps=i,i?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Rt(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==N&&(this._tTime-=N)))),this):this._ps},e.startTime=function(i){if(arguments.length){this._start=i;var s=this.parent||this._dp;return s&&(s._sort||!this.parent)&&Re(s,this,i-this._delay),this}return this._start},e.endTime=function(i){return this._start+(le(i)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(i){var s=this.parent||this._dp;return s?i&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Ei(s.rawTime(i),this):this._tTime:this._tTime},e.revert=function(i){i===void 0&&(i=da);var s=se;return se=i,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(i),this.totalTime(-.01,i.suppressEvents)),this.data!=="nested"&&i.kill!==!1&&this.kill(),se=s,this},e.globalTime=function(i){for(var s=this,r=arguments.length?i:s.rawTime();s;)r=s._start+r/(Math.abs(s._ts)||1),s=s._dp;return!this.parent&&this._sat?this._sat.globalTime(i):r},e.repeat=function(i){return arguments.length?(this._repeat=i===1/0?-2:i,qn(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(i){if(arguments.length){var s=this._time;return this._rDelay=i,qn(this),s?this.time(s):this}return this._rDelay},e.yoyo=function(i){return arguments.length?(this._yoyo=i,this):this._yoyo},e.seek=function(i,s){return this.totalTime(we(this,i),le(s))},e.restart=function(i,s){return this.play().totalTime(i?-this._delay:0,le(s))},e.play=function(i,s){return i!=null&&this.seek(i,s),this.reversed(!1).paused(!1)},e.reverse=function(i,s){return i!=null&&this.seek(i||this.totalDuration(),s),this.reversed(!0).paused(!1)},e.pause=function(i,s){return i!=null&&this.seek(i,s),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(i){return arguments.length?(!!i!==this.reversed()&&this.timeScale(-this._rts||(i?-N:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-N,this},e.isActive=function(){var i=this.parent||this._dp,s=this._start,r;return!!(!i||this._ts&&this._initted&&i.isActive()&&(r=i.rawTime(!0))>=s&&r<this.endTime(!0)-N)},e.eventCallback=function(i,s,r){var a=this.vars;return arguments.length>1?(s?(a[i]=s,r&&(a[i+"Params"]=r),i==="onUpdate"&&(this._onUpdate=s)):delete a[i],this):a[i]},e.then=function(i){var s=this;return new Promise(function(r){var a=Q(i)?i:tr,o=function(){var h=s.then;s.then=null,Q(a)&&(a=a(s))&&(a.then||a===s)&&(s.then=h),r(a),s.then=h};s._initted&&s.totalProgress()===1&&s._ts>=0||!s._tTime&&s._ts<0?o():s._prom=o})},e.kill=function(){Vt(this)},n}();Ee(ti.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-N,_prom:0,_ps:!1,_rts:1});var ae=function(n){Gs(e,n);function e(i,s){var r;return i===void 0&&(i={}),r=n.call(this,i)||this,r.labels={},r.smoothChildTiming=!!i.smoothChildTiming,r.autoRemoveChildren=!!i.autoRemoveChildren,r._sort=le(i.sortChildren),$&&Re(i.parent||$,Ue(r),s),i.reversed&&r.reverse(),i.paused&&r.paused(!0),i.scrollTrigger&&sr(Ue(r),i.scrollTrigger),r}var t=e.prototype;return t.to=function(s,r,a){return Wt(0,arguments,this),this},t.from=function(s,r,a){return Wt(1,arguments,this),this},t.fromTo=function(s,r,a,o){return Wt(2,arguments,this),this},t.set=function(s,r,a){return r.duration=0,r.parent=this,Qt(r).repeatDelay||(r.repeat=0),r.immediateRender=!!r.immediateRender,new Z(s,r,we(this,a),1),this},t.call=function(s,r,a){return Re(this,Z.delayedCall(0,s,r),a)},t.staggerTo=function(s,r,a,o,l,h,c){return a.duration=r,a.stagger=a.stagger||o,a.onComplete=h,a.onCompleteParams=c,a.parent=this,new Z(s,a,we(this,l)),this},t.staggerFrom=function(s,r,a,o,l,h,c){return a.runBackwards=1,Qt(a).immediateRender=le(a.immediateRender),this.staggerTo(s,r,a,o,l,h,c)},t.staggerFromTo=function(s,r,a,o,l,h,c,d){return o.startAt=a,Qt(o).immediateRender=le(o.immediateRender),this.staggerTo(s,r,o,l,h,c,d)},t.render=function(s,r,a){var o=this._time,l=this._dirty?this.totalDuration():this._tDur,h=this._dur,c=s<=0?0:K(s),d=this._zTime<0!=s<0&&(this._initted||!h),f,p,m,u,g,x,_,v,w,y,S,T;if(this!==$&&c>l&&s>=0&&(c=l),c!==this._tTime||a||d){if(o!==this._time&&h&&(c+=this._time-o,s+=this._time-o),f=c,w=this._start,v=this._ts,x=!v,d&&(h||(o=this._zTime),(s||!r)&&(this._zTime=s)),this._repeat){if(S=this._yoyo,g=h+this._rDelay,this._repeat<-1&&s<0)return this.totalTime(g*100+s,r,a);if(f=K(c%g),c===l?(u=this._repeat,f=h):(u=~~(c/g),u&&u===c/g&&(f=h,u--),f>h&&(f=h)),y=Pt(this._tTime,g),!o&&this._tTime&&y!==u&&this._tTime-y*g-this._dur<=0&&(y=u),S&&u&1&&(f=h-f,T=1),u!==y&&!this._lock){var E=S&&y&1,b=E===(S&&u&1);if(u<y&&(E=!E),o=E?0:c%h?h:c,this._lock=1,this.render(o||(T?0:K(u*g)),r,!h)._lock=0,this._tTime=c,!r&&this.parent&&ge(this,"onRepeat"),this.vars.repeatRefresh&&!T&&(this.invalidate()._lock=1),o&&o!==this._time||x!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(h=this._dur,l=this._tDur,b&&(this._lock=2,o=E?h:-1e-4,this.render(o,!0),this.vars.repeatRefresh&&!T&&this.invalidate()),this._lock=0,!this._ts&&!x)return this;xr(this,T)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(_=ya(this,K(o),K(f)),_&&(c-=f-(f=_._start))),this._tTime=c,this._time=f,this._act=!v,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=s,o=0),!o&&f&&!r&&!u&&(ge(this,"onStart"),this._tTime!==c))return this;if(f>=o&&s>=0)for(p=this._first;p;){if(m=p._next,(p._act||f>=p._start)&&p._ts&&_!==p){if(p.parent!==this)return this.render(s,r,a);if(p.render(p._ts>0?(f-p._start)*p._ts:(p._dirty?p.totalDuration():p._tDur)+(f-p._start)*p._ts,r,a),f!==this._time||!this._ts&&!x){_=0,m&&(c+=this._zTime=-N);break}}p=m}else{p=this._last;for(var D=s<0?s:f;p;){if(m=p._prev,(p._act||D<=p._end)&&p._ts&&_!==p){if(p.parent!==this)return this.render(s,r,a);if(p.render(p._ts>0?(D-p._start)*p._ts:(p._dirty?p.totalDuration():p._tDur)+(D-p._start)*p._ts,r,a||se&&(p._initted||p._startAt)),f!==this._time||!this._ts&&!x){_=0,m&&(c+=this._zTime=D?-N:N);break}}p=m}}if(_&&!r&&(this.pause(),_.render(f>=o?0:-N)._zTime=f>=o?1:-1,this._ts))return this._start=w,ki(this),this.render(s,r,a);this._onUpdate&&!r&&ge(this,"onUpdate",!0),(c===l&&this._tTime>=this.totalDuration()||!c&&o)&&(w===this._start||Math.abs(v)!==Math.abs(this._ts))&&(this._lock||((s||!h)&&(c===l&&this._ts>0||!c&&this._ts<0)&&et(this,1),!r&&!(s<0&&!o)&&(c||o||!l)&&(ge(this,c===l&&s>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(c<l&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(s,r){var a=this;if(He(r)||(r=we(this,r,s)),!(s instanceof ti)){if(re(s))return s.forEach(function(o){return a.add(o,r)}),this;if(J(s))return this.addLabel(s,r);if(Q(s))s=Z.delayedCall(0,s);else return this}return this!==s?Re(this,s,r):this},t.getChildren=function(s,r,a,o){s===void 0&&(s=!0),r===void 0&&(r=!0),a===void 0&&(a=!0),o===void 0&&(o=-Se);for(var l=[],h=this._first;h;)h._start>=o&&(h instanceof Z?r&&l.push(h):(a&&l.push(h),s&&l.push.apply(l,h.getChildren(!0,r,a)))),h=h._next;return l},t.getById=function(s){for(var r=this.getChildren(1,1,1),a=r.length;a--;)if(r[a].vars.id===s)return r[a]},t.remove=function(s){return J(s)?this.removeLabel(s):Q(s)?this.killTweensOf(s):(Ri(this,s),s===this._recent&&(this._recent=this._last),pt(this))},t.totalTime=function(s,r){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=K(me.time-(this._ts>0?s/this._ts:(this.totalDuration()-s)/-this._ts))),n.prototype.totalTime.call(this,s,r),this._forcing=0,this):this._tTime},t.addLabel=function(s,r){return this.labels[s]=we(this,r),this},t.removeLabel=function(s){return delete this.labels[s],this},t.addPause=function(s,r,a){var o=Z.delayedCall(0,r||Kt,a);return o.data="isPause",this._hasPause=1,Re(this,o,we(this,s))},t.removePause=function(s){var r=this._first;for(s=we(this,s);r;)r._start===s&&r.data==="isPause"&&et(r),r=r._next},t.killTweensOf=function(s,r,a){for(var o=this.getTweensOf(s,a),l=o.length;l--;)Ye!==o[l]&&o[l].kill(s,r);return this},t.getTweensOf=function(s,r){for(var a=[],o=Te(s),l=this._first,h=He(r),c;l;)l instanceof Z?fa(l._targets,o)&&(h?(!Ye||l._initted&&l._ts)&&l.globalTime(0)<=r&&l.globalTime(l.totalDuration())>r:!r||l.isActive())&&a.push(l):(c=l.getTweensOf(o,r)).length&&a.push.apply(a,c),l=l._next;return a},t.tweenTo=function(s,r){r=r||{};var a=this,o=we(a,s),l=r,h=l.startAt,c=l.onStart,d=l.onStartParams,f=l.immediateRender,p,m=Z.to(a,Ee({ease:r.ease||"none",lazy:!1,immediateRender:!1,time:o,overwrite:"auto",duration:r.duration||Math.abs((o-(h&&"time"in h?h.time:a._time))/a.timeScale())||N,onStart:function(){if(a.pause(),!p){var g=r.duration||Math.abs((o-(h&&"time"in h?h.time:a._time))/a.timeScale());m._dur!==g&&Dt(m,g,0,1).render(m._time,!0,!0),p=1}c&&c.apply(m,d||[])}},r));return f?m.render(0):m},t.tweenFromTo=function(s,r,a){return this.tweenTo(r,Ee({startAt:{time:we(this,s)}},a))},t.recent=function(){return this._recent},t.nextLabel=function(s){return s===void 0&&(s=this._time),Kn(this,we(this,s))},t.previousLabel=function(s){return s===void 0&&(s=this._time),Kn(this,we(this,s),1)},t.currentLabel=function(s){return arguments.length?this.seek(s,!0):this.previousLabel(this._time+N)},t.shiftChildren=function(s,r,a){a===void 0&&(a=0);for(var o=this._first,l=this.labels,h;o;)o._start>=a&&(o._start+=s,o._end+=s),o=o._next;if(r)for(h in l)l[h]>=a&&(l[h]+=s);return pt(this)},t.invalidate=function(s){var r=this._first;for(this._lock=0;r;)r.invalidate(s),r=r._next;return n.prototype.invalidate.call(this,s)},t.clear=function(s){s===void 0&&(s=!0);for(var r=this._first,a;r;)a=r._next,this.remove(r),r=a;return this._dp&&(this._time=this._tTime=this._pTime=0),s&&(this.labels={}),pt(this)},t.totalDuration=function(s){var r=0,a=this,o=a._last,l=Se,h,c,d;if(arguments.length)return a.timeScale((a._repeat<0?a.duration():a.totalDuration())/(a.reversed()?-s:s));if(a._dirty){for(d=a.parent;o;)h=o._prev,o._dirty&&o.totalDuration(),c=o._start,c>l&&a._sort&&o._ts&&!a._lock?(a._lock=1,Re(a,o,c-o._delay,1)._lock=0):l=c,c<0&&o._ts&&(r-=c,(!d&&!a._dp||d&&d.smoothChildTiming)&&(a._start+=c/a._ts,a._time-=c,a._tTime-=c),a.shiftChildren(-c,!1,-1/0),l=0),o._end>r&&o._ts&&(r=o._end),o=h;Dt(a,a===$&&a._time>r?a._time:r,1,1),a._dirty=0}return a._tDur},e.updateRoot=function(s){if($._ts&&(Js($,Ei(s,$)),qs=me.frame),me.frame>=Wn){Wn+=_e.autoSleep||120;var r=$._first;if((!r||!r._ts)&&_e.autoSleep&&me._listeners.length<2){for(;r&&!r._ts;)r=r._next;r||me.sleep()}}},e}(ti);Ee(ae.prototype,{_lock:0,_hasPause:0,_forcing:0});var Ia=function(e,t,i,s,r,a,o){var l=new ce(this._pt,e,t,0,1,Mr,null,r),h=0,c=0,d,f,p,m,u,g,x,_;for(l.b=i,l.e=s,i+="",s+="",(x=~s.indexOf("random("))&&(s=Jt(s)),a&&(_=[i,s],a(_,e,t),i=_[0],s=_[1]),f=i.match(zi)||[];d=zi.exec(s);)m=d[0],u=s.substring(h,d.index),p?p=(p+1)%5:u.substr(-5)==="rgba("&&(p=1),m!==f[c++]&&(g=parseFloat(f[c-1])||0,l._pt={_next:l._pt,p:u||c===1?u:",",s:g,c:m.charAt(1)==="="?Et(g,m)-g:parseFloat(m)-g,m:p&&p<4?Math.round:0},h=zi.lastIndex);return l.c=h<s.length?s.substring(h,s.length):"",l.fp=o,(Xs.test(s)||x)&&(l.e=0),this._pt=l,l},On=function(e,t,i,s,r,a,o,l,h,c){Q(s)&&(s=s(r||0,e,a));var d=e[t],f=i!=="get"?i:Q(d)?h?e[t.indexOf("set")||!Q(e["get"+t.substr(3)])?t:"get"+t.substr(3)](h):e[t]():d,p=Q(d)?h?Ha:Er:Ln,m;if(J(s)&&(~s.indexOf("random(")&&(s=Jt(s)),s.charAt(1)==="="&&(m=Et(f,s)+(ne(f)||0),(m||m===0)&&(s=m))),!c||f!==s||hn)return!isNaN(f*s)&&s!==""?(m=new ce(this._pt,e,t,+f||0,s-(f||0),typeof d=="boolean"?Va:Ar,0,p),h&&(m.fp=h),o&&m.modifier(o,this,e),this._pt=m):(!d&&!(t in e)&&Pn(t,s),Ia.call(this,e,t,f,s,p,l||_e.stringFilter,h))},Ba=function(e,t,i,s,r){if(Q(e)&&(e=Zt(e,r,t,i,s)),!Ie(e)||e.style&&e.nodeType||re(e)||$s(e))return J(e)?Zt(e,r,t,i,s):e;var a={},o;for(o in e)a[o]=Zt(e[o],r,t,i,s);return a},br=function(e,t,i,s,r,a){var o,l,h,c;if(fe[e]&&(o=new fe[e]).init(r,o.rawVars?t[e]:Ba(t[e],s,r,a,i),i,s,a)!==!1&&(i._pt=l=new ce(i._pt,r,e,0,1,o.render,o,0,o.priority),i!==Tt))for(h=i._ptLookup[i._targets.indexOf(r)],c=o._props.length;c--;)h[o._props[c]]=l;return o},Ye,hn,Fn=function n(e,t,i){var s=e.vars,r=s.ease,a=s.startAt,o=s.immediateRender,l=s.lazy,h=s.onUpdate,c=s.runBackwards,d=s.yoyoEase,f=s.keyframes,p=s.autoRevert,m=e._dur,u=e._startAt,g=e._targets,x=e.parent,_=x&&x.data==="nested"?x.vars.targets:g,v=e._overwrite==="auto"&&!En,w=e.timeline,y,S,T,E,b,D,H,L,I,B,O,G,F;if(w&&(!f||!r)&&(r="none"),e._ease=mt(r,Ct.ease),e._yEase=d?vr(mt(d===!0?r:d,Ct.ease)):0,d&&e._yoyo&&!e._repeat&&(d=e._yEase,e._yEase=e._ease,e._ease=d),e._from=!w&&!!s.runBackwards,!w||f&&!s.stagger){if(L=g[0]?ft(g[0]).harness:0,G=L&&s[L.prop],y=Ti(s,Dn),u&&(u._zTime<0&&u.progress(1),t<0&&c&&o&&!p?u.render(-1,!0):u.revert(c&&m?mi:ua),u._lazy=0),a){if(et(e._startAt=Z.set(g,Ee({data:"isStart",overwrite:!1,parent:x,immediateRender:!0,lazy:!u&&le(l),startAt:null,delay:0,onUpdate:h&&function(){return ge(e,"onUpdate")},stagger:0},a))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(se||!o&&!p)&&e._startAt.revert(mi),o&&m&&t<=0&&i<=0){t&&(e._zTime=t);return}}else if(c&&m&&!u){if(t&&(o=!1),T=Ee({overwrite:!1,data:"isFromStart",lazy:o&&!u&&le(l),immediateRender:o,stagger:0,parent:x},y),G&&(T[L.prop]=G),et(e._startAt=Z.set(g,T)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(se?e._startAt.revert(mi):e._startAt.render(-1,!0)),e._zTime=t,!o)n(e._startAt,N,N);else if(!t)return}for(e._pt=e._ptCache=0,l=m&&le(l)||l&&!m,S=0;S<g.length;S++){if(b=g[S],H=b._gsap||kn(g)[S]._gsap,e._ptLookup[S]=B={},nn[H.id]&&We.length&&Si(),O=_===g?S:_.indexOf(b),L&&(I=new L).init(b,G||y,e,O,_)!==!1&&(e._pt=E=new ce(e._pt,b,I.name,0,1,I.render,I,0,I.priority),I._props.forEach(function(q){B[q]=E}),I.priority&&(D=1)),!L||G)for(T in y)fe[T]&&(I=br(T,y,e,O,b,_))?I.priority&&(D=1):B[T]=E=On.call(e,b,T,"get",y[T],O,_,0,s.stringFilter);e._op&&e._op[S]&&e.kill(b,e._op[S]),v&&e._pt&&(Ye=e,$.killTweensOf(b,B,e.globalTime(t)),F=!e.parent,Ye=0),e._pt&&l&&(nn[H.id]=1)}D&&Cr(e),e._onInit&&e._onInit(e)}e._onUpdate=h,e._initted=(!e._op||e._pt)&&!F,f&&t<=0&&w.render(Se,!0,!0)},za=function(e,t,i,s,r,a,o,l){var h=(e._pt&&e._ptCache||(e._ptCache={}))[t],c,d,f,p;if(!h)for(h=e._ptCache[t]=[],f=e._ptLookup,p=e._targets.length;p--;){if(c=f[p][t],c&&c.d&&c.d._pt)for(c=c.d._pt;c&&c.p!==t&&c.fp!==t;)c=c._next;if(!c)return hn=1,e.vars[t]="+=0",Fn(e,o),hn=0,l?qt(t+" not eligible for reset"):1;h.push(c)}for(p=h.length;p--;)d=h[p],c=d._pt||d,c.s=(s||s===0)&&!r?s:c.s+(s||0)+a*c.c,c.c=i-c.s,d.e&&(d.e=W(i)+ne(d.e)),d.b&&(d.b=c.s+ne(d.b))},Ua=function(e,t){var i=e[0]?ft(e[0]).harness:0,s=i&&i.aliases,r,a,o,l;if(!s)return t;r=_t({},t);for(a in s)if(a in r)for(l=s[a].split(","),o=l.length;o--;)r[l[o]]=r[a];return r},Na=function(e,t,i,s){var r=t.ease||s||"power1.inOut",a,o;if(re(t))o=i[e]||(i[e]=[]),t.forEach(function(l,h){return o.push({t:h/(t.length-1)*100,v:l,e:r})});else for(a in t)o=i[a]||(i[a]=[]),a==="ease"||o.push({t:parseFloat(e),v:t[a],e:r})},Zt=function(e,t,i,s,r){return Q(e)?e.call(t,i,s,r):J(e)&&~e.indexOf("random(")?Jt(e):e},Sr=Rn+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",Tr={};he(Sr+",id,stagger,delay,duration,paused,scrollTrigger",function(n){return Tr[n]=1});var Z=function(n){Gs(e,n);function e(i,s,r,a){var o;typeof s=="number"&&(r.duration=s,s=r,r=null),o=n.call(this,a?s:Qt(s))||this;var l=o.vars,h=l.duration,c=l.delay,d=l.immediateRender,f=l.stagger,p=l.overwrite,m=l.keyframes,u=l.defaults,g=l.scrollTrigger,x=l.yoyoEase,_=s.parent||$,v=(re(i)||$s(i)?He(i[0]):"length"in s)?[i]:Te(i),w,y,S,T,E,b,D,H;if(o._targets=v.length?kn(v):qt("GSAP target "+i+" not found. https://gsap.com",!_e.nullTargetWarn)||[],o._ptLookup=[],o._overwrite=p,m||f||ci(h)||ci(c)){if(s=o.vars,w=o.timeline=new ae({data:"nested",defaults:u||{},targets:_&&_.data==="nested"?_.vars.targets:v}),w.kill(),w.parent=w._dp=Ue(o),w._start=0,f||ci(h)||ci(c)){if(T=v.length,D=f&&lr(f),Ie(f))for(E in f)~Sr.indexOf(E)&&(H||(H={}),H[E]=f[E]);for(y=0;y<T;y++)S=Ti(s,Tr),S.stagger=0,x&&(S.yoyoEase=x),H&&_t(S,H),b=v[y],S.duration=+Zt(h,Ue(o),y,b,v),S.delay=(+Zt(c,Ue(o),y,b,v)||0)-o._delay,!f&&T===1&&S.delay&&(o._delay=c=S.delay,o._start+=c,S.delay=0),w.to(b,S,D?D(y,b,v):0),w._ease=C.none;w.duration()?h=c=0:o.timeline=0}else if(m){Qt(Ee(w.vars.defaults,{ease:"none"})),w._ease=mt(m.ease||s.ease||"none");var L=0,I,B,O;if(re(m))m.forEach(function(G){return w.to(v,G,">")}),w.duration();else{S={};for(E in m)E==="ease"||E==="easeEach"||Na(E,m[E],S,m.easeEach);for(E in S)for(I=S[E].sort(function(G,F){return G.t-F.t}),L=0,y=0;y<I.length;y++)B=I[y],O={ease:B.e,duration:(B.t-(y?I[y-1].t:0))/100*h},O[E]=B.v,w.to(v,O,L),L+=O.duration;w.duration()<h&&w.to({},{duration:h-w.duration()})}}h||o.duration(h=w.duration())}else o.timeline=0;return p===!0&&!En&&(Ye=Ue(o),$.killTweensOf(v),Ye=0),Re(_,Ue(o),r),s.reversed&&o.reverse(),s.paused&&o.paused(!0),(d||!h&&!m&&o._start===K(_._time)&&le(d)&&_a(Ue(o))&&_.data!=="nested")&&(o._tTime=-N,o.render(Math.max(0,-c)||0)),g&&sr(Ue(o),g),o}var t=e.prototype;return t.render=function(s,r,a){var o=this._time,l=this._tDur,h=this._dur,c=s<0,d=s>l-N&&!c?l:s<N?0:s,f,p,m,u,g,x,_,v,w;if(!h)xa(this,s,r,a);else if(d!==this._tTime||!s||a||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==c){if(f=d,v=this.timeline,this._repeat){if(u=h+this._rDelay,this._repeat<-1&&c)return this.totalTime(u*100+s,r,a);if(f=K(d%u),d===l?(m=this._repeat,f=h):(m=~~(d/u),m&&m===K(d/u)&&(f=h,m--),f>h&&(f=h)),x=this._yoyo&&m&1,x&&(w=this._yEase,f=h-f),g=Pt(this._tTime,u),f===o&&!a&&this._initted&&m===g)return this._tTime=d,this;m!==g&&(v&&this._yEase&&xr(v,x),this.vars.repeatRefresh&&!x&&!this._lock&&this._time!==h&&this._initted&&(this._lock=a=1,this.render(K(u*m),!0).invalidate()._lock=0))}if(!this._initted){if(rr(this,c?s:f,a,r,d))return this._tTime=0,this;if(o!==this._time&&!(a&&this.vars.repeatRefresh&&m!==g))return this;if(h!==this._dur)return this.render(s,r,a)}if(this._tTime=d,this._time=f,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=_=(w||this._ease)(f/h),this._from&&(this.ratio=_=1-_),f&&!o&&!r&&!m&&(ge(this,"onStart"),this._tTime!==d))return this;for(p=this._pt;p;)p.r(_,p.d),p=p._next;v&&v.render(s<0?s:!f&&x?-N:v._dur*v._ease(f/this._dur),r,a)||this._startAt&&(this._zTime=s),this._onUpdate&&!r&&(c&&sn(this,s,r,a),ge(this,"onUpdate")),this._repeat&&m!==g&&this.vars.onRepeat&&!r&&this.parent&&ge(this,"onRepeat"),(d===this._tDur||!d)&&this._tTime===d&&(c&&!this._onUpdate&&sn(this,s,!0,!0),(s||!h)&&(d===this._tDur&&this._ts>0||!d&&this._ts<0)&&et(this,1),!r&&!(c&&!o)&&(d||o||x)&&(ge(this,d===l?"onComplete":"onReverseComplete",!0),this._prom&&!(d<l&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(s){return(!s||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(s),n.prototype.invalidate.call(this,s)},t.resetTo=function(s,r,a,o,l){ei||me.wake(),this._ts||this.play();var h=Math.min(this._dur,(this._dp._time-this._start)*this._ts),c;return this._initted||Fn(this,h),c=this._ease(h/this._dur),za(this,s,r,a,o,c,h,l)?this.resetTo(s,r,a,o,1):(Oi(this,0),this.parent||ir(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(s,r){if(r===void 0&&(r="all"),!s&&(!r||r==="all"))return this._lazy=this._pt=0,this.parent?Vt(this):this;if(this.timeline){var a=this.timeline.totalDuration();return this.timeline.killTweensOf(s,r,Ye&&Ye.vars.overwrite!==!0)._first||Vt(this),this.parent&&a!==this.timeline.totalDuration()&&Dt(this,this._dur*this.timeline._tDur/a,0,1),this}var o=this._targets,l=s?Te(s):o,h=this._ptLookup,c=this._pt,d,f,p,m,u,g,x;if((!r||r==="all")&&ma(o,l))return r==="all"&&(this._pt=0),Vt(this);for(d=this._op=this._op||[],r!=="all"&&(J(r)&&(u={},he(r,function(_){return u[_]=1}),r=u),r=Ua(o,r)),x=o.length;x--;)if(~l.indexOf(o[x])){f=h[x],r==="all"?(d[x]=r,m=f,p={}):(p=d[x]=d[x]||{},m=r);for(u in m)g=f&&f[u],g&&((!("kill"in g.d)||g.d.kill(u)===!0)&&Ri(this,g,"_pt"),delete f[u]),p!=="all"&&(p[u]=1)}return this._initted&&!this._pt&&c&&Vt(this),this},e.to=function(s,r){return new e(s,r,arguments[2])},e.from=function(s,r){return Wt(1,arguments)},e.delayedCall=function(s,r,a,o){return new e(r,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:s,onComplete:r,onReverseComplete:r,onCompleteParams:a,onReverseCompleteParams:a,callbackScope:o})},e.fromTo=function(s,r,a){return Wt(2,arguments)},e.set=function(s,r){return r.duration=0,r.repeatDelay||(r.repeat=0),new e(s,r)},e.killTweensOf=function(s,r,a){return $.killTweensOf(s,r,a)},e}(ti);Ee(Z.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});he("staggerTo,staggerFrom,staggerFromTo",function(n){Z[n]=function(){var e=new ae,t=an.call(arguments,0);return t.splice(n==="staggerFromTo"?5:4,0,0),e[n].apply(e,t)}});var Ln=function(e,t,i){return e[t]=i},Er=function(e,t,i){return e[t](i)},Ha=function(e,t,i,s){return e[t](s.fp,i)},Ga=function(e,t,i){return e.setAttribute(t,i)},In=function(e,t){return Q(e[t])?Er:An(e[t])&&e.setAttribute?Ga:Ln},Ar=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},Va=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},Mr=function(e,t){var i=t._pt,s="";if(!e&&t.b)s=t.b;else if(e===1&&t.e)s=t.e;else{for(;i;)s=i.p+(i.m?i.m(i.s+i.c*e):Math.round((i.s+i.c*e)*1e4)/1e4)+s,i=i._next;s+=t.c}t.set(t.t,t.p,s,t)},Bn=function(e,t){for(var i=t._pt;i;)i.r(e,i.d),i=i._next},$a=function(e,t,i,s){for(var r=this._pt,a;r;)a=r._next,r.p===s&&r.modifier(e,t,i),r=a},Ya=function(e){for(var t=this._pt,i,s;t;)s=t._next,t.p===e&&!t.op||t.op===e?Ri(this,t,"_pt"):t.dep||(i=1),t=s;return!i},Xa=function(e,t,i,s){s.mSet(e,t,s.m.call(s.tween,i,s.mt),s)},Cr=function(e){for(var t=e._pt,i,s,r,a;t;){for(i=t._next,s=r;s&&s.pr>t.pr;)s=s._next;(t._prev=s?s._prev:a)?t._prev._next=t:r=t,(t._next=s)?s._prev=t:a=t,t=i}e._pt=r},ce=function(){function n(t,i,s,r,a,o,l,h,c){this.t=i,this.s=r,this.c=a,this.p=s,this.r=o||Ar,this.d=l||this,this.set=h||Ln,this.pr=c||0,this._next=t,t&&(t._prev=this)}var e=n.prototype;return e.modifier=function(i,s,r){this.mSet=this.mSet||this.set,this.set=Xa,this.m=i,this.mt=r,this.tween=s},n}();he(Rn+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(n){return Dn[n]=1});ve.TweenMax=ve.TweenLite=Z;ve.TimelineLite=ve.TimelineMax=ae;$=new ae({sortChildren:!1,defaults:Ct,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});_e.stringFilter=_r;var gt=[],_i={},Qa=[],es=0,Wa=0,Vi=function(e){return(_i[e]||Qa).map(function(t){return t()})},cn=function(){var e=Date.now(),t=[];e-es>2&&(Vi("matchMediaInit"),gt.forEach(function(i){var s=i.queries,r=i.conditions,a,o,l,h;for(o in s)a=be.matchMedia(s[o]).matches,a&&(l=1),a!==r[o]&&(r[o]=a,h=1);h&&(i.revert(),l&&t.push(i))}),Vi("matchMediaRevert"),t.forEach(function(i){return i.onMatch(i,function(s){return i.add(null,s)})}),es=e,Vi("matchMedia"))},Pr=function(){function n(t,i){this.selector=i&&on(i),this.data=[],this._r=[],this.isReverted=!1,this.id=Wa++,t&&this.add(t)}var e=n.prototype;return e.add=function(i,s,r){Q(i)&&(r=s,s=i,i=Q);var a=this,o=function(){var h=X,c=a.selector,d;return h&&h!==a&&h.data.push(a),r&&(a.selector=on(r)),X=a,d=s.apply(a,arguments),Q(d)&&a._r.push(d),X=h,a.selector=c,a.isReverted=!1,d};return a.last=o,i===Q?o(a,function(l){return a.add(null,l)}):i?a[i]=o:o},e.ignore=function(i){var s=X;X=null,i(this),X=s},e.getTweens=function(){var i=[];return this.data.forEach(function(s){return s instanceof n?i.push.apply(i,s.getTweens()):s instanceof Z&&!(s.parent&&s.parent.data==="nested")&&i.push(s)}),i},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(i,s){var r=this;if(i?function(){for(var o=r.getTweens(),l=r.data.length,h;l--;)h=r.data[l],h.data==="isFlip"&&(h.revert(),h.getChildren(!0,!0,!1).forEach(function(c){return o.splice(o.indexOf(c),1)}));for(o.map(function(c){return{g:c._dur||c._delay||c._sat&&!c._sat.vars.immediateRender?c.globalTime(0):-1/0,t:c}}).sort(function(c,d){return d.g-c.g||-1/0}).forEach(function(c){return c.t.revert(i)}),l=r.data.length;l--;)h=r.data[l],h instanceof ae?h.data!=="nested"&&(h.scrollTrigger&&h.scrollTrigger.revert(),h.kill()):!(h instanceof Z)&&h.revert&&h.revert(i);r._r.forEach(function(c){return c(i,r)}),r.isReverted=!0}():this.data.forEach(function(o){return o.kill&&o.kill()}),this.clear(),s)for(var a=gt.length;a--;)gt[a].id===this.id&&gt.splice(a,1)},e.revert=function(i){this.kill(i||{})},n}(),Za=function(){function n(t){this.contexts=[],this.scope=t}var e=n.prototype;return e.add=function(i,s,r){Ie(i)||(i={matches:i});var a=new Pr(0,r||this.scope),o=a.conditions={},l,h,c;X&&!a.selector&&(a.selector=X.selector),this.contexts.push(a),s=a.add("onMatch",s),a.queries=i;for(h in i)h==="all"?c=1:(l=be.matchMedia(i[h]),l&&(gt.indexOf(a)<0&&gt.push(a),(o[h]=l.matches)&&(c=1),l.addListener?l.addListener(cn):l.addEventListener("change",cn)));return c&&s(a,function(d){return a.add(null,d)}),this},e.revert=function(i){this.kill(i||{})},e.kill=function(i){this.contexts.forEach(function(s){return s.kill(i,!0)})},n}(),Ai={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach(function(s){return pr(s)})},timeline:function(e){return new ae(e)},getTweensOf:function(e,t){return $.getTweensOf(e,t)},getProperty:function(e,t,i,s){J(e)&&(e=Te(e)[0]);var r=ft(e||{}).get,a=i?tr:er;return i==="native"&&(i=""),e&&(t?a((fe[t]&&fe[t].get||r)(e,t,i,s)):function(o,l,h){return a((fe[o]&&fe[o].get||r)(e,o,l,h))})},quickSetter:function(e,t,i){if(e=Te(e),e.length>1){var s=e.map(function(c){return de.quickSetter(c,t,i)}),r=s.length;return function(c){for(var d=r;d--;)s[d](c)}}e=e[0]||{};var a=fe[t],o=ft(e),l=o.harness&&(o.harness.aliases||{})[t]||t,h=a?function(c){var d=new a;Tt._pt=0,d.init(e,i?c+i:c,Tt,0,[e]),d.render(1,d),Tt._pt&&Bn(1,Tt)}:o.set(e,l);return a?h:function(c){return h(e,l,i?c+i:c,o,1)}},quickTo:function(e,t,i){var s,r=de.to(e,_t((s={},s[t]="+=0.1",s.paused=!0,s),i||{})),a=function(l,h,c){return r.resetTo(t,l,h,c)};return a.tween=r,a},isTweening:function(e){return $.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=mt(e.ease,Ct.ease)),Zn(Ct,e||{})},config:function(e){return Zn(_e,e||{})},registerEffect:function(e){var t=e.name,i=e.effect,s=e.plugins,r=e.defaults,a=e.extendTimeline;(s||"").split(",").forEach(function(o){return o&&!fe[o]&&!ve[o]&&qt(t+" effect requires "+o+" plugin.")}),Ui[t]=function(o,l,h){return i(Te(o),Ee(l||{},r),h)},a&&(ae.prototype[t]=function(o,l,h){return this.add(Ui[t](o,Ie(l)?l:(h=l)&&{},this),h)})},registerEase:function(e,t){C[e]=mt(t)},parseEase:function(e,t){return arguments.length?mt(e,t):C},getById:function(e){return $.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var i=new ae(e),s,r;for(i.smoothChildTiming=le(e.smoothChildTiming),$.remove(i),i._dp=0,i._time=i._tTime=$._time,s=$._first;s;)r=s._next,(t||!(!s._dur&&s instanceof Z&&s.vars.onComplete===s._targets[0]))&&Re(i,s,s._start-s._delay),s=r;return Re($,i,0),i},context:function(e,t){return e?new Pr(e,t):X},matchMedia:function(e){return new Za(e)},matchMediaRefresh:function(){return gt.forEach(function(e){var t=e.conditions,i,s;for(s in t)t[s]&&(t[s]=!1,i=1);i&&e.revert()})||cn()},addEventListener:function(e,t){var i=_i[e]||(_i[e]=[]);~i.indexOf(t)||i.push(t)},removeEventListener:function(e,t){var i=_i[e],s=i&&i.indexOf(t);s>=0&&i.splice(s,1)},utils:{wrap:Ma,wrapYoyo:Ca,distribute:lr,random:cr,snap:hr,normalize:Aa,getUnit:ne,clamp:ba,splitColor:mr,toArray:Te,selector:on,mapRange:dr,pipe:Ta,unitize:Ea,interpolate:Pa,shuffle:or},install:Zs,effects:Ui,ticker:me,updateRoot:ae.updateRoot,plugins:fe,globalTimeline:$,core:{PropTween:ce,globals:js,Tween:Z,Timeline:ae,Animation:ti,getCache:ft,_removeLinkedListItem:Ri,reverting:function(){return se},context:function(e){return e&&X&&(X.data.push(e),e._ctx=X),X},suppressOverwrites:function(e){return En=e}}};he("to,from,fromTo,delayedCall,set,killTweensOf",function(n){return Ai[n]=Z[n]});me.add(ae.updateRoot);Tt=Ai.to({},{duration:0});var ja=function(e,t){for(var i=e._pt;i&&i.p!==t&&i.op!==t&&i.fp!==t;)i=i._next;return i},qa=function(e,t){var i=e._targets,s,r,a;for(s in t)for(r=i.length;r--;)a=e._ptLookup[r][s],a&&(a=a.d)&&(a._pt&&(a=ja(a,s)),a&&a.modifier&&a.modifier(t[s],e,i[r],s))},$i=function(e,t){return{name:e,rawVars:1,init:function(s,r,a){a._onInit=function(o){var l,h;if(J(r)&&(l={},he(r,function(c){return l[c]=1}),r=l),t){l={};for(h in r)l[h]=t(r[h]);r=l}qa(o,r)}}}},de=Ai.registerPlugin({name:"attr",init:function(e,t,i,s,r){var a,o,l;this.tween=i;for(a in t)l=e.getAttribute(a)||"",o=this.add(e,"setAttribute",(l||0)+"",t[a],s,r,0,0,a),o.op=a,o.b=l,this._props.push(a)},render:function(e,t){for(var i=t._pt;i;)se?i.set(i.t,i.p,i.b,i):i.r(e,i.d),i=i._next}},{name:"endArray",init:function(e,t){for(var i=t.length;i--;)this.add(e,i,e[i]||0,t[i],0,0,0,0,0,1)}},$i("roundProps",ln),$i("modifiers"),$i("snap",hr))||Ai;Z.version=ae.version=de.version="3.12.3";Ws=1;Mn()&&Rt();C.Power0;C.Power1;C.Power2;C.Power3;C.Power4;C.Linear;C.Quad;C.Cubic;C.Quart;C.Quint;C.Strong;C.Elastic;C.Back;C.SteppedEase;C.Bounce;C.Sine;C.Expo;C.Circ;/*!
 * CSSPlugin 3.12.3
 * https://gsap.com
 *
 * Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var ts,Xe,At,zn,ct,is,Un,Ka=function(){return typeof window<"u"},Ge={},lt=180/Math.PI,Mt=Math.PI/180,wt=Math.atan2,ns=1e8,Nn=/([A-Z])/g,Ja=/(left|right|width|margin|padding|x)/i,eo=/[\s,\(]\S/,ke={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},un=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},to=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},io=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},no=function(e,t){var i=t.s+t.c*e;t.set(t.t,t.p,~~(i+(i<0?-.5:.5))+t.u,t)},Dr=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},Rr=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},so=function(e,t,i){return e.style[t]=i},ro=function(e,t,i){return e.style.setProperty(t,i)},ao=function(e,t,i){return e._gsap[t]=i},oo=function(e,t,i){return e._gsap.scaleX=e._gsap.scaleY=i},lo=function(e,t,i,s,r){var a=e._gsap;a.scaleX=a.scaleY=i,a.renderTransform(r,a)},ho=function(e,t,i,s,r){var a=e._gsap;a[t]=i,a.renderTransform(r,a)},Y="transform",ue=Y+"Origin",co=function n(e,t){var i=this,s=this.target,r=s.style,a=s._gsap;if(e in Ge&&r){if(this.tfm=this.tfm||{},e!=="transform")e=ke[e]||e,~e.indexOf(",")?e.split(",").forEach(function(o){return i.tfm[o]=Ne(s,o)}):this.tfm[e]=a.x?a[e]:Ne(s,e),e===ue&&(this.tfm.zOrigin=a.zOrigin);else return ke.transform.split(",").forEach(function(o){return n.call(i,o,t)});if(this.props.indexOf(Y)>=0)return;a.svg&&(this.svgo=s.getAttribute("data-svg-origin"),this.props.push(ue,t,"")),e=Y}(r||t)&&this.props.push(e,t,r[e])},kr=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},uo=function(){var e=this.props,t=this.target,i=t.style,s=t._gsap,r,a;for(r=0;r<e.length;r+=3)e[r+1]?t[e[r]]=e[r+2]:e[r+2]?i[e[r]]=e[r+2]:i.removeProperty(e[r].substr(0,2)==="--"?e[r]:e[r].replace(Nn,"-$1").toLowerCase());if(this.tfm){for(a in this.tfm)s[a]=this.tfm[a];s.svg&&(s.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),r=Un(),(!r||!r.isStart)&&!i[Y]&&(kr(i),s.zOrigin&&i[ue]&&(i[ue]+=" "+s.zOrigin+"px",s.zOrigin=0,s.renderTransform()),s.uncache=1)}},Or=function(e,t){var i={target:e,props:[],revert:uo,save:co};return e._gsap||de.core.getCache(e),t&&t.split(",").forEach(function(s){return i.save(s)}),i},Fr,dn=function(e,t){var i=Xe.createElementNS?Xe.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):Xe.createElement(e);return i&&i.style?i:Xe.createElement(e)},Fe=function n(e,t,i){var s=getComputedStyle(e);return s[t]||s.getPropertyValue(t.replace(Nn,"-$1").toLowerCase())||s.getPropertyValue(t)||!i&&n(e,kt(t)||t,1)||""},ss="O,Moz,ms,Ms,Webkit".split(","),kt=function(e,t,i){var s=t||ct,r=s.style,a=5;if(e in r&&!i)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);a--&&!(ss[a]+e in r););return a<0?null:(a===3?"ms":a>=0?ss[a]:"")+e},fn=function(){Ka()&&window.document&&(ts=window,Xe=ts.document,At=Xe.documentElement,ct=dn("div")||{style:{}},dn("div"),Y=kt(Y),ue=Y+"Origin",ct.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Fr=!!kt("perspective"),Un=de.core.reverting,zn=1)},Yi=function n(e){var t=dn("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,s=this.nextSibling,r=this.style.cssText,a;if(At.appendChild(t),t.appendChild(this),this.style.display="block",e)try{a=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=n}catch{}else this._gsapBBox&&(a=this._gsapBBox());return i&&(s?i.insertBefore(this,s):i.appendChild(this)),At.removeChild(t),this.style.cssText=r,a},rs=function(e,t){for(var i=t.length;i--;)if(e.hasAttribute(t[i]))return e.getAttribute(t[i])},Lr=function(e){var t;try{t=e.getBBox()}catch{t=Yi.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===Yi||(t=Yi.call(e,!0)),t&&!t.width&&!t.x&&!t.y?{x:+rs(e,["x","cx","x1"])||0,y:+rs(e,["y","cy","y1"])||0,width:0,height:0}:t},Ir=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&Lr(e))},vt=function(e,t){if(t){var i=e.style,s;t in Ge&&t!==ue&&(t=Y),i.removeProperty?(s=t.substr(0,2),(s==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),i.removeProperty(s==="--"?t:t.replace(Nn,"-$1").toLowerCase())):i.removeAttribute(t)}},Qe=function(e,t,i,s,r,a){var o=new ce(e._pt,t,i,0,1,a?Rr:Dr);return e._pt=o,o.b=s,o.e=r,e._props.push(i),o},as={deg:1,rad:1,turn:1},fo={grid:1,flex:1},tt=function n(e,t,i,s){var r=parseFloat(i)||0,a=(i+"").trim().substr((r+"").length)||"px",o=ct.style,l=Ja.test(t),h=e.tagName.toLowerCase()==="svg",c=(h?"client":"offset")+(l?"Width":"Height"),d=100,f=s==="px",p=s==="%",m,u,g,x;if(s===a||!r||as[s]||as[a])return r;if(a!=="px"&&!f&&(r=n(e,t,i,"px")),x=e.getCTM&&Ir(e),(p||a==="%")&&(Ge[t]||~t.indexOf("adius")))return m=x?e.getBBox()[l?"width":"height"]:e[c],W(p?r/m*d:r/100*m);if(o[l?"width":"height"]=d+(f?a:s),u=~t.indexOf("adius")||s==="em"&&e.appendChild&&!h?e:e.parentNode,x&&(u=(e.ownerSVGElement||{}).parentNode),(!u||u===Xe||!u.appendChild)&&(u=Xe.body),g=u._gsap,g&&p&&g.width&&l&&g.time===me.time&&!g.uncache)return W(r/g.width*d);if(p&&(t==="height"||t==="width")){var _=e.style[t];e.style[t]=d+s,m=e[c],_?e.style[t]=_:vt(e,t)}else(p||a==="%")&&!fo[Fe(u,"display")]&&(o.position=Fe(e,"position")),u===e&&(o.position="static"),u.appendChild(ct),m=ct[c],u.removeChild(ct),o.position="absolute";return l&&p&&(g=ft(u),g.time=me.time,g.width=u[c]),W(f?m*r/d:m&&r?d/m*r:0)},Ne=function(e,t,i,s){var r;return zn||fn(),t in ke&&t!=="transform"&&(t=ke[t],~t.indexOf(",")&&(t=t.split(",")[0])),Ge[t]&&t!=="transform"?(r=ni(e,s),r=t!=="transformOrigin"?r[t]:r.svg?r.origin:Ci(Fe(e,ue))+" "+r.zOrigin+"px"):(r=e.style[t],(!r||r==="auto"||s||~(r+"").indexOf("calc("))&&(r=Mi[t]&&Mi[t](e,t,i)||Fe(e,t)||Ks(e,t)||(t==="opacity"?1:0))),i&&!~(r+"").trim().indexOf(" ")?tt(e,t,r,i)+i:r},po=function(e,t,i,s){if(!i||i==="none"){var r=kt(t,e,1),a=r&&Fe(e,r,1);a&&a!==i?(t=r,i=a):t==="borderColor"&&(i=Fe(e,"borderTopColor"))}var o=new ce(this._pt,e.style,t,0,1,Mr),l=0,h=0,c,d,f,p,m,u,g,x,_,v,w,y;if(o.b=i,o.e=s,i+="",s+="",s==="auto"&&(u=e.style[t],e.style[t]=s,s=Fe(e,t)||s,u?e.style[t]=u:vt(e,t)),c=[i,s],_r(c),i=c[0],s=c[1],f=i.match(St)||[],y=s.match(St)||[],y.length){for(;d=St.exec(s);)g=d[0],_=s.substring(l,d.index),m?m=(m+1)%5:(_.substr(-5)==="rgba("||_.substr(-5)==="hsla(")&&(m=1),g!==(u=f[h++]||"")&&(p=parseFloat(u)||0,w=u.substr((p+"").length),g.charAt(1)==="="&&(g=Et(p,g)+w),x=parseFloat(g),v=g.substr((x+"").length),l=St.lastIndex-v.length,v||(v=v||_e.units[t]||w,l===s.length&&(s+=v,o.e+=v)),w!==v&&(p=tt(e,t,u,v)||0),o._pt={_next:o._pt,p:_||h===1?_:",",s:p,c:x-p,m:m&&m<4||t==="zIndex"?Math.round:0});o.c=l<s.length?s.substring(l,s.length):""}else o.r=t==="display"&&s==="none"?Rr:Dr;return Xs.test(s)&&(o.e=0),this._pt=o,o},os={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},mo=function(e){var t=e.split(" "),i=t[0],s=t[1]||"50%";return(i==="top"||i==="bottom"||s==="left"||s==="right")&&(e=i,i=s,s=e),t[0]=os[i]||i,t[1]=os[s]||s,t.join(" ")},go=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var i=t.t,s=i.style,r=t.u,a=i._gsap,o,l,h;if(r==="all"||r===!0)s.cssText="",l=1;else for(r=r.split(","),h=r.length;--h>-1;)o=r[h],Ge[o]&&(l=1,o=o==="transformOrigin"?ue:Y),vt(i,o);l&&(vt(i,Y),a&&(a.svg&&i.removeAttribute("transform"),ni(i,1),a.uncache=1,kr(s)))}},Mi={clearProps:function(e,t,i,s,r){if(r.data!=="isFromStart"){var a=e._pt=new ce(e._pt,t,i,0,0,go);return a.u=s,a.pr=-10,a.tween=r,e._props.push(i),1}}},ii=[1,0,0,1,0,0],Br={},zr=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},ls=function(e){var t=Fe(e,Y);return zr(t)?ii:t.substr(7).match(Ys).map(W)},Hn=function(e,t){var i=e._gsap||ft(e),s=e.style,r=ls(e),a,o,l,h;return i.svg&&e.getAttribute("transform")?(l=e.transform.baseVal.consolidate().matrix,r=[l.a,l.b,l.c,l.d,l.e,l.f],r.join(",")==="1,0,0,1,0,0"?ii:r):(r===ii&&!e.offsetParent&&e!==At&&!i.svg&&(l=s.display,s.display="block",a=e.parentNode,(!a||!e.offsetParent)&&(h=1,o=e.nextElementSibling,At.appendChild(e)),r=ls(e),l?s.display=l:vt(e,"display"),h&&(o?a.insertBefore(e,o):a?a.appendChild(e):At.removeChild(e))),t&&r.length>6?[r[0],r[1],r[4],r[5],r[12],r[13]]:r)},pn=function(e,t,i,s,r,a){var o=e._gsap,l=r||Hn(e,!0),h=o.xOrigin||0,c=o.yOrigin||0,d=o.xOffset||0,f=o.yOffset||0,p=l[0],m=l[1],u=l[2],g=l[3],x=l[4],_=l[5],v=t.split(" "),w=parseFloat(v[0])||0,y=parseFloat(v[1])||0,S,T,E,b;i?l!==ii&&(T=p*g-m*u)&&(E=w*(g/T)+y*(-u/T)+(u*_-g*x)/T,b=w*(-m/T)+y*(p/T)-(p*_-m*x)/T,w=E,y=b):(S=Lr(e),w=S.x+(~v[0].indexOf("%")?w/100*S.width:w),y=S.y+(~(v[1]||v[0]).indexOf("%")?y/100*S.height:y),!("xOrigin"in o)&&(w||y)&&(w-=S.x,y-=S.y)),s||s!==!1&&o.smooth?(x=w-h,_=y-c,o.xOffset=d+(x*p+_*u)-x,o.yOffset=f+(x*m+_*g)-_):o.xOffset=o.yOffset=0,o.xOrigin=w,o.yOrigin=y,o.smooth=!!s,o.origin=t,o.originIsAbsolute=!!i,e.style[ue]="0px 0px",a&&(Qe(a,o,"xOrigin",h,w),Qe(a,o,"yOrigin",c,y),Qe(a,o,"xOffset",d,o.xOffset),Qe(a,o,"yOffset",f,o.yOffset)),e.setAttribute("data-svg-origin",w+" "+y)},ni=function(e,t){var i=e._gsap||new wr(e);if("x"in i&&!t&&!i.uncache)return i;var s=e.style,r=i.scaleX<0,a="px",o="deg",l=getComputedStyle(e),h=Fe(e,ue)||"0",c,d,f,p,m,u,g,x,_,v,w,y,S,T,E,b,D,H,L,I,B,O,G,F,q,j,Ce,Pe,xe,oi,ye,nt;return c=d=f=u=g=x=_=v=w=0,p=m=1,i.svg=!!(e.getCTM&&Ir(e)),l.translate&&((l.translate!=="none"||l.scale!=="none"||l.rotate!=="none")&&(s[Y]=(l.translate!=="none"?"translate3d("+(l.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(l.rotate!=="none"?"rotate("+l.rotate+") ":"")+(l.scale!=="none"?"scale("+l.scale.split(" ").join(",")+") ":"")+(l[Y]!=="none"?l[Y]:"")),s.scale=s.rotate=s.translate="none"),T=Hn(e,i.svg),i.svg&&(i.uncache?(q=e.getBBox(),h=i.xOrigin-q.x+"px "+(i.yOrigin-q.y)+"px",F=""):F=!t&&e.getAttribute("data-svg-origin"),pn(e,F||h,!!F||i.originIsAbsolute,i.smooth!==!1,T)),y=i.xOrigin||0,S=i.yOrigin||0,T!==ii&&(H=T[0],L=T[1],I=T[2],B=T[3],c=O=T[4],d=G=T[5],T.length===6?(p=Math.sqrt(H*H+L*L),m=Math.sqrt(B*B+I*I),u=H||L?wt(L,H)*lt:0,_=I||B?wt(I,B)*lt+u:0,_&&(m*=Math.abs(Math.cos(_*Mt))),i.svg&&(c-=y-(y*H+S*I),d-=S-(y*L+S*B))):(nt=T[6],oi=T[7],Ce=T[8],Pe=T[9],xe=T[10],ye=T[11],c=T[12],d=T[13],f=T[14],E=wt(nt,xe),g=E*lt,E&&(b=Math.cos(-E),D=Math.sin(-E),F=O*b+Ce*D,q=G*b+Pe*D,j=nt*b+xe*D,Ce=O*-D+Ce*b,Pe=G*-D+Pe*b,xe=nt*-D+xe*b,ye=oi*-D+ye*b,O=F,G=q,nt=j),E=wt(-I,xe),x=E*lt,E&&(b=Math.cos(-E),D=Math.sin(-E),F=H*b-Ce*D,q=L*b-Pe*D,j=I*b-xe*D,ye=B*D+ye*b,H=F,L=q,I=j),E=wt(L,H),u=E*lt,E&&(b=Math.cos(E),D=Math.sin(E),F=H*b+L*D,q=O*b+G*D,L=L*b-H*D,G=G*b-O*D,H=F,O=q),g&&Math.abs(g)+Math.abs(u)>359.9&&(g=u=0,x=180-x),p=W(Math.sqrt(H*H+L*L+I*I)),m=W(Math.sqrt(G*G+nt*nt)),E=wt(O,G),_=Math.abs(E)>2e-4?E*lt:0,w=ye?1/(ye<0?-ye:ye):0),i.svg&&(F=e.getAttribute("transform"),i.forceCSS=e.setAttribute("transform","")||!zr(Fe(e,Y)),F&&e.setAttribute("transform",F))),Math.abs(_)>90&&Math.abs(_)<270&&(r?(p*=-1,_+=u<=0?180:-180,u+=u<=0?180:-180):(m*=-1,_+=_<=0?180:-180)),t=t||i.uncache,i.x=c-((i.xPercent=c&&(!t&&i.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-c)?-50:0)))?e.offsetWidth*i.xPercent/100:0)+a,i.y=d-((i.yPercent=d&&(!t&&i.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-d)?-50:0)))?e.offsetHeight*i.yPercent/100:0)+a,i.z=f+a,i.scaleX=W(p),i.scaleY=W(m),i.rotation=W(u)+o,i.rotationX=W(g)+o,i.rotationY=W(x)+o,i.skewX=_+o,i.skewY=v+o,i.transformPerspective=w+a,(i.zOrigin=parseFloat(h.split(" ")[2])||!t&&i.zOrigin||0)&&(s[ue]=Ci(h)),i.svg||(i.xOffset=i.yOffset=0),i.force3D=_e.force3D,i.renderTransform=i.svg?vo:Fr?Ur:_o,i.uncache=0,i},Ci=function(e){return(e=e.split(" "))[0]+" "+e[1]},Xi=function(e,t,i){var s=ne(t);return W(parseFloat(t)+parseFloat(tt(e,"x",i+"px",s)))+s},_o=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,Ur(e,t)},st="0deg",Ut="0px",rt=") ",Ur=function(e,t){var i=t||this,s=i.xPercent,r=i.yPercent,a=i.x,o=i.y,l=i.z,h=i.rotation,c=i.rotationY,d=i.rotationX,f=i.skewX,p=i.skewY,m=i.scaleX,u=i.scaleY,g=i.transformPerspective,x=i.force3D,_=i.target,v=i.zOrigin,w="",y=x==="auto"&&e&&e!==1||x===!0;if(v&&(d!==st||c!==st)){var S=parseFloat(c)*Mt,T=Math.sin(S),E=Math.cos(S),b;S=parseFloat(d)*Mt,b=Math.cos(S),a=Xi(_,a,T*b*-v),o=Xi(_,o,-Math.sin(S)*-v),l=Xi(_,l,E*b*-v+v)}g!==Ut&&(w+="perspective("+g+rt),(s||r)&&(w+="translate("+s+"%, "+r+"%) "),(y||a!==Ut||o!==Ut||l!==Ut)&&(w+=l!==Ut||y?"translate3d("+a+", "+o+", "+l+") ":"translate("+a+", "+o+rt),h!==st&&(w+="rotate("+h+rt),c!==st&&(w+="rotateY("+c+rt),d!==st&&(w+="rotateX("+d+rt),(f!==st||p!==st)&&(w+="skew("+f+", "+p+rt),(m!==1||u!==1)&&(w+="scale("+m+", "+u+rt),_.style[Y]=w||"translate(0, 0)"},vo=function(e,t){var i=t||this,s=i.xPercent,r=i.yPercent,a=i.x,o=i.y,l=i.rotation,h=i.skewX,c=i.skewY,d=i.scaleX,f=i.scaleY,p=i.target,m=i.xOrigin,u=i.yOrigin,g=i.xOffset,x=i.yOffset,_=i.forceCSS,v=parseFloat(a),w=parseFloat(o),y,S,T,E,b;l=parseFloat(l),h=parseFloat(h),c=parseFloat(c),c&&(c=parseFloat(c),h+=c,l+=c),l||h?(l*=Mt,h*=Mt,y=Math.cos(l)*d,S=Math.sin(l)*d,T=Math.sin(l-h)*-f,E=Math.cos(l-h)*f,h&&(c*=Mt,b=Math.tan(h-c),b=Math.sqrt(1+b*b),T*=b,E*=b,c&&(b=Math.tan(c),b=Math.sqrt(1+b*b),y*=b,S*=b)),y=W(y),S=W(S),T=W(T),E=W(E)):(y=d,E=f,S=T=0),(v&&!~(a+"").indexOf("px")||w&&!~(o+"").indexOf("px"))&&(v=tt(p,"x",a,"px"),w=tt(p,"y",o,"px")),(m||u||g||x)&&(v=W(v+m-(m*y+u*T)+g),w=W(w+u-(m*S+u*E)+x)),(s||r)&&(b=p.getBBox(),v=W(v+s/100*b.width),w=W(w+r/100*b.height)),b="matrix("+y+","+S+","+T+","+E+","+v+","+w+")",p.setAttribute("transform",b),_&&(p.style[Y]=b)},xo=function(e,t,i,s,r){var a=360,o=J(r),l=parseFloat(r)*(o&&~r.indexOf("rad")?lt:1),h=l-s,c=s+h+"deg",d,f;return o&&(d=r.split("_")[1],d==="short"&&(h%=a,h!==h%(a/2)&&(h+=h<0?a:-a)),d==="cw"&&h<0?h=(h+a*ns)%a-~~(h/a)*a:d==="ccw"&&h>0&&(h=(h-a*ns)%a-~~(h/a)*a)),e._pt=f=new ce(e._pt,t,i,s,h,to),f.e=c,f.u="deg",e._props.push(i),f},hs=function(e,t){for(var i in t)e[i]=t[i];return e},yo=function(e,t,i){var s=hs({},i._gsap),r="perspective,force3D,transformOrigin,svgOrigin",a=i.style,o,l,h,c,d,f,p,m;s.svg?(h=i.getAttribute("transform"),i.setAttribute("transform",""),a[Y]=t,o=ni(i,1),vt(i,Y),i.setAttribute("transform",h)):(h=getComputedStyle(i)[Y],a[Y]=t,o=ni(i,1),a[Y]=h);for(l in Ge)h=s[l],c=o[l],h!==c&&r.indexOf(l)<0&&(p=ne(h),m=ne(c),d=p!==m?tt(i,l,h,m):parseFloat(h),f=parseFloat(c),e._pt=new ce(e._pt,o,l,d,f-d,un),e._pt.u=m||0,e._props.push(l));hs(o,s)};he("padding,margin,Width,Radius",function(n,e){var t="Top",i="Right",s="Bottom",r="Left",a=(e<3?[t,i,s,r]:[t+r,t+i,s+i,s+r]).map(function(o){return e<2?n+o:"border"+o+n});Mi[e>1?"border"+n:n]=function(o,l,h,c,d){var f,p;if(arguments.length<4)return f=a.map(function(m){return Ne(o,m,h)}),p=f.join(" "),p.split(f[0]).length===5?f[0]:p;f=(c+"").split(" "),p={},a.forEach(function(m,u){return p[m]=f[u]=f[u]||f[(u-1)/2|0]}),o.init(l,p,d)}});var Nr={name:"css",register:fn,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,i,s,r){var a=this._props,o=e.style,l=i.vars.startAt,h,c,d,f,p,m,u,g,x,_,v,w,y,S,T,E;zn||fn(),this.styles=this.styles||Or(e),E=this.styles.props,this.tween=i;for(u in t)if(u!=="autoRound"&&(c=t[u],!(fe[u]&&br(u,t,i,s,e,r)))){if(p=typeof c,m=Mi[u],p==="function"&&(c=c.call(i,s,e,r),p=typeof c),p==="string"&&~c.indexOf("random(")&&(c=Jt(c)),m)m(this,e,u,c,i)&&(T=1);else if(u.substr(0,2)==="--")h=(getComputedStyle(e).getPropertyValue(u)+"").trim(),c+="",Ze.lastIndex=0,Ze.test(h)||(g=ne(h),x=ne(c)),x?g!==x&&(h=tt(e,u,h,x)+x):g&&(c+=g),this.add(o,"setProperty",h,c,s,r,0,0,u),a.push(u),E.push(u,0,o[u]);else if(p!=="undefined"){if(l&&u in l?(h=typeof l[u]=="function"?l[u].call(i,s,e,r):l[u],J(h)&&~h.indexOf("random(")&&(h=Jt(h)),ne(h+"")||h==="auto"||(h+=_e.units[u]||ne(Ne(e,u))||""),(h+"").charAt(1)==="="&&(h=Ne(e,u))):h=Ne(e,u),f=parseFloat(h),_=p==="string"&&c.charAt(1)==="="&&c.substr(0,2),_&&(c=c.substr(2)),d=parseFloat(c),u in ke&&(u==="autoAlpha"&&(f===1&&Ne(e,"visibility")==="hidden"&&d&&(f=0),E.push("visibility",0,o.visibility),Qe(this,o,"visibility",f?"inherit":"hidden",d?"inherit":"hidden",!d)),u!=="scale"&&u!=="transform"&&(u=ke[u],~u.indexOf(",")&&(u=u.split(",")[0]))),v=u in Ge,v){if(this.styles.save(u),w||(y=e._gsap,y.renderTransform&&!t.parseTransform||ni(e,t.parseTransform),S=t.smoothOrigin!==!1&&y.smooth,w=this._pt=new ce(this._pt,o,Y,0,1,y.renderTransform,y,0,-1),w.dep=1),u==="scale")this._pt=new ce(this._pt,y,"scaleY",y.scaleY,(_?Et(y.scaleY,_+d):d)-y.scaleY||0,un),this._pt.u=0,a.push("scaleY",u),u+="X";else if(u==="transformOrigin"){E.push(ue,0,o[ue]),c=mo(c),y.svg?pn(e,c,0,S,0,this):(x=parseFloat(c.split(" ")[2])||0,x!==y.zOrigin&&Qe(this,y,"zOrigin",y.zOrigin,x),Qe(this,o,u,Ci(h),Ci(c)));continue}else if(u==="svgOrigin"){pn(e,c,1,S,0,this);continue}else if(u in Br){xo(this,y,u,f,_?Et(f,_+c):c);continue}else if(u==="smoothOrigin"){Qe(this,y,"smooth",y.smooth,c);continue}else if(u==="force3D"){y[u]=c;continue}else if(u==="transform"){yo(this,c,e);continue}}else u in o||(u=kt(u)||u);if(v||(d||d===0)&&(f||f===0)&&!eo.test(c)&&u in o)g=(h+"").substr((f+"").length),d||(d=0),x=ne(c)||(u in _e.units?_e.units[u]:g),g!==x&&(f=tt(e,u,h,x)),this._pt=new ce(this._pt,v?y:o,u,f,(_?Et(f,_+d):d)-f,!v&&(x==="px"||u==="zIndex")&&t.autoRound!==!1?no:un),this._pt.u=x||0,g!==x&&x!=="%"&&(this._pt.b=h,this._pt.r=io);else if(u in o)po.call(this,e,u,h,_?_+c:c);else if(u in e)this.add(e,u,h||e[u],_?_+c:c,s,r);else if(u!=="parseTransform"){Pn(u,c);continue}v||(u in o?E.push(u,0,o[u]):E.push(u,1,h||e[u])),a.push(u)}}T&&Cr(this)},render:function(e,t){if(t.tween._time||!Un())for(var i=t._pt;i;)i.r(e,i.d),i=i._next;else t.styles.revert()},get:Ne,aliases:ke,getSetter:function(e,t,i){var s=ke[t];return s&&s.indexOf(",")<0&&(t=s),t in Ge&&t!==ue&&(e._gsap.x||Ne(e,"x"))?i&&is===i?t==="scale"?oo:ao:(is=i||{})&&(t==="scale"?lo:ho):e.style&&!An(e.style[t])?so:~t.indexOf("-")?ro:In(e,t)},core:{_removeProperty:vt,_getMatrix:Hn}};de.utils.checkPrefix=kt;de.core.getStyleSaver=Or;(function(n,e,t,i){var s=he(n+","+e+","+t,function(r){Ge[r]=1});he(e,function(r){_e.units[r]="deg",Br[r]=1}),ke[s[13]]=n+","+e,he(i,function(r){var a=r.split(":");ke[a[1]]=s[a[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");he("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(n){_e.units[n]="px"});de.registerPlugin(Nr);var Fi=de.registerPlugin(Nr)||de;Fi.core.Tween;Fi.registerPlugin(ScrollTrigger);const wo=Fi.utils.toArray(".fade");wo.forEach(n=>{Fi.fromTo(n,{opacity:0,scale:.9},{opacity:1,scale:1,duration:.5,scrollTrigger:{trigger:n,start:"center 65%",end:"center 35%",toggleActions:"play reverse play reverse"}})});/**
 * postprocessing v6.36.4 build Tue Nov 05 2024
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2024 Raoul van Rüschen
 * @license Zlib
 */var Qi=1/1e3,bo=1e3,So=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(n){typeof document<"u"&&document.hidden!==void 0&&(n?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=n)}get delta(){return this._delta*Qi}get fixedDelta(){return this._fixedDelta*Qi}set fixedDelta(n){this._fixedDelta=n*bo}get elapsed(){return this._elapsed*Qi}update(n){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(n!==void 0?n:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(n){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},To=(()=>{const n=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]),t=new jt;return t.setAttribute("position",new $n(n,3)),t.setAttribute("uv",new $n(e,2)),t})(),Be=class mn{static get fullscreenGeometry(){return To}constructor(e="Pass",t=new xi,i=new Jr){this.name=e,this.renderer=null,this.scene=t,this.camera=i,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const t=this.fullscreenMaterial;t!==null&&(t.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new A(mn.fullscreenGeometry,e),t.frustumCulled=!1,this.scene===null&&(this.scene=new xi),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=Lt){}render(e,t,i,s,r){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,i){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof Ft||t instanceof Rs||t instanceof ks||t instanceof mn)&&this[e].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},Eo=class extends Be{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(n,e,t,i,s){const r=n.state.buffers.stencil;r.setLocked(!1),r.setTest(!1)}},Ao=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <colorspace_fragment>
#include <dithering_fragment>
}`,Li="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",Hr=class extends xt{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new P(null),opacity:new P(1)},blending:It,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Ao,vertexShader:Li})}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.uniforms.inputBuffer.value=n}getOpacity(n){return this.uniforms.opacity.value}setOpacity(n){this.uniforms.opacity.value=n}},Mo=class extends Be{constructor(n,e=!0){super("CopyPass"),this.fullscreenMaterial=new Hr,this.needsSwap=!1,this.renderTarget=n,n===void 0&&(this.renderTarget=new Ft(1,1,{minFilter:yi,magFilter:yi,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(n){this.autoResize=n}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(n){this.autoResize=n}render(n,e,t,i,s){this.fullscreenMaterial.inputBuffer=e.texture,n.setRenderTarget(this.renderToScreen?null:this.renderTarget),n.render(this.scene,this.camera)}setSize(n,e){this.autoResize&&this.renderTarget.setSize(n,e)}initialize(n,e,t){t!==void 0&&(this.renderTarget.texture.type=t,t!==Je?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":n!==null&&n.outputColorSpace===ee&&(this.renderTarget.texture.colorSpace=ee))}},cs=new Ae,Gr=class extends Be{constructor(n=!0,e=!0,t=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=n,this.depth=e,this.stencil=t,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(n,e,t){this.color=n,this.depth=e,this.stencil=t}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(n){this.overrideClearColor=n}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(n){this.overrideClearAlpha=n}render(n,e,t,i,s){const r=this.overrideClearColor,a=this.overrideClearAlpha,o=n.getClearAlpha(),l=r!==null,h=a>=0;l?(n.getClearColor(cs),n.setClearColor(r,h?a:o)):h&&n.setClearAlpha(a),n.setRenderTarget(this.renderToScreen?null:e),n.clear(this.color,this.depth,this.stencil),l?n.setClearColor(cs,o):h&&n.setClearAlpha(o)}},Co=class extends Be{constructor(n,e){super("MaskPass",n,e),this.needsSwap=!1,this.clearPass=new Gr(!1,!1,!0),this.inverse=!1}set mainScene(n){this.scene=n}set mainCamera(n){this.camera=n}get inverted(){return this.inverse}set inverted(n){this.inverse=n}get clear(){return this.clearPass.enabled}set clear(n){this.clearPass.enabled=n}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(n){this.inverted=n}render(n,e,t,i,s){const r=n.getContext(),a=n.state.buffers,o=this.scene,l=this.camera,h=this.clearPass,c=this.inverted?0:1,d=1-c;a.color.setMask(!1),a.depth.setMask(!1),a.color.setLocked(!0),a.depth.setLocked(!0),a.stencil.setTest(!0),a.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),a.stencil.setFunc(r.ALWAYS,c,4294967295),a.stencil.setClear(d),a.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?h.render(n,null):(h.render(n,e),h.render(n,t))),this.renderToScreen?(n.setRenderTarget(null),n.render(o,l)):(n.setRenderTarget(e),n.render(o,l),n.setRenderTarget(t),n.render(o,l)),a.color.setLocked(!1),a.depth.setLocked(!1),a.stencil.setLocked(!1),a.stencil.setFunc(r.EQUAL,1,4294967295),a.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),a.stencil.setLocked(!0)}},Po=class{constructor(n=null,{depthBuffer:e=!0,stencilBuffer:t=!1,multisampling:i=0,frameBufferType:s}={}){this.renderer=null,this.inputBuffer=this.createBuffer(e,t,s,i),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new Mo,this.depthTexture=null,this.passes=[],this.timer=new So,this.autoRenderToScreen=!0,this.setRenderer(n)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(n){const e=this.inputBuffer,t=this.multisampling;t>0&&n>0?(this.inputBuffer.samples=n,this.outputBuffer.samples=n,this.inputBuffer.dispose(),this.outputBuffer.dispose()):t!==n&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(e.depthBuffer,e.stencilBuffer,e.texture.type,n),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(n){if(this.renderer=n,n!==null){const e=n.getSize(new pe),t=n.getContext().getContextAttributes().alpha,i=this.inputBuffer.texture.type;i===Je&&n.outputColorSpace===ee&&(this.inputBuffer.texture.colorSpace=ee,this.outputBuffer.texture.colorSpace=ee,this.inputBuffer.dispose(),this.outputBuffer.dispose()),n.autoClear=!1,this.setSize(e.width,e.height);for(const s of this.passes)s.initialize(n,t,i)}}replaceRenderer(n,e=!0){const t=this.renderer,i=t.domElement.parentNode;return this.setRenderer(n),e&&i!==null&&(i.removeChild(t.domElement),i.appendChild(n.domElement)),t}createDepthTexture(){const n=this.depthTexture=new Zr;return this.inputBuffer.depthTexture=n,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(n.format=jr,n.type=qr):n.type=Kr,n}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const n of this.passes)n.setDepthTexture(null)}}createBuffer(n,e,t,i){const s=this.renderer,r=s===null?new pe:s.getDrawingBufferSize(new pe),a={minFilter:yi,magFilter:yi,stencilBuffer:e,depthBuffer:n,type:t},o=new Ft(r.width,r.height,a);return i>0&&(o.ignoreDepthForMultisampleCopy=!1,o.samples=i),t===Je&&s!==null&&s.outputColorSpace===ee&&(o.texture.colorSpace=ee),o.texture.name="EffectComposer.Buffer",o.texture.generateMipmaps=!1,o}setMainScene(n){for(const e of this.passes)e.mainScene=n}setMainCamera(n){for(const e of this.passes)e.mainCamera=n}addPass(n,e){const t=this.passes,i=this.renderer,s=i.getDrawingBufferSize(new pe),r=i.getContext().getContextAttributes().alpha,a=this.inputBuffer.texture.type;if(n.setRenderer(i),n.setSize(s.width,s.height),n.initialize(i,r,a),this.autoRenderToScreen&&(t.length>0&&(t[t.length-1].renderToScreen=!1),n.renderToScreen&&(this.autoRenderToScreen=!1)),e!==void 0?t.splice(e,0,n):t.push(n),this.autoRenderToScreen&&(t[t.length-1].renderToScreen=!0),n.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const o=this.createDepthTexture();for(n of t)n.setDepthTexture(o)}else n.setDepthTexture(this.depthTexture)}removePass(n){const e=this.passes,t=e.indexOf(n);if(t!==-1&&e.splice(t,1).length>0){if(this.depthTexture!==null){const r=(o,l)=>o||l.needsDepthTexture;e.reduce(r,!1)||(n.getDepthTexture()===this.depthTexture&&n.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&t===e.length&&(n.renderToScreen=!1,e.length>0&&(e[e.length-1].renderToScreen=!0))}}removeAllPasses(){const n=this.passes;this.deleteDepthTexture(),n.length>0&&(this.autoRenderToScreen&&(n[n.length-1].renderToScreen=!1),this.passes=[])}render(n){const e=this.renderer,t=this.copyPass;let i=this.inputBuffer,s=this.outputBuffer,r=!1,a,o,l;n===void 0&&(this.timer.update(),n=this.timer.getDelta());for(const h of this.passes)h.enabled&&(h.render(e,i,s,n,r),h.needsSwap&&(r&&(t.renderToScreen=h.renderToScreen,a=e.getContext(),o=e.state.buffers.stencil,o.setFunc(a.NOTEQUAL,1,4294967295),t.render(e,i,s,n,r),o.setFunc(a.EQUAL,1,4294967295)),l=i,i=s,s=l),h instanceof Co?r=!0:h instanceof Eo&&(r=!1))}setSize(n,e,t){const i=this.renderer,s=i.getSize(new pe);(n===void 0||e===void 0)&&(n=s.width,e=s.height),(s.width!==n||s.height!==e)&&i.setSize(n,e,t);const r=i.getDrawingBufferSize(new pe);this.inputBuffer.setSize(r.width,r.height),this.outputBuffer.setSize(r.width,r.height);for(const a of this.passes)a.setSize(r.width,r.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const n of this.passes)n.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),Be.fullscreenGeometry.dispose()}},je={NONE:0,DEPTH:1,CONVOLUTION:2},k={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},Do=class{constructor(){this.shaderParts=new Map([[k.FRAGMENT_HEAD,null],[k.FRAGMENT_MAIN_UV,null],[k.FRAGMENT_MAIN_IMAGE,null],[k.VERTEX_HEAD,null],[k.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=je.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=Ps}},Wi=!1,us=class{constructor(n=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(n),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let t;if(e.material.flatShading)switch(e.material.side){case Gt:t=this.materialsFlatShadedDoubleSide;break;case li:t=this.materialsFlatShadedBackSide;break;default:t=this.materialsFlatShaded;break}else switch(e.material.side){case Gt:t=this.materialsDoubleSide;break;case li:t=this.materialsBackSide;break;default:t=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=t[2]:e.isInstancedMesh?e.material=t[1]:e.material=t[0],++this.meshCount}}}cloneMaterial(n){if(!(n instanceof xt))return n.clone();const e=n.uniforms,t=new Map;for(const s in e){const r=e[s].value;r.isRenderTargetTexture&&(e[s].value=null,t.set(s,r))}const i=n.clone();for(const s of t)e[s[0]].value=s[1],i.uniforms[s[0]].value=s[1];return i}setMaterial(n){if(this.disposeMaterials(),this.material=n,n!==null){const e=this.materials=[this.cloneMaterial(n),this.cloneMaterial(n),this.cloneMaterial(n)];for(const t of e)t.uniforms=Object.assign({},n.uniforms),t.side=ea;e[2].skinning=!0,this.materialsBackSide=e.map(t=>{const i=this.cloneMaterial(t);return i.uniforms=Object.assign({},n.uniforms),i.side=li,i}),this.materialsDoubleSide=e.map(t=>{const i=this.cloneMaterial(t);return i.uniforms=Object.assign({},n.uniforms),i.side=Gt,i}),this.materialsFlatShaded=e.map(t=>{const i=this.cloneMaterial(t);return i.uniforms=Object.assign({},n.uniforms),i.flatShading=!0,i}),this.materialsFlatShadedBackSide=e.map(t=>{const i=this.cloneMaterial(t);return i.uniforms=Object.assign({},n.uniforms),i.flatShading=!0,i.side=li,i}),this.materialsFlatShadedDoubleSide=e.map(t=>{const i=this.cloneMaterial(t);return i.uniforms=Object.assign({},n.uniforms),i.flatShading=!0,i.side=Gt,i})}}render(n,e,t){const i=n.shadowMap.enabled;if(n.shadowMap.enabled=!1,Wi){const s=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),n.render(e,t);for(const r of s)r[0].material=r[1];this.meshCount!==s.size&&s.clear()}else{const s=e.overrideMaterial;e.overrideMaterial=this.material,n.render(e,t),e.overrideMaterial=s}n.shadowMap.enabled=i}disposeMaterials(){if(this.material!==null){const n=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const e of n)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return Wi}static set workaroundEnabled(n){Wi=n}},Ve=-1,ut=class extends Sn{constructor(n,e=Ve,t=Ve,i=1){super(),this.resizable=n,this.baseSize=new pe(1,1),this.preferredSize=new pe(e,t),this.target=this.preferredSize,this.s=i,this.effectiveSize=new pe,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const n=this.baseSize,e=this.preferredSize,t=this.effectiveSize,i=this.scale;e.width!==Ve?t.width=e.width:e.height!==Ve?t.width=Math.round(e.height*(n.width/Math.max(n.height,1))):t.width=Math.round(n.width*i),e.height!==Ve?t.height=e.height:e.width!==Ve?t.height=Math.round(e.width/Math.max(n.width/Math.max(n.height,1),1)):t.height=Math.round(n.height*i)}get width(){return this.effectiveSize.width}set width(n){this.preferredWidth=n}get height(){return this.effectiveSize.height}set height(n){this.preferredHeight=n}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(n){this.s!==n&&(this.s=n,this.preferredSize.setScalar(Ve),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(n){this.scale=n}get baseWidth(){return this.baseSize.width}set baseWidth(n){this.baseSize.width!==n&&(this.baseSize.width=n,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(n){this.baseWidth=n}get baseHeight(){return this.baseSize.height}set baseHeight(n){this.baseSize.height!==n&&(this.baseSize.height=n,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(n){this.baseHeight=n}setBaseSize(n,e){(this.baseSize.width!==n||this.baseSize.height!==e)&&(this.baseSize.set(n,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(n){this.preferredSize.width!==n&&(this.preferredSize.width=n,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(n){this.preferredWidth=n}get preferredHeight(){return this.preferredSize.height}set preferredHeight(n){this.preferredSize.height!==n&&(this.preferredSize.height=n,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(n){this.preferredHeight=n}setPreferredSize(n,e){(this.preferredSize.width!==n||this.preferredSize.height!==e)&&(this.preferredSize.set(n,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(n){this.s=n.scale,this.baseSize.set(n.baseWidth,n.baseHeight),this.preferredSize.set(n.preferredWidth,n.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return Ve}},M={SKIP:9,SET:30,ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},Ro="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y,opacity);}",ko="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,min(y.a,opacity));}",Oo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y)*0.5,opacity);}",Fo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.rg,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",Lo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(step(0.0,y)*(1.0-min(vec4(1.0),(1.0-x)/y)),vec4(1.0),step(1.0,x));return mix(x,z,opacity);}",Io="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=step(0.0,x)*mix(min(vec4(1.0),x/max(1.0-y,1e-9)),vec4(1.0),step(1.0,y));return mix(x,z,opacity);}",Bo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x,y),opacity);}",zo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,abs(x-y),opacity);}",Uo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x/max(y,1e-12),opacity);}",No="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y-2.0*x*y),opacity);}",Ho="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 a=min(x,1.0),b=min(y,1.0);vec4 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,y));return mix(x,z,opacity);}",Go="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,step(1.0,x+y),opacity);}",Vo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.r,xHSL.gb));return vec4(mix(x.rgb,z,opacity),y.a);}",$o="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-y,opacity);}",Yo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y*(1.0-x),opacity);}",Xo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x,y),opacity);}",Qo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(y+x-1.0,0.0,1.0),opacity);}",Wo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x+y,1.0),opacity);}",Zo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(2.0*y+x-1.0,0.0,1.0),opacity);}",jo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.rg,yHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",qo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x*y,opacity);}",Ko="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-abs(1.0-x-y),opacity);}",Jo="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,opacity);}",el="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(2.0*y*x,1.0-2.0*(1.0-y)*(1.0-x),step(0.5,x));return mix(x,z,opacity);}",tl="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 z=mix(mix(y2,x,step(0.5*x,y)),max(vec4(0.0),y2-1.0),step(x,(y2-1.0)));return mix(x,z,opacity);}",il="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(min(x*x/max(1.0-y,1e-12),1.0),y,step(1.0,y));return mix(x,z,opacity);}",nl="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.r,yHSL.g,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",sl="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y-min(x*y,1.0),opacity);}",rl="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 w=step(0.5,y);vec4 z=mix(x-(1.0-y2)*x*(1.0-x),mix(x+(y2-1.0)*(sqrt(x)-x),x+(y2-1.0)*x*((16.0*x-12.0)*x+3.0),w*(1.0-step(0.25,x))),w);return mix(x,z,opacity);}",al="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}",ol="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x+y-1.0,0.0),opacity);}",ll="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(max(1.0-min((1.0-x)/(2.0*y),1.0),0.0),min(x/(2.0*(1.0-y)),1.0),step(0.5,y));return mix(x,z,opacity);}",hl=new Map([[M.ADD,Ro],[M.ALPHA,ko],[M.AVERAGE,Oo],[M.COLOR,Fo],[M.COLOR_BURN,Lo],[M.COLOR_DODGE,Io],[M.DARKEN,Bo],[M.DIFFERENCE,zo],[M.DIVIDE,Uo],[M.DST,null],[M.EXCLUSION,No],[M.HARD_LIGHT,Ho],[M.HARD_MIX,Go],[M.HUE,Vo],[M.INVERT,$o],[M.INVERT_RGB,Yo],[M.LIGHTEN,Xo],[M.LINEAR_BURN,Qo],[M.LINEAR_DODGE,Wo],[M.LINEAR_LIGHT,Zo],[M.LUMINOSITY,jo],[M.MULTIPLY,qo],[M.NEGATION,Ko],[M.NORMAL,Jo],[M.OVERLAY,el],[M.PIN_LIGHT,tl],[M.REFLECT,il],[M.SATURATION,nl],[M.SCREEN,sl],[M.SOFT_LIGHT,rl],[M.SRC,al],[M.SUBTRACT,ol],[M.VIVID_LIGHT,ll]]),cl=class extends Sn{constructor(n,e=1){super(),this._blendFunction=n,this.opacity=new P(e)}getOpacity(){return this.opacity.value}setOpacity(n){this.opacity.value=n}get blendFunction(){return this._blendFunction}set blendFunction(n){this._blendFunction=n,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(n){this.blendFunction=n}getShaderCode(){return hl.get(this.blendFunction)}},Gn={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},ul=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <colorspace_fragment>
}`,dl="uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",fl=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],pl=class extends xt{constructor(n=new Yn){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new P(null),texelSize:new P(new Yn),scale:new P(1),kernel:new P(0)},blending:It,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:ul,vertexShader:dl}),this.setTexelSize(n.x,n.y),this.kernelSize=Gn.MEDIUM}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.inputBuffer=n}get kernelSequence(){return fl[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(n){this.uniforms.scale.value=n}getScale(){return this.uniforms.scale.value}setScale(n){this.uniforms.scale.value=n}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(n){this.uniforms.kernel.value=n}setKernel(n){this.kernel=n}setTexelSize(n,e){this.uniforms.texelSize.value.set(n,e,n*.5,e*.5)}setSize(n,e){const t=1/n,i=1/e;this.uniforms.texelSize.value.set(t,i,t*.5,i*.5)}},ml=class extends Be{constructor({kernelSize:n=Gn.MEDIUM,resolutionScale:e=.5,width:t=ut.AUTO_SIZE,height:i=ut.AUTO_SIZE,resolutionX:s=t,resolutionY:r=i}={}){super("KawaseBlurPass"),this.renderTargetA=new Ft(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const a=this.resolution=new ut(this,s,r,e);a.addEventListener("change",o=>this.setSize(a.baseWidth,a.baseHeight)),this._blurMaterial=new pl,this._blurMaterial.kernelSize=n,this.copyMaterial=new Hr}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(n){this._blurMaterial=n}get dithering(){return this.copyMaterial.dithering}set dithering(n){this.copyMaterial.dithering=n}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(n){this.blurMaterial.kernelSize=n}get width(){return this.resolution.width}set width(n){this.resolution.preferredWidth=n}get height(){return this.resolution.height}set height(n){this.resolution.preferredHeight=n}get scale(){return this.blurMaterial.scale}set scale(n){this.blurMaterial.scale=n}getScale(){return this.blurMaterial.scale}setScale(n){this.blurMaterial.scale=n}getKernelSize(){return this.kernelSize}setKernelSize(n){this.kernelSize=n}getResolutionScale(){return this.resolution.scale}setResolutionScale(n){this.resolution.scale=n}render(n,e,t,i,s){const r=this.scene,a=this.camera,o=this.renderTargetA,l=this.renderTargetB,h=this.blurMaterial,c=h.kernelSequence;let d=e;this.fullscreenMaterial=h;for(let f=0,p=c.length;f<p;++f){const m=f&1?l:o;h.kernel=c[f],h.inputBuffer=d.texture,n.setRenderTarget(m),n.render(r,a),d=m}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=d.texture,n.setRenderTarget(this.renderToScreen?null:t),n.render(r,a)}setSize(n,e){const t=this.resolution;t.setBaseSize(n,e);const i=t.width,s=t.height;this.renderTargetA.setSize(i,s),this.renderTargetB.setSize(i,s),this.blurMaterial.setSize(n,e)}initialize(n,e,t){t!==void 0&&(this.renderTargetA.texture.type=t,this.renderTargetB.texture.type=t,t!==Je?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):n!==null&&n.outputColorSpace===ee&&(this.renderTargetA.texture.colorSpace=ee,this.renderTargetB.texture.colorSpace=ee))}static get AUTO_SIZE(){return ut.AUTO_SIZE}},Vr=class extends Sn{constructor(n,e,{attributes:t=je.NONE,blendFunction:i=M.NORMAL,defines:s=new Map,uniforms:r=new Map,extensions:a=null,vertexShader:o=null}={}){super(),this.name=n,this.renderer=null,this.attributes=t,this.fragmentShader=e,this.vertexShader=o,this.defines=s,this.uniforms=r,this.extensions=a,this.blendMode=new cl(i),this.blendMode.addEventListener("change",l=>this.setChanged()),this._inputColorSpace=Ps,this._outputColorSpace=Ds}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(n){this._inputColorSpace=n,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(n){this._outputColorSpace=n,this.setChanged()}set mainScene(n){}set mainCamera(n){}getName(){return this.name}setRenderer(n){this.renderer=n}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(n){this.attributes=n,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(n){this.fragmentShader=n,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(n){this.vertexShader=n,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(n,e=Lt){}update(n,e,t){}setSize(n,e){}initialize(n,e,t){}dispose(){for(const n of Object.keys(this)){const e=this[n];(e instanceof Ft||e instanceof Rs||e instanceof ks||e instanceof Be)&&this[n].dispose()}}},$r={RED:0,GREEN:1,BLUE:2,ALPHA:3},Yr={DISCARD:0,MULTIPLY:1,MULTIPLY_RGB_SET_ALPHA:2,MULTIPLY_RGB:3},gl=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if PASS == 1
uniform vec4 kernel64[32];
#else
uniform vec4 kernel16[8];
#endif
uniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;varying vec2 vUv;void main(){
#ifdef FOREGROUND
vec2 cocNearFar=texture2D(cocBuffer,vUv).rg*scale;float coc=cocNearFar.x;
#else
float coc=texture2D(cocBuffer,vUv).g*scale;
#endif
if(coc==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{
#ifdef FOREGROUND
vec2 step=texelSize*max(cocNearFar.x,cocNearFar.y);
#else
vec2 step=texelSize*coc;
#endif
#if PASS == 1
vec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;
#else
vec4 maxValue=texture2D(inputBuffer,vUv);for(int i=0;i<8;++i){vec4 kernel=kernel16[i];vec2 uv=step*kernel.xy+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);uv=step*kernel.zw+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);}gl_FragColor=maxValue;
#endif
}}`,ui=class extends xt{constructor(n=!1,e=!1){super({name:"BokehMaterial",defines:{PASS:n?"2":"1"},uniforms:{inputBuffer:new P(null),cocBuffer:new P(null),texelSize:new P(new pe),kernel64:new P(null),kernel16:new P(null),scale:new P(1)},blending:It,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:gl,vertexShader:Li}),e&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.uniforms.inputBuffer.value=n}set cocBuffer(n){this.uniforms.cocBuffer.value=n}setCoCBuffer(n){this.uniforms.cocBuffer.value=n}get scale(){return this.uniforms.scale.value}set scale(n){this.uniforms.scale.value=n}getScale(n){return this.scale}setScale(n){this.scale=n}generateKernel(){const n=2.39996323,e=new Float64Array(128),t=new Float64Array(32);let i=0,s=0;for(let r=0,a=Math.sqrt(80);r<80;++r){const o=r*n,l=Math.sqrt(r)/a,h=l*Math.cos(o),c=l*Math.sin(o);r%5===0?(t[s++]=h,t[s++]=c):(e[i++]=h,e[i++]=c)}this.uniforms.kernel64.value=e,this.uniforms.kernel16.value=t}setTexelSize(n,e){this.uniforms.texelSize.value.set(n,e)}setSize(n,e){this.uniforms.texelSize.value.set(1/n,1/e)}};function ds(n,e,t){return n*(e-t)-e}function gn(n,e,t){return Math.min(Math.max((n+e)/(e-t),0),1)}var _l=`#include <common>
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
float depth=unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
float depth=texture2D(depthBuffer,uv).r;
#endif
#ifdef LOG_DEPTH
float d=pow(2.0,depth*log2(cameraFar+1.0))-1.0;float a=cameraFar/(cameraFar-cameraNear);float b=cameraFar*cameraNear/(cameraNear-cameraFar);depth=a+b/d;
#endif
return depth;}void main(){float depth=readDepth(vUv);
#ifdef PERSPECTIVE_CAMERA
float viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);
#else
float linearDepth=depth;
#endif
float signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}`,vl=class extends xt{constructor(n){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new P(null),focusDistance:new P(0),focusRange:new P(0),cameraNear:new P(.3),cameraFar:new P(1e3)},blending:It,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:_l,vertexShader:Li}),this.uniforms.focalLength=this.uniforms.focusRange,this.copyCameraSettings(n)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(n){this.uniforms.depthBuffer.value=n}set depthPacking(n){this.defines.DEPTH_PACKING=n.toFixed(0),this.needsUpdate=!0}setDepthBuffer(n,e=Lt){this.depthBuffer=n,this.depthPacking=e}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(n){this.uniforms.focusDistance.value=n}get worldFocusDistance(){return-ds(this.focusDistance,this.near,this.far)}set worldFocusDistance(n){this.focusDistance=gn(-n,this.near,this.far)}getFocusDistance(n){this.uniforms.focusDistance.value=n}setFocusDistance(n){this.uniforms.focusDistance.value=n}get focalLength(){return this.focusRange}set focalLength(n){this.focusRange=n}get focusRange(){return this.uniforms.focusRange.value}set focusRange(n){this.uniforms.focusRange.value=n}get worldFocusRange(){return-ds(this.focusRange,this.near,this.far)}set worldFocusRange(n){this.focusRange=gn(-n,this.near,this.far)}getFocalLength(n){return this.focusRange}setFocalLength(n){this.focusRange=n}adoptCameraSettings(n){this.copyCameraSettings(n)}copyCameraSettings(n){n&&(this.uniforms.cameraNear.value=n.near,this.uniforms.cameraFar.value=n.far,n instanceof Di?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},xl=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef MASK_PRECISION_HIGH
uniform mediump sampler2D maskTexture;
#else
uniform lowp sampler2D maskTexture;
#endif
#if MASK_FUNCTION != 0
uniform float strength;
#endif
varying vec2 vUv;void main(){
#if COLOR_CHANNEL == 0
float mask=texture2D(maskTexture,vUv).r;
#elif COLOR_CHANNEL == 1
float mask=texture2D(maskTexture,vUv).g;
#elif COLOR_CHANNEL == 2
float mask=texture2D(maskTexture,vUv).b;
#else
float mask=texture2D(maskTexture,vUv).a;
#endif
#if MASK_FUNCTION == 0
#ifdef INVERTED
mask=step(mask,0.0);
#else
mask=1.0-step(mask,0.0);
#endif
#else
mask=clamp(mask*strength,0.0,1.0);
#ifdef INVERTED
mask=1.0-mask;
#endif
#endif
#if MASK_FUNCTION == 3
vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=vec4(mask*texel.rgb,texel.a);
#elif MASK_FUNCTION == 2
gl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);
#else
gl_FragColor=mask*texture2D(inputBuffer,vUv);
#endif
}`,yl=class extends xt{constructor(n=null){super({name:"MaskMaterial",uniforms:{maskTexture:new P(n),inputBuffer:new P(null),strength:new P(1)},blending:It,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:xl,vertexShader:Li}),this.colorChannel=$r.RED,this.maskFunction=Yr.DISCARD}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.uniforms.inputBuffer.value=n}set maskTexture(n){this.uniforms.maskTexture.value=n,delete this.defines.MASK_PRECISION_HIGH,n.type!==Je&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(n){this.maskTexture=n}set colorChannel(n){this.defines.COLOR_CHANNEL=n.toFixed(0),this.needsUpdate=!0}setColorChannel(n){this.colorChannel=n}set maskFunction(n){this.defines.MASK_FUNCTION=n.toFixed(0),this.needsUpdate=!0}setMaskFunction(n){this.maskFunction=n}get inverted(){return this.defines.INVERTED!==void 0}set inverted(n){this.inverted&&!n?delete this.defines.INVERTED:n&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(n){this.inverted=n}get strength(){return this.uniforms.strength.value}set strength(n){this.uniforms.strength.value=n}getStrength(){return this.strength}setStrength(n){this.strength=n}},bt=class extends Be{constructor(n,e="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=n,this.input=e}setInput(n){this.input=n}render(n,e,t,i,s){const r=this.fullscreenMaterial.uniforms;e!==null&&r!==void 0&&r[this.input]!==void 0&&(r[this.input].value=e.texture),n.setRenderTarget(this.renderToScreen?null:t),n.render(this.scene,this.camera)}initialize(n,e,t){t!==void 0&&t!==Je&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},wl=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;
#else
uniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;
#endif
uniform lowp sampler2D nearCoCBuffer;uniform lowp sampler2D farCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);
#if MASK_FUNCTION == 1
vec2 cocNearFar=vec2(texture2D(nearCoCBuffer,uv).r,colorFar.a);cocNearFar.x=min(cocNearFar.x*scale,1.0);
#else
vec2 cocNearFar=vec2(texture2D(nearCoCBuffer,uv).r,texture2D(farCoCBuffer,uv).g);cocNearFar=min(cocNearFar*scale,1.0);
#endif
vec4 result=inputColor*(1.0-cocNearFar.y)+colorFar;result=mix(result,colorNear,cocNearFar.x);outputColor=result;}`,bl=class extends Vr{constructor(n,{blendFunction:e,worldFocusDistance:t,worldFocusRange:i,focusDistance:s=0,focalLength:r=.1,focusRange:a=r,bokehScale:o=1,resolutionScale:l=1,width:h=ut.AUTO_SIZE,height:c=ut.AUTO_SIZE,resolutionX:d=h,resolutionY:f=c}={}){super("DepthOfFieldEffect",wl,{blendFunction:e,attributes:je.DEPTH,uniforms:new Map([["nearColorBuffer",new P(null)],["farColorBuffer",new P(null)],["nearCoCBuffer",new P(null)],["farCoCBuffer",new P(null)],["scale",new P(1)]])}),this.camera=n,this.renderTarget=new Ft(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.uniforms.get("farCoCBuffer").value=this.renderTargetCoC.texture,this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new bt(new vl(n));const p=this.cocMaterial;p.focusDistance=s,p.focusRange=a,t!==void 0&&(p.worldFocusDistance=t),i!==void 0&&(p.worldFocusRange=i),this.blurPass=new ml({resolutionScale:l,resolutionX:d,resolutionY:f,kernelSize:Gn.MEDIUM}),this.maskPass=new bt(new yl(this.renderTargetCoC.texture));const m=this.maskPass.fullscreenMaterial;m.colorChannel=$r.GREEN,this.maskFunction=Yr.MULTIPLY_RGB,this.bokehNearBasePass=new bt(new ui(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new bt(new ui(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new bt(new ui(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new bt(new ui(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null;const u=this.resolution=new ut(this,d,f,l);u.addEventListener("change",g=>this.setSize(u.baseWidth,u.baseHeight)),this.bokehScale=o}set mainCamera(n){this.camera=n,this.cocMaterial.copyCameraSettings(n)}get cocTexture(){return this.renderTargetCoC.texture}get maskFunction(){return this.maskPass.fullscreenMaterial.maskFunction}set maskFunction(n){this.maskFunction!==n&&(this.defines.set("MASK_FUNCTION",n.toFixed(0)),this.maskPass.fullscreenMaterial.maskFunction=n,this.setChanged())}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.cocMaterial}getBlurPass(){return this.blurPass}getResolution(){return this.resolution}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(n){this.bokehNearBasePass.fullscreenMaterial.scale=n,this.bokehNearFillPass.fullscreenMaterial.scale=n,this.bokehFarBasePass.fullscreenMaterial.scale=n,this.bokehFarFillPass.fullscreenMaterial.scale=n,this.maskPass.fullscreenMaterial.strength=n,this.uniforms.get("scale").value=n}getBokehScale(){return this.bokehScale}setBokehScale(n){this.bokehScale=n}getTarget(){return this.target}setTarget(n){this.target=n}calculateFocusDistance(n){const e=this.camera,t=e.position.distanceTo(n);return gn(-t,e.near,e.far)}setDepthTexture(n,e=Lt){this.cocMaterial.depthBuffer=n,this.cocMaterial.depthPacking=e}update(n,e,t){const i=this.renderTarget,s=this.renderTargetCoC,r=this.renderTargetCoCBlurred,a=this.renderTargetMasked;if(this.target!==null){const o=this.calculateFocusDistance(this.target);this.cocMaterial.focusDistance=o}this.cocPass.render(n,null,s),this.blurPass.render(n,s,r),this.maskPass.render(n,e,a),this.bokehFarBasePass.render(n,a,i),this.bokehFarFillPass.render(n,i,this.renderTargetFar),this.bokehNearBasePass.render(n,e,i),this.bokehNearFillPass.render(n,i,this.renderTargetNear)}setSize(n,e){const t=this.resolution;t.setBaseSize(n,e);const i=t.width,s=t.height;this.cocPass.setSize(n,e),this.blurPass.setSize(n,e),this.maskPass.setSize(n,e),this.renderTargetFar.setSize(n,e),this.renderTargetCoC.setSize(n,e),this.renderTargetMasked.setSize(n,e),this.renderTarget.setSize(i,s),this.renderTargetNear.setSize(i,s),this.renderTargetCoCBlurred.setSize(i,s),this.bokehNearBasePass.fullscreenMaterial.setSize(n,e),this.bokehNearFillPass.fullscreenMaterial.setSize(n,e),this.bokehFarBasePass.fullscreenMaterial.setSize(n,e),this.bokehFarFillPass.fullscreenMaterial.setSize(n,e)}initialize(n,e,t){this.cocPass.initialize(n,e,t),this.maskPass.initialize(n,e,t),this.bokehNearBasePass.initialize(n,e,t),this.bokehNearFillPass.initialize(n,e,t),this.bokehFarBasePass.initialize(n,e,t),this.bokehFarFillPass.initialize(n,e,t),this.blurPass.initialize(n,e,Je),n.capabilities.logarithmicDepthBuffer&&(this.cocPass.fullscreenMaterial.defines.LOG_DEPTH="1"),t!==void 0&&(this.renderTarget.texture.type=t,this.renderTargetNear.texture.type=t,this.renderTargetFar.texture.type=t,this.renderTargetMasked.texture.type=t,n!==null&&n.outputColorSpace===ee&&(this.renderTarget.texture.colorSpace=ee,this.renderTargetNear.texture.colorSpace=ee,this.renderTargetFar.texture.colorSpace=ee,this.renderTargetMasked.texture.colorSpace=ee))}},Sl=`#define QUALITY(q) ((q) < 5 ? 1.0 : ((q) > 5 ? ((q) < 10 ? 2.0 : ((q) < 11 ? 4.0 : 8.0)) : 1.5))
#define ONE_OVER_TWELVE 0.08333333333333333
varying vec2 vUvDown;varying vec2 vUvUp;varying vec2 vUvLeft;varying vec2 vUvRight;varying vec2 vUvDownLeft;varying vec2 vUvUpRight;varying vec2 vUvUpLeft;varying vec2 vUvDownRight;vec4 fxaa(const in vec4 inputColor,const in vec2 uv){float lumaCenter=luminance(inputColor.rgb);float lumaDown=luminance(texture2D(inputBuffer,vUvDown).rgb);float lumaUp=luminance(texture2D(inputBuffer,vUvUp).rgb);float lumaLeft=luminance(texture2D(inputBuffer,vUvLeft).rgb);float lumaRight=luminance(texture2D(inputBuffer,vUvRight).rgb);float lumaMin=min(lumaCenter,min(min(lumaDown,lumaUp),min(lumaLeft,lumaRight)));float lumaMax=max(lumaCenter,max(max(lumaDown,lumaUp),max(lumaLeft,lumaRight)));float lumaRange=lumaMax-lumaMin;if(lumaRange<max(EDGE_THRESHOLD_MIN,lumaMax*EDGE_THRESHOLD_MAX)){return inputColor;}float lumaDownLeft=luminance(texture2D(inputBuffer,vUvDownLeft).rgb);float lumaUpRight=luminance(texture2D(inputBuffer,vUvUpRight).rgb);float lumaUpLeft=luminance(texture2D(inputBuffer,vUvUpLeft).rgb);float lumaDownRight=luminance(texture2D(inputBuffer,vUvDownRight).rgb);float lumaDownUp=lumaDown+lumaUp;float lumaLeftRight=lumaLeft+lumaRight;float lumaLeftCorners=lumaDownLeft+lumaUpLeft;float lumaDownCorners=lumaDownLeft+lumaDownRight;float lumaRightCorners=lumaDownRight+lumaUpRight;float lumaUpCorners=lumaUpRight+lumaUpLeft;float edgeHorizontal=(abs(-2.0*lumaLeft+lumaLeftCorners)+abs(-2.0*lumaCenter+lumaDownUp)*2.0+abs(-2.0*lumaRight+lumaRightCorners));float edgeVertical=(abs(-2.0*lumaUp+lumaUpCorners)+abs(-2.0*lumaCenter+lumaLeftRight)*2.0+abs(-2.0*lumaDown+lumaDownCorners));bool isHorizontal=(edgeHorizontal>=edgeVertical);float stepLength=isHorizontal?texelSize.y:texelSize.x;float luma1=isHorizontal?lumaDown:lumaLeft;float luma2=isHorizontal?lumaUp:lumaRight;float gradient1=abs(luma1-lumaCenter);float gradient2=abs(luma2-lumaCenter);bool is1Steepest=gradient1>=gradient2;float gradientScaled=0.25*max(gradient1,gradient2);float lumaLocalAverage=0.0;if(is1Steepest){stepLength=-stepLength;lumaLocalAverage=0.5*(luma1+lumaCenter);}else{lumaLocalAverage=0.5*(luma2+lumaCenter);}vec2 currentUv=uv;if(isHorizontal){currentUv.y+=stepLength*0.5;}else{currentUv.x+=stepLength*0.5;}vec2 offset=isHorizontal?vec2(texelSize.x,0.0):vec2(0.0,texelSize.y);vec2 uv1=currentUv-offset*QUALITY(0);vec2 uv2=currentUv+offset*QUALITY(0);float lumaEnd1=luminance(texture2D(inputBuffer,uv1).rgb);float lumaEnd2=luminance(texture2D(inputBuffer,uv2).rgb);lumaEnd1-=lumaLocalAverage;lumaEnd2-=lumaLocalAverage;bool reached1=abs(lumaEnd1)>=gradientScaled;bool reached2=abs(lumaEnd2)>=gradientScaled;bool reachedBoth=reached1&&reached2;if(!reached1){uv1-=offset*QUALITY(1);}if(!reached2){uv2+=offset*QUALITY(1);}if(!reachedBoth){for(int i=2;i<SAMPLES;++i){if(!reached1){lumaEnd1=luminance(texture2D(inputBuffer,uv1).rgb);lumaEnd1=lumaEnd1-lumaLocalAverage;}if(!reached2){lumaEnd2=luminance(texture2D(inputBuffer,uv2).rgb);lumaEnd2=lumaEnd2-lumaLocalAverage;}reached1=abs(lumaEnd1)>=gradientScaled;reached2=abs(lumaEnd2)>=gradientScaled;reachedBoth=reached1&&reached2;if(!reached1){uv1-=offset*QUALITY(i);}if(!reached2){uv2+=offset*QUALITY(i);}if(reachedBoth){break;}}}float distance1=isHorizontal?(uv.x-uv1.x):(uv.y-uv1.y);float distance2=isHorizontal?(uv2.x-uv.x):(uv2.y-uv.y);bool isDirection1=distance1<distance2;float distanceFinal=min(distance1,distance2);float edgeThickness=(distance1+distance2);bool isLumaCenterSmaller=lumaCenter<lumaLocalAverage;bool correctVariation1=(lumaEnd1<0.0)!=isLumaCenterSmaller;bool correctVariation2=(lumaEnd2<0.0)!=isLumaCenterSmaller;bool correctVariation=isDirection1?correctVariation1:correctVariation2;float pixelOffset=-distanceFinal/edgeThickness+0.5;float finalOffset=correctVariation?pixelOffset:0.0;float lumaAverage=ONE_OVER_TWELVE*(2.0*(lumaDownUp+lumaLeftRight)+lumaLeftCorners+lumaRightCorners);float subPixelOffset1=clamp(abs(lumaAverage-lumaCenter)/lumaRange,0.0,1.0);float subPixelOffset2=(-2.0*subPixelOffset1+3.0)*subPixelOffset1*subPixelOffset1;float subPixelOffsetFinal=subPixelOffset2*subPixelOffset2*SUBPIXEL_QUALITY;finalOffset=max(finalOffset,subPixelOffsetFinal);vec2 finalUv=uv;if(isHorizontal){finalUv.y+=finalOffset*stepLength;}else{finalUv.x+=finalOffset*stepLength;}return texture2D(inputBuffer,finalUv);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=fxaa(inputColor,uv);}`,Tl="varying vec2 vUvDown;varying vec2 vUvUp;varying vec2 vUvLeft;varying vec2 vUvRight;varying vec2 vUvDownLeft;varying vec2 vUvUpRight;varying vec2 vUvUpLeft;varying vec2 vUvDownRight;void mainSupport(const in vec2 uv){vUvDown=uv+vec2(0.0,-1.0)*texelSize;vUvUp=uv+vec2(0.0,1.0)*texelSize;vUvRight=uv+vec2(1.0,0.0)*texelSize;vUvLeft=uv+vec2(-1.0,0.0)*texelSize;vUvDownLeft=uv+vec2(-1.0,-1.0)*texelSize;vUvUpRight=uv+vec2(1.0,1.0)*texelSize;vUvUpLeft=uv+vec2(-1.0,1.0)*texelSize;vUvDownRight=uv+vec2(1.0,-1.0)*texelSize;}",El=class extends Vr{constructor({blendFunction:n=M.SRC}={}){super("FXAAEffect",Sl,{vertexShader:Tl,blendFunction:n,defines:new Map([["EDGE_THRESHOLD_MIN","0.0312"],["EDGE_THRESHOLD_MAX","0.125"],["SUBPIXEL_QUALITY","0.75"],["SAMPLES","12"]])})}get minEdgeThreshold(){return Number(this.defines.get("EDGE_THRESHOLD_MIN"))}set minEdgeThreshold(n){this.defines.set("EDGE_THRESHOLD_MIN",n.toFixed(12)),this.setChanged()}get maxEdgeThreshold(){return Number(this.defines.get("EDGE_THRESHOLD_MAX"))}set maxEdgeThreshold(n){this.defines.set("EDGE_THRESHOLD_MAX",n.toFixed(12)),this.setChanged()}get subpixelQuality(){return Number(this.defines.get("SUBPIXEL_QUALITY"))}set subpixelQuality(n){this.defines.set("SUBPIXEL_QUALITY",n.toFixed(12)),this.setChanged()}get samples(){return Number(this.defines.get("SAMPLES"))}set samples(n){this.defines.set("SAMPLES",n.toFixed(0)),this.setChanged()}},Al=class extends Be{constructor(n,e,t=null){super("RenderPass",n,e),this.needsSwap=!1,this.clearPass=new Gr,this.overrideMaterialManager=t===null?null:new us(t),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(n){this.scene=n}set mainCamera(n){this.camera=n}get renderToScreen(){return super.renderToScreen}set renderToScreen(n){super.renderToScreen=n,this.clearPass.renderToScreen=n}get overrideMaterial(){const n=this.overrideMaterialManager;return n!==null?n.material:null}set overrideMaterial(n){const e=this.overrideMaterialManager;n!==null?e!==null?e.setMaterial(n):this.overrideMaterialManager=new us(n):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(n){this.overrideMaterial=n}get clear(){return this.clearPass.enabled}set clear(n){this.clearPass.enabled=n}getSelection(){return this.selection}setSelection(n){this.selection=n}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(n){this.ignoreBackground=n}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(n){this.skipShadowMapUpdate=n}getClearPass(){return this.clearPass}render(n,e,t,i,s){const r=this.scene,a=this.camera,o=this.selection,l=a.layers.mask,h=r.background,c=n.shadowMap.autoUpdate,d=this.renderToScreen?null:e;o!==null&&a.layers.set(o.getLayer()),this.skipShadowMapUpdate&&(n.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(r.background=null),this.clearPass.enabled&&this.clearPass.render(n,e),n.setRenderTarget(d),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(n,r,a):n.render(r,a),a.layers.mask=l,r.background=h,n.shadowMap.autoUpdate=c}},Ml=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,Cl="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",Pl=class extends xt{constructor(n,e,t,i,s=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:ta.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new P(null),depthBuffer:new P(null),resolution:new P(new pe),texelSize:new P(new pe),cameraNear:new P(.3),cameraFar:new P(1e3),aspect:new P(1),time:new P(0)},blending:It,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:s}),n&&this.setShaderParts(n),e&&this.setDefines(e),t&&this.setUniforms(t),this.copyCameraSettings(i)}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.uniforms.inputBuffer.value=n}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(n){this.uniforms.depthBuffer.value=n}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(n){this.defines.DEPTH_PACKING=n.toFixed(0),this.needsUpdate=!0}setDepthBuffer(n,e=Lt){this.depthBuffer=n,this.depthPacking=e}setShaderData(n){this.setShaderParts(n.shaderParts),this.setDefines(n.defines),this.setUniforms(n.uniforms),this.setExtensions(n.extensions)}setShaderParts(n){return this.fragmentShader=Ml.replace(k.FRAGMENT_HEAD,n.get(k.FRAGMENT_HEAD)||"").replace(k.FRAGMENT_MAIN_UV,n.get(k.FRAGMENT_MAIN_UV)||"").replace(k.FRAGMENT_MAIN_IMAGE,n.get(k.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=Cl.replace(k.VERTEX_HEAD,n.get(k.VERTEX_HEAD)||"").replace(k.VERTEX_MAIN_SUPPORT,n.get(k.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(n){for(const e of n.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(n){for(const e of n.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(n){this.extensions={};for(const e of n)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(n){this.encodeOutput!==n&&(n?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(n){return this.encodeOutput}setOutputEncodingEnabled(n){this.encodeOutput=n}get time(){return this.uniforms.time.value}set time(n){this.uniforms.time.value=n}setDeltaTime(n){this.uniforms.time.value+=n}adoptCameraSettings(n){this.copyCameraSettings(n)}copyCameraSettings(n){n&&(this.uniforms.cameraNear.value=n.near,this.uniforms.cameraFar.value=n.far,n instanceof Di?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(n,e){const t=this.uniforms;t.resolution.value.set(n,e),t.texelSize.value.set(1/n,1/e),t.aspect.value=n/e}static get Section(){return k}};function fs(n,e,t){for(const i of e){const s="$1"+n+i.charAt(0).toUpperCase()+i.slice(1),r=new RegExp("([^\\.])(\\b"+i+"\\b)","g");for(const a of t.entries())a[1]!==null&&t.set(a[0],a[1].replace(r,s))}}function Dl(n,e,t){let i=e.getFragmentShader(),s=e.getVertexShader();const r=i!==void 0&&/mainImage/.test(i),a=i!==void 0&&/mainUv/.test(i);if(t.attributes|=e.getAttributes(),i===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(a&&t.attributes&je.CONVOLUTION)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!r&&!a)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const o=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,l=t.shaderParts;let h=l.get(k.FRAGMENT_HEAD)||"",c=l.get(k.FRAGMENT_MAIN_UV)||"",d=l.get(k.FRAGMENT_MAIN_IMAGE)||"",f=l.get(k.VERTEX_HEAD)||"",p=l.get(k.VERTEX_MAIN_SUPPORT)||"";const m=new Set,u=new Set;if(a&&(c+=`	${n}MainUv(UV);
`,t.uvTransformation=!0),s!==null&&/mainSupport/.test(s)){const _=/mainSupport *\([\w\s]*?uv\s*?\)/.test(s);p+=`	${n}MainSupport(`,p+=_?`vUv);
`:`);
`;for(const v of s.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const w of v[1].split(/\s*,\s*/))t.varyings.add(w),m.add(w),u.add(w);for(const v of s.matchAll(o))u.add(v[1])}for(const _ of i.matchAll(o))u.add(_[1]);for(const _ of e.defines.keys())u.add(_.replace(/\([\w\s,]*\)/g,""));for(const _ of e.uniforms.keys())u.add(_);u.delete("while"),u.delete("for"),u.delete("if"),e.uniforms.forEach((_,v)=>t.uniforms.set(n+v.charAt(0).toUpperCase()+v.slice(1),_)),e.defines.forEach((_,v)=>t.defines.set(n+v.charAt(0).toUpperCase()+v.slice(1),_));const g=new Map([["fragment",i],["vertex",s]]);fs(n,u,t.defines),fs(n,u,g),i=g.get("fragment"),s=g.get("vertex");const x=e.blendMode;if(t.blendModes.set(x.blendFunction,x),r){e.inputColorSpace!==null&&e.inputColorSpace!==t.colorSpace&&(d+=e.inputColorSpace===ee?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==Ds?t.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(t.colorSpace=e.inputColorSpace);const _=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;d+=`${n}MainImage(color0, UV, `,t.attributes&je.DEPTH&&_.test(i)&&(d+="depth, ",t.readDepth=!0),d+=`color1);
	`;const v=n+"BlendOpacity";t.uniforms.set(v,x.opacity),d+=`color0 = blend${x.blendFunction}(color0, color1, ${v});

	`,h+=`uniform float ${v};

`}if(h+=i+`
`,s!==null&&(f+=s+`
`),l.set(k.FRAGMENT_HEAD,h),l.set(k.FRAGMENT_MAIN_UV,c),l.set(k.FRAGMENT_MAIN_IMAGE,d),l.set(k.VERTEX_HEAD,f),l.set(k.VERTEX_MAIN_SUPPORT,p),e.extensions!==null)for(const _ of e.extensions)t.extensions.add(_)}}var ps=class extends Be{constructor(n,...e){super("EffectPass"),this.fullscreenMaterial=new Pl(null,null,null,n),this.listener=t=>this.handleEvent(t),this.effects=[],this.setEffects(e),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(n){for(const e of this.effects)e.mainScene=n}set mainCamera(n){this.fullscreenMaterial.copyCameraSettings(n);for(const e of this.effects)e.mainCamera=n}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(n){this.fullscreenMaterial.encodeOutput=n}get dithering(){return this.fullscreenMaterial.dithering}set dithering(n){const e=this.fullscreenMaterial;e.dithering=n,e.needsUpdate=!0}setEffects(n){for(const e of this.effects)e.removeEventListener("change",this.listener);this.effects=n.sort((e,t)=>t.attributes-e.attributes);for(const e of this.effects)e.addEventListener("change",this.listener)}updateMaterial(){const n=new Do;let e=0;for(const a of this.effects)if(a.blendMode.blendFunction===M.DST)n.attributes|=a.getAttributes()&je.DEPTH;else{if(n.attributes&a.getAttributes()&je.CONVOLUTION)throw new Error(`Convolution effects cannot be merged (${a.name})`);Dl("e"+e++,a,n)}let t=n.shaderParts.get(k.FRAGMENT_HEAD),i=n.shaderParts.get(k.FRAGMENT_MAIN_IMAGE),s=n.shaderParts.get(k.FRAGMENT_MAIN_UV);const r=/\bblend\b/g;for(const a of n.blendModes.values())t+=a.getShaderCode().replace(r,`blend${a.blendFunction}`)+`
`;n.attributes&je.DEPTH?(n.readDepth&&(i=`float depth = readDepth(UV);

	`+i),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,n.colorSpace===ee&&(i+=`color0 = sRGBToLinear(color0);
	`),n.uvTransformation?(s=`vec2 transformedUv = vUv;
`+s,n.defines.set("UV","transformedUv")):n.defines.set("UV","vUv"),n.shaderParts.set(k.FRAGMENT_HEAD,t),n.shaderParts.set(k.FRAGMENT_MAIN_IMAGE,i),n.shaderParts.set(k.FRAGMENT_MAIN_UV,s);for(const[a,o]of n.shaderParts)o!==null&&n.shaderParts.set(a,o.trim().replace(/^#/,`
#`));this.skipRendering=e===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(n)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(n,e=Lt){this.fullscreenMaterial.depthBuffer=n,this.fullscreenMaterial.depthPacking=e;for(const t of this.effects)t.setDepthTexture(n,e)}render(n,e,t,i,s){for(const r of this.effects)r.update(n,e,i);if(!this.skipRendering||this.renderToScreen){const r=this.fullscreenMaterial;r.inputBuffer=e.texture,r.time+=i*this.timeScale,n.setRenderTarget(this.renderToScreen?null:t),n.render(this.scene,this.camera)}}setSize(n,e){this.fullscreenMaterial.setSize(n,e);for(const t of this.effects)t.setSize(n,e)}initialize(n,e,t){this.renderer=n;for(const i of this.effects)i.initialize(n,e,t);this.updateMaterial(),t!==void 0&&t!==Je&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const n of this.effects)n.removeEventListener("change",this.listener),n.dispose()}handleEvent(n){switch(n.type){case"change":this.recompile();break}}};/**
 * lil-gui
 * https://lil-gui.georgealways.com
 * @version 0.17.0
 * @author George Michael Brower
 * @license MIT
 */class Le{constructor(e,t,i,s,r="div"){this.parent=e,this.object=t,this.property=i,this._disabled=!1,this._hidden=!1,this.initialValue=this.getValue(),this.domElement=document.createElement("div"),this.domElement.classList.add("controller"),this.domElement.classList.add(s),this.$name=document.createElement("div"),this.$name.classList.add("name"),Le.nextNameID=Le.nextNameID||0,this.$name.id="lil-gui-name-"+ ++Le.nextNameID,this.$widget=document.createElement(r),this.$widget.classList.add("widget"),this.$disable=this.$widget,this.domElement.appendChild(this.$name),this.domElement.appendChild(this.$widget),this.parent.children.push(this),this.parent.controllers.push(this),this.parent.$children.appendChild(this.domElement),this._listenCallback=this._listenCallback.bind(this),this.name(i)}name(e){return this._name=e,this.$name.innerHTML=e,this}onChange(e){return this._onChange=e,this}_callOnChange(){this.parent._callOnChange(this),this._onChange!==void 0&&this._onChange.call(this,this.getValue()),this._changed=!0}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(){this._changed&&(this.parent._callOnFinishChange(this),this._onFinishChange!==void 0&&this._onFinishChange.call(this,this.getValue())),this._changed=!1}reset(){return this.setValue(this.initialValue),this._callOnFinishChange(),this}enable(e=!0){return this.disable(!e)}disable(e=!0){return e===this._disabled||(this._disabled=e,this.domElement.classList.toggle("disabled",e),this.$disable.toggleAttribute("disabled",e)),this}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}options(e){const t=this.parent.add(this.object,this.property,e);return t.name(this._name),this.destroy(),t}min(e){return this}max(e){return this}step(e){return this}decimals(e){return this}listen(e=!0){return this._listening=e,this._listenCallbackID!==void 0&&(cancelAnimationFrame(this._listenCallbackID),this._listenCallbackID=void 0),this._listening&&this._listenCallback(),this}_listenCallback(){this._listenCallbackID=requestAnimationFrame(this._listenCallback);const e=this.save();e!==this._listenPrevValue&&this.updateDisplay(),this._listenPrevValue=e}getValue(){return this.object[this.property]}setValue(e){return this.object[this.property]=e,this._callOnChange(),this.updateDisplay(),this}updateDisplay(){return this}load(e){return this.setValue(e),this._callOnFinishChange(),this}save(){return this.getValue()}destroy(){this.listen(!1),this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.controllers.splice(this.parent.controllers.indexOf(this),1),this.parent.$children.removeChild(this.domElement)}}class Rl extends Le{constructor(e,t,i){super(e,t,i,"boolean","label"),this.$input=document.createElement("input"),this.$input.setAttribute("type","checkbox"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$input.addEventListener("change",()=>{this.setValue(this.$input.checked),this._callOnFinishChange()}),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.checked=this.getValue(),this}}function _n(n){let e,t;return(e=n.match(/(#|0x)?([a-f0-9]{6})/i))?t=e[2]:(e=n.match(/rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\)/))?t=parseInt(e[1]).toString(16).padStart(2,0)+parseInt(e[2]).toString(16).padStart(2,0)+parseInt(e[3]).toString(16).padStart(2,0):(e=n.match(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i))&&(t=e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),!!t&&"#"+t}const kl={isPrimitive:!0,match:n=>typeof n=="string",fromHexString:_n,toHexString:_n},si={isPrimitive:!0,match:n=>typeof n=="number",fromHexString:n=>parseInt(n.substring(1),16),toHexString:n=>"#"+n.toString(16).padStart(6,0)},Ol={isPrimitive:!1,match:Array.isArray,fromHexString(n,e,t=1){const i=si.fromHexString(n);e[0]=(i>>16&255)/255*t,e[1]=(i>>8&255)/255*t,e[2]=(255&i)/255*t},toHexString:([n,e,t],i=1)=>si.toHexString(n*(i=255/i)<<16^e*i<<8^t*i<<0)},Fl={isPrimitive:!1,match:n=>Object(n)===n,fromHexString(n,e,t=1){const i=si.fromHexString(n);e.r=(i>>16&255)/255*t,e.g=(i>>8&255)/255*t,e.b=(255&i)/255*t},toHexString:({r:n,g:e,b:t},i=1)=>si.toHexString(n*(i=255/i)<<16^e*i<<8^t*i<<0)},Ll=[kl,si,Ol,Fl];class Il extends Le{constructor(e,t,i,s){var r;super(e,t,i,"color"),this.$input=document.createElement("input"),this.$input.setAttribute("type","color"),this.$input.setAttribute("tabindex",-1),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$text=document.createElement("input"),this.$text.setAttribute("type","text"),this.$text.setAttribute("spellcheck","false"),this.$text.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$display.appendChild(this.$input),this.$widget.appendChild(this.$display),this.$widget.appendChild(this.$text),this._format=(r=this.initialValue,Ll.find(a=>a.match(r))),this._rgbScale=s,this._initialValueHexString=this.save(),this._textFocused=!1,this.$input.addEventListener("input",()=>{this._setValueFromHexString(this.$input.value)}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$text.addEventListener("input",()=>{const a=_n(this.$text.value);a&&this._setValueFromHexString(a)}),this.$text.addEventListener("focus",()=>{this._textFocused=!0,this.$text.select()}),this.$text.addEventListener("blur",()=>{this._textFocused=!1,this.updateDisplay(),this._callOnFinishChange()}),this.$disable=this.$text,this.updateDisplay()}reset(){return this._setValueFromHexString(this._initialValueHexString),this}_setValueFromHexString(e){if(this._format.isPrimitive){const t=this._format.fromHexString(e);this.setValue(t)}else this._format.fromHexString(e,this.getValue(),this._rgbScale),this._callOnChange(),this.updateDisplay()}save(){return this._format.toHexString(this.getValue(),this._rgbScale)}load(e){return this._setValueFromHexString(e),this._callOnFinishChange(),this}updateDisplay(){return this.$input.value=this._format.toHexString(this.getValue(),this._rgbScale),this._textFocused||(this.$text.value=this.$input.value.substring(1)),this.$display.style.backgroundColor=this.$input.value,this}}class Zi extends Le{constructor(e,t,i){super(e,t,i,"function"),this.$button=document.createElement("button"),this.$button.appendChild(this.$name),this.$widget.appendChild(this.$button),this.$button.addEventListener("click",s=>{s.preventDefault(),this.getValue().call(this.object)}),this.$button.addEventListener("touchstart",()=>{},{passive:!0}),this.$disable=this.$button}}class Bl extends Le{constructor(e,t,i,s,r,a){super(e,t,i,"number"),this._initInput(),this.min(s),this.max(r);const o=a!==void 0;this.step(o?a:this._getImplicitStep(),o),this.updateDisplay()}decimals(e){return this._decimals=e,this.updateDisplay(),this}min(e){return this._min=e,this._onUpdateMinMax(),this}max(e){return this._max=e,this._onUpdateMinMax(),this}step(e,t=!0){return this._step=e,this._stepExplicit=t,this}updateDisplay(){const e=this.getValue();if(this._hasSlider){let t=(e-this._min)/(this._max-this._min);t=Math.max(0,Math.min(t,1)),this.$fill.style.width=100*t+"%"}return this._inputFocused||(this.$input.value=this._decimals===void 0?e:e.toFixed(this._decimals)),this}_initInput(){this.$input=document.createElement("input"),this.$input.setAttribute("type","number"),this.$input.setAttribute("step","any"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$disable=this.$input;const e=c=>{const d=parseFloat(this.$input.value);isNaN(d)||(this._snapClampSetValue(d+c),this.$input.value=this.getValue())};let t,i,s,r,a,o=!1;const l=c=>{if(o){const d=c.clientX-t,f=c.clientY-i;Math.abs(f)>5?(c.preventDefault(),this.$input.blur(),o=!1,this._setDraggingStyle(!0,"vertical")):Math.abs(d)>5&&h()}if(!o){const d=c.clientY-s;a-=d*this._step*this._arrowKeyMultiplier(c),r+a>this._max?a=this._max-r:r+a<this._min&&(a=this._min-r),this._snapClampSetValue(r+a)}s=c.clientY},h=()=>{this._setDraggingStyle(!1,"vertical"),this._callOnFinishChange(),window.removeEventListener("mousemove",l),window.removeEventListener("mouseup",h)};this.$input.addEventListener("input",()=>{let c=parseFloat(this.$input.value);isNaN(c)||(this._stepExplicit&&(c=this._snap(c)),this.setValue(this._clamp(c)))}),this.$input.addEventListener("keydown",c=>{c.code==="Enter"&&this.$input.blur(),c.code==="ArrowUp"&&(c.preventDefault(),e(this._step*this._arrowKeyMultiplier(c))),c.code==="ArrowDown"&&(c.preventDefault(),e(this._step*this._arrowKeyMultiplier(c)*-1))}),this.$input.addEventListener("wheel",c=>{this._inputFocused&&(c.preventDefault(),e(this._step*this._normalizeMouseWheel(c)))},{passive:!1}),this.$input.addEventListener("mousedown",c=>{t=c.clientX,i=s=c.clientY,o=!0,r=this.getValue(),a=0,window.addEventListener("mousemove",l),window.addEventListener("mouseup",h)}),this.$input.addEventListener("focus",()=>{this._inputFocused=!0}),this.$input.addEventListener("blur",()=>{this._inputFocused=!1,this.updateDisplay(),this._callOnFinishChange()})}_initSlider(){this._hasSlider=!0,this.$slider=document.createElement("div"),this.$slider.classList.add("slider"),this.$fill=document.createElement("div"),this.$fill.classList.add("fill"),this.$slider.appendChild(this.$fill),this.$widget.insertBefore(this.$slider,this.$input),this.domElement.classList.add("hasSlider");const e=f=>{const p=this.$slider.getBoundingClientRect();let m=(u=f,g=p.left,x=p.right,_=this._min,v=this._max,(u-g)/(x-g)*(v-_)+_);var u,g,x,_,v;this._snapClampSetValue(m)},t=f=>{e(f.clientX)},i=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",i)};let s,r,a=!1;const o=f=>{f.preventDefault(),this._setDraggingStyle(!0),e(f.touches[0].clientX),a=!1},l=f=>{if(a){const p=f.touches[0].clientX-s,m=f.touches[0].clientY-r;Math.abs(p)>Math.abs(m)?o(f):(window.removeEventListener("touchmove",l),window.removeEventListener("touchend",h))}else f.preventDefault(),e(f.touches[0].clientX)},h=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("touchmove",l),window.removeEventListener("touchend",h)},c=this._callOnFinishChange.bind(this);let d;this.$slider.addEventListener("mousedown",f=>{this._setDraggingStyle(!0),e(f.clientX),window.addEventListener("mousemove",t),window.addEventListener("mouseup",i)}),this.$slider.addEventListener("touchstart",f=>{f.touches.length>1||(this._hasScrollBar?(s=f.touches[0].clientX,r=f.touches[0].clientY,a=!0):o(f),window.addEventListener("touchmove",l,{passive:!1}),window.addEventListener("touchend",h))},{passive:!1}),this.$slider.addEventListener("wheel",f=>{if(Math.abs(f.deltaX)<Math.abs(f.deltaY)&&this._hasScrollBar)return;f.preventDefault();const p=this._normalizeMouseWheel(f)*this._step;this._snapClampSetValue(this.getValue()+p),this.$input.value=this.getValue(),clearTimeout(d),d=setTimeout(c,400)},{passive:!1})}_setDraggingStyle(e,t="horizontal"){this.$slider&&this.$slider.classList.toggle("active",e),document.body.classList.toggle("lil-gui-dragging",e),document.body.classList.toggle("lil-gui-"+t,e)}_getImplicitStep(){return this._hasMin&&this._hasMax?(this._max-this._min)/1e3:.1}_onUpdateMinMax(){!this._hasSlider&&this._hasMin&&this._hasMax&&(this._stepExplicit||this.step(this._getImplicitStep(),!1),this._initSlider(),this.updateDisplay())}_normalizeMouseWheel(e){let{deltaX:t,deltaY:i}=e;return Math.floor(e.deltaY)!==e.deltaY&&e.wheelDelta&&(t=0,i=-e.wheelDelta/120,i*=this._stepExplicit?1:10),t+-i}_arrowKeyMultiplier(e){let t=this._stepExplicit?1:10;return e.shiftKey?t*=10:e.altKey&&(t/=10),t}_snap(e){const t=Math.round(e/this._step)*this._step;return parseFloat(t.toPrecision(15))}_clamp(e){return e<this._min&&(e=this._min),e>this._max&&(e=this._max),e}_snapClampSetValue(e){this.setValue(this._clamp(this._snap(e)))}get _hasScrollBar(){const e=this.parent.root.$children;return e.scrollHeight>e.clientHeight}get _hasMin(){return this._min!==void 0}get _hasMax(){return this._max!==void 0}}class zl extends Le{constructor(e,t,i,s){super(e,t,i,"option"),this.$select=document.createElement("select"),this.$select.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this._values=Array.isArray(s)?s:Object.values(s),this._names=Array.isArray(s)?s:Object.keys(s),this._names.forEach(r=>{const a=document.createElement("option");a.innerHTML=r,this.$select.appendChild(a)}),this.$select.addEventListener("change",()=>{this.setValue(this._values[this.$select.selectedIndex]),this._callOnFinishChange()}),this.$select.addEventListener("focus",()=>{this.$display.classList.add("focus")}),this.$select.addEventListener("blur",()=>{this.$display.classList.remove("focus")}),this.$widget.appendChild(this.$select),this.$widget.appendChild(this.$display),this.$disable=this.$select,this.updateDisplay()}updateDisplay(){const e=this.getValue(),t=this._values.indexOf(e);return this.$select.selectedIndex=t,this.$display.innerHTML=t===-1?e:this._names[t],this}}class Ul extends Le{constructor(e,t,i){super(e,t,i,"string"),this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$input.addEventListener("input",()=>{this.setValue(this.$input.value)}),this.$input.addEventListener("keydown",s=>{s.code==="Enter"&&this.$input.blur()}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$widget.appendChild(this.$input),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.value=this.getValue(),this}}let ms=!1;class Vn{constructor({parent:e,autoPlace:t=e===void 0,container:i,width:s,title:r="Controls",injectStyles:a=!0,touchStyles:o=!0}={}){if(this.parent=e,this.root=e?e.root:this,this.children=[],this.controllers=[],this.folders=[],this._closed=!1,this._hidden=!1,this.domElement=document.createElement("div"),this.domElement.classList.add("lil-gui"),this.$title=document.createElement("div"),this.$title.classList.add("title"),this.$title.setAttribute("role","button"),this.$title.setAttribute("aria-expanded",!0),this.$title.setAttribute("tabindex",0),this.$title.addEventListener("click",()=>this.openAnimated(this._closed)),this.$title.addEventListener("keydown",l=>{l.code!=="Enter"&&l.code!=="Space"||(l.preventDefault(),this.$title.click())}),this.$title.addEventListener("touchstart",()=>{},{passive:!0}),this.$children=document.createElement("div"),this.$children.classList.add("children"),this.domElement.appendChild(this.$title),this.domElement.appendChild(this.$children),this.title(r),o&&this.domElement.classList.add("allow-touch-styles"),this.parent)return this.parent.children.push(this),this.parent.folders.push(this),void this.parent.$children.appendChild(this.domElement);this.domElement.classList.add("root"),!ms&&a&&(function(l){const h=document.createElement("style");h.innerHTML=l;const c=document.querySelector("head link[rel=stylesheet], head style");c?document.head.insertBefore(h,c):document.head.appendChild(h)}('.lil-gui{--background-color:#1f1f1f;--text-color:#ebebeb;--title-background-color:#111;--title-text-color:#ebebeb;--widget-color:#424242;--hover-color:#4f4f4f;--focus-color:#595959;--number-color:#2cc9ff;--string-color:#a2db3c;--font-size:11px;--input-font-size:11px;--font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;--font-family-mono:Menlo,Monaco,Consolas,"Droid Sans Mono",monospace;--padding:4px;--spacing:4px;--widget-height:20px;--name-width:45%;--slider-knob-width:2px;--slider-input-width:27%;--color-input-width:27%;--slider-input-min-width:45px;--color-input-min-width:45px;--folder-indent:7px;--widget-padding:0 0 0 3px;--widget-border-radius:2px;--checkbox-size:calc(var(--widget-height)*0.75);--scrollbar-width:5px;background-color:var(--background-color);color:var(--text-color);font-family:var(--font-family);font-size:var(--font-size);font-style:normal;font-weight:400;line-height:1;text-align:left;touch-action:manipulation;user-select:none;-webkit-user-select:none}.lil-gui,.lil-gui *{box-sizing:border-box;margin:0;padding:0}.lil-gui.root{display:flex;flex-direction:column;width:var(--width,245px)}.lil-gui.root>.title{background:var(--title-background-color);color:var(--title-text-color)}.lil-gui.root>.children{overflow-x:hidden;overflow-y:auto}.lil-gui.root>.children::-webkit-scrollbar{background:var(--background-color);height:var(--scrollbar-width);width:var(--scrollbar-width)}.lil-gui.root>.children::-webkit-scrollbar-thumb{background:var(--focus-color);border-radius:var(--scrollbar-width)}.lil-gui.force-touch-styles{--widget-height:28px;--padding:6px;--spacing:6px;--font-size:13px;--input-font-size:16px;--folder-indent:10px;--scrollbar-width:7px;--slider-input-min-width:50px;--color-input-min-width:65px}.lil-gui.autoPlace{max-height:100%;position:fixed;right:15px;top:0;z-index:1001}.lil-gui .controller{align-items:center;display:flex;margin:var(--spacing) 0;padding:0 var(--padding)}.lil-gui .controller.disabled{opacity:.5}.lil-gui .controller.disabled,.lil-gui .controller.disabled *{pointer-events:none!important}.lil-gui .controller>.name{flex-shrink:0;line-height:var(--widget-height);min-width:var(--name-width);padding-right:var(--spacing);white-space:pre}.lil-gui .controller .widget{align-items:center;display:flex;min-height:var(--widget-height);position:relative;width:100%}.lil-gui .controller.string input{color:var(--string-color)}.lil-gui .controller.boolean .widget{cursor:pointer}.lil-gui .controller.color .display{border-radius:var(--widget-border-radius);height:var(--widget-height);position:relative;width:100%}.lil-gui .controller.color input[type=color]{cursor:pointer;height:100%;opacity:0;width:100%}.lil-gui .controller.color input[type=text]{flex-shrink:0;font-family:var(--font-family-mono);margin-left:var(--spacing);min-width:var(--color-input-min-width);width:var(--color-input-width)}.lil-gui .controller.option select{max-width:100%;opacity:0;position:absolute;width:100%}.lil-gui .controller.option .display{background:var(--widget-color);border-radius:var(--widget-border-radius);height:var(--widget-height);line-height:var(--widget-height);max-width:100%;overflow:hidden;padding-left:.55em;padding-right:1.75em;pointer-events:none;position:relative;word-break:break-all}.lil-gui .controller.option .display.active{background:var(--focus-color)}.lil-gui .controller.option .display:after{bottom:0;content:"↕";font-family:lil-gui;padding-right:.375em;position:absolute;right:0;top:0}.lil-gui .controller.option .widget,.lil-gui .controller.option select{cursor:pointer}.lil-gui .controller.number input{color:var(--number-color)}.lil-gui .controller.number.hasSlider input{flex-shrink:0;margin-left:var(--spacing);min-width:var(--slider-input-min-width);width:var(--slider-input-width)}.lil-gui .controller.number .slider{background-color:var(--widget-color);border-radius:var(--widget-border-radius);cursor:ew-resize;height:var(--widget-height);overflow:hidden;padding-right:var(--slider-knob-width);touch-action:pan-y;width:100%}.lil-gui .controller.number .slider.active{background-color:var(--focus-color)}.lil-gui .controller.number .slider.active .fill{opacity:.95}.lil-gui .controller.number .fill{border-right:var(--slider-knob-width) solid var(--number-color);box-sizing:content-box;height:100%}.lil-gui-dragging .lil-gui{--hover-color:var(--widget-color)}.lil-gui-dragging *{cursor:ew-resize!important}.lil-gui-dragging.lil-gui-vertical *{cursor:ns-resize!important}.lil-gui .title{--title-height:calc(var(--widget-height) + var(--spacing)*1.25);-webkit-tap-highlight-color:transparent;text-decoration-skip:objects;cursor:pointer;font-weight:600;height:var(--title-height);line-height:calc(var(--title-height) - 4px);outline:none;padding:0 var(--padding)}.lil-gui .title:before{content:"▾";display:inline-block;font-family:lil-gui;padding-right:2px}.lil-gui .title:active{background:var(--title-background-color);opacity:.75}.lil-gui.root>.title:focus{text-decoration:none!important}.lil-gui.closed>.title:before{content:"▸"}.lil-gui.closed>.children{opacity:0;transform:translateY(-7px)}.lil-gui.closed:not(.transition)>.children{display:none}.lil-gui.transition>.children{overflow:hidden;pointer-events:none;transition-duration:.3s;transition-property:height,opacity,transform;transition-timing-function:cubic-bezier(.2,.6,.35,1)}.lil-gui .children:empty:before{content:"Empty";display:block;font-style:italic;height:var(--widget-height);line-height:var(--widget-height);margin:var(--spacing) 0;opacity:.5;padding:0 var(--padding)}.lil-gui.root>.children>.lil-gui>.title{border-width:0;border-bottom:1px solid var(--widget-color);border-left:0 solid var(--widget-color);border-right:0 solid var(--widget-color);border-top:1px solid var(--widget-color);transition:border-color .3s}.lil-gui.root>.children>.lil-gui.closed>.title{border-bottom-color:transparent}.lil-gui+.controller{border-top:1px solid var(--widget-color);margin-top:0;padding-top:var(--spacing)}.lil-gui .lil-gui .lil-gui>.title{border:none}.lil-gui .lil-gui .lil-gui>.children{border:none;border-left:2px solid var(--widget-color);margin-left:var(--folder-indent)}.lil-gui .lil-gui .controller{border:none}.lil-gui input{-webkit-tap-highlight-color:transparent;background:var(--widget-color);border:0;border-radius:var(--widget-border-radius);color:var(--text-color);font-family:var(--font-family);font-size:var(--input-font-size);height:var(--widget-height);outline:none;width:100%}.lil-gui input:disabled{opacity:1}.lil-gui input[type=number],.lil-gui input[type=text]{padding:var(--widget-padding)}.lil-gui input[type=number]:focus,.lil-gui input[type=text]:focus{background:var(--focus-color)}.lil-gui input::-webkit-inner-spin-button,.lil-gui input::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.lil-gui input[type=number]{-moz-appearance:textfield}.lil-gui input[type=checkbox]{appearance:none;-webkit-appearance:none;border-radius:var(--widget-border-radius);cursor:pointer;height:var(--checkbox-size);text-align:center;width:var(--checkbox-size)}.lil-gui input[type=checkbox]:checked:before{content:"✓";font-family:lil-gui;font-size:var(--checkbox-size);line-height:var(--checkbox-size)}.lil-gui button{-webkit-tap-highlight-color:transparent;background:var(--widget-color);border:1px solid var(--widget-color);border-radius:var(--widget-border-radius);color:var(--text-color);cursor:pointer;font-family:var(--font-family);font-size:var(--font-size);height:var(--widget-height);line-height:calc(var(--widget-height) - 4px);outline:none;text-align:center;text-transform:none;width:100%}.lil-gui button:active{background:var(--focus-color)}@font-face{font-family:lil-gui;src:url("data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==") format("woff")}@media (pointer:coarse){.lil-gui.allow-touch-styles{--widget-height:28px;--padding:6px;--spacing:6px;--font-size:13px;--input-font-size:16px;--folder-indent:10px;--scrollbar-width:7px;--slider-input-min-width:50px;--color-input-min-width:65px}}@media (hover:hover){.lil-gui .controller.color .display:hover:before{border:1px solid #fff9;border-radius:var(--widget-border-radius);bottom:0;content:" ";display:block;left:0;position:absolute;right:0;top:0}.lil-gui .controller.option .display.focus{background:var(--focus-color)}.lil-gui .controller.option .widget:hover .display{background:var(--hover-color)}.lil-gui .controller.number .slider:hover{background-color:var(--hover-color)}body:not(.lil-gui-dragging) .lil-gui .title:hover{background:var(--title-background-color);opacity:.85}.lil-gui .title:focus{text-decoration:underline var(--focus-color)}.lil-gui input:hover{background:var(--hover-color)}.lil-gui input:active{background:var(--focus-color)}.lil-gui input[type=checkbox]:focus{box-shadow:inset 0 0 0 1px var(--focus-color)}.lil-gui button:hover{background:var(--hover-color);border-color:var(--hover-color)}.lil-gui button:focus{border-color:var(--focus-color)}}'),ms=!0),i?i.appendChild(this.domElement):t&&(this.domElement.classList.add("autoPlace"),document.body.appendChild(this.domElement)),s&&this.domElement.style.setProperty("--width",s+"px"),this.domElement.addEventListener("keydown",l=>l.stopPropagation()),this.domElement.addEventListener("keyup",l=>l.stopPropagation())}add(e,t,i,s,r){if(Object(i)===i)return new zl(this,e,t,i);const a=e[t];switch(typeof a){case"number":return new Bl(this,e,t,i,s,r);case"boolean":return new Rl(this,e,t);case"string":return new Ul(this,e,t);case"function":return new Zi(this,e,t)}console.error(`gui.add failed
	property:`,t,`
	object:`,e,`
	value:`,a)}addColor(e,t,i=1){return new Il(this,e,t,i)}addFolder(e){return new Vn({parent:this,title:e})}load(e,t=!0){return e.controllers&&this.controllers.forEach(i=>{i instanceof Zi||i._name in e.controllers&&i.load(e.controllers[i._name])}),t&&e.folders&&this.folders.forEach(i=>{i._title in e.folders&&i.load(e.folders[i._title])}),this}save(e=!0){const t={controllers:{},folders:{}};return this.controllers.forEach(i=>{if(!(i instanceof Zi)){if(i._name in t.controllers)throw new Error(`Cannot save GUI with duplicate property "${i._name}"`);t.controllers[i._name]=i.save()}}),e&&this.folders.forEach(i=>{if(i._title in t.folders)throw new Error(`Cannot save GUI with duplicate folder "${i._title}"`);t.folders[i._title]=i.save()}),t}open(e=!0){return this._closed=!e,this.$title.setAttribute("aria-expanded",!this._closed),this.domElement.classList.toggle("closed",this._closed),this}close(){return this.open(!1)}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}openAnimated(e=!0){return this._closed=!e,this.$title.setAttribute("aria-expanded",!this._closed),requestAnimationFrame(()=>{const t=this.$children.clientHeight;this.$children.style.height=t+"px",this.domElement.classList.add("transition");const i=r=>{r.target===this.$children&&(this.$children.style.height="",this.domElement.classList.remove("transition"),this.$children.removeEventListener("transitionend",i))};this.$children.addEventListener("transitionend",i);const s=e?this.$children.scrollHeight:0;this.domElement.classList.toggle("closed",!e),requestAnimationFrame(()=>{this.$children.style.height=s+"px"})}),this}title(e){return this._title=e,this.$title.innerHTML=e,this}reset(e=!0){return(e?this.controllersRecursive():this.controllers).forEach(t=>t.reset()),this}onChange(e){return this._onChange=e,this}_callOnChange(e){this.parent&&this.parent._callOnChange(e),this._onChange!==void 0&&this._onChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(e){this.parent&&this.parent._callOnFinishChange(e),this._onFinishChange!==void 0&&this._onFinishChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}destroy(){this.parent&&(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.folders.splice(this.parent.folders.indexOf(this),1)),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement),Array.from(this.children).forEach(e=>e.destroy())}controllersRecursive(){let e=Array.from(this.controllers);return this.folders.forEach(t=>{e=e.concat(t.controllersRecursive())}),e}foldersRecursive(){let e=Array.from(this.folders);return this.folders.forEach(t=>{e=e.concat(t.foldersRecursive())}),e}}const at=new Os,ie=new R,$e=new R,V=new Me,gs={X:new R(1,0,0),Y:new R(0,1,0),Z:new R(0,0,1)},ji={type:"change"},_s={type:"mouseDown",mode:null},vs={type:"mouseUp",mode:null},xs={type:"objectChange"};class Nl extends ia{constructor(e,t=null){super(void 0,t);const i=new Xl(this);this._root=i;const s=new Ql;this._gizmo=s,i.add(s);const r=new Wl;this._plane=r,i.add(r);const a=this;function o(v,w){let y=w;Object.defineProperty(a,v,{get:function(){return y!==void 0?y:w},set:function(S){y!==S&&(y=S,r[v]=S,s[v]=S,a.dispatchEvent({type:v+"-changed",value:S}),a.dispatchEvent(ji))}}),a[v]=w,r[v]=w,s[v]=w}o("camera",e),o("object",void 0),o("enabled",!0),o("axis",null),o("mode","translate"),o("translationSnap",null),o("rotationSnap",null),o("scaleSnap",null),o("space","world"),o("size",1),o("dragging",!1),o("showX",!0),o("showY",!0),o("showZ",!0);const l=new R,h=new R,c=new Me,d=new Me,f=new R,p=new Me,m=new R,u=new R,g=new R,x=0,_=new R;o("worldPosition",l),o("worldPositionStart",h),o("worldQuaternion",c),o("worldQuaternionStart",d),o("cameraPosition",f),o("cameraQuaternion",p),o("pointStart",m),o("pointEnd",u),o("rotationAxis",g),o("rotationAngle",x),o("eye",_),this._offset=new R,this._startNorm=new R,this._endNorm=new R,this._cameraScale=new R,this._parentPosition=new R,this._parentQuaternion=new Me,this._parentQuaternionInv=new Me,this._parentScale=new R,this._worldScaleStart=new R,this._worldQuaternionInv=new Me,this._worldScale=new R,this._positionStart=new R,this._quaternionStart=new Me,this._scaleStart=new R,this._getPointer=Hl.bind(this),this._onPointerDown=Vl.bind(this),this._onPointerHover=Gl.bind(this),this._onPointerMove=$l.bind(this),this._onPointerUp=Yl.bind(this),t!==null&&this.connect()}connect(){this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.style.touchAction="auto"}getHelper(){return this._root}pointerHover(e){if(this.object===void 0||this.dragging===!0)return;e!==null&&at.setFromCamera(e,this.camera);const t=qi(this._gizmo.picker[this.mode],at);t?this.axis=t.object.name:this.axis=null}pointerDown(e){if(!(this.object===void 0||this.dragging===!0||e!=null&&e.button!==0)&&this.axis!==null){e!==null&&at.setFromCamera(e,this.camera);const t=qi(this._plane,at,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,_s.mode=this.mode,this.dispatchEvent(_s)}}pointerMove(e){const t=this.axis,i=this.mode,s=this.object;let r=this.space;if(i==="scale"?r="local":(t==="E"||t==="XYZE"||t==="XYZ")&&(r="world"),s===void 0||t===null||this.dragging===!1||e!==null&&e.button!==-1)return;e!==null&&at.setFromCamera(e,this.camera);const a=qi(this._plane,at,!0);if(a){if(this.pointEnd.copy(a.point).sub(this.worldPositionStart),i==="translate")this._offset.copy(this.pointEnd).sub(this.pointStart),r==="local"&&t!=="XYZ"&&this._offset.applyQuaternion(this._worldQuaternionInv),t.indexOf("X")===-1&&(this._offset.x=0),t.indexOf("Y")===-1&&(this._offset.y=0),t.indexOf("Z")===-1&&(this._offset.z=0),r==="local"&&t!=="XYZ"?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),s.position.copy(this._offset).add(this._positionStart),this.translationSnap&&(r==="local"&&(s.position.applyQuaternion(V.copy(this._quaternionStart).invert()),t.search("X")!==-1&&(s.position.x=Math.round(s.position.x/this.translationSnap)*this.translationSnap),t.search("Y")!==-1&&(s.position.y=Math.round(s.position.y/this.translationSnap)*this.translationSnap),t.search("Z")!==-1&&(s.position.z=Math.round(s.position.z/this.translationSnap)*this.translationSnap),s.position.applyQuaternion(this._quaternionStart)),r==="world"&&(s.parent&&s.position.add(ie.setFromMatrixPosition(s.parent.matrixWorld)),t.search("X")!==-1&&(s.position.x=Math.round(s.position.x/this.translationSnap)*this.translationSnap),t.search("Y")!==-1&&(s.position.y=Math.round(s.position.y/this.translationSnap)*this.translationSnap),t.search("Z")!==-1&&(s.position.z=Math.round(s.position.z/this.translationSnap)*this.translationSnap),s.parent&&s.position.sub(ie.setFromMatrixPosition(s.parent.matrixWorld))));else if(i==="scale"){if(t.search("XYZ")!==-1){let o=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(o*=-1),$e.set(o,o,o)}else ie.copy(this.pointStart),$e.copy(this.pointEnd),ie.applyQuaternion(this._worldQuaternionInv),$e.applyQuaternion(this._worldQuaternionInv),$e.divide(ie),t.search("X")===-1&&($e.x=1),t.search("Y")===-1&&($e.y=1),t.search("Z")===-1&&($e.z=1);s.scale.copy(this._scaleStart).multiply($e),this.scaleSnap&&(t.search("X")!==-1&&(s.scale.x=Math.round(s.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),t.search("Y")!==-1&&(s.scale.y=Math.round(s.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),t.search("Z")!==-1&&(s.scale.z=Math.round(s.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(i==="rotate"){this._offset.copy(this.pointEnd).sub(this.pointStart);const o=20/this.worldPosition.distanceTo(ie.setFromMatrixPosition(this.camera.matrixWorld));let l=!1;t==="XYZE"?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(ie.copy(this.rotationAxis).cross(this.eye))*o):(t==="X"||t==="Y"||t==="Z")&&(this.rotationAxis.copy(gs[t]),ie.copy(gs[t]),r==="local"&&ie.applyQuaternion(this.worldQuaternion),ie.cross(this.eye),ie.length()===0?l=!0:this.rotationAngle=this._offset.dot(ie.normalize())*o),(t==="E"||l)&&(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),r==="local"&&t!=="E"&&t!=="XYZE"?(s.quaternion.copy(this._quaternionStart),s.quaternion.multiply(V.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),s.quaternion.copy(V.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),s.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(ji),this.dispatchEvent(xs)}}pointerUp(e){e!==null&&e.button!==0||(this.dragging&&this.axis!==null&&(vs.mode=this.mode,this.dispatchEvent(vs)),this.dragging=!1,this.axis=null)}dispose(){this.disconnect(),this.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})}attach(e){return this.object=e,this._root.visible=!0,this}detach(){return this.object=void 0,this.axis=null,this._root.visible=!1,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(ji),this.dispatchEvent(xs),this.pointStart.copy(this.pointEnd))}getRaycaster(){return at}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}}function Hl(n){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:n.button};{const e=this.domElement.getBoundingClientRect();return{x:(n.clientX-e.left)/e.width*2-1,y:-(n.clientY-e.top)/e.height*2+1,button:n.button}}}function Gl(n){if(this.enabled)switch(n.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(n));break}}function Vl(n){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(n.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(n)),this.pointerDown(this._getPointer(n)))}function $l(n){this.enabled&&this.pointerMove(this._getPointer(n))}function Yl(n){this.enabled&&(this.domElement.releasePointerCapture(n.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(n)))}function qi(n,e,t){const i=e.intersectObject(n,!0);for(let s=0;s<i.length;s++)if(i[s].object.visible||t)return i[s];return!1}const di=new Is,z=new R(0,1,0),ys=new R(0,0,0),ws=new Fs,fi=new Me,vi=new Me,De=new R,bs=new Fs,Yt=new R(1,0,0),ht=new R(0,1,0),Xt=new R(0,0,1),pi=new R,Nt=new R,Ht=new R;class Xl extends Ki{constructor(e){super(),this.isTransformControlsRoot=!0,this.controls=e,this.visible=!1}updateMatrixWorld(e){const t=this.controls;t.object!==void 0&&(t.object.updateMatrixWorld(),t.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):t.object.parent.matrixWorld.decompose(t._parentPosition,t._parentQuaternion,t._parentScale),t.object.matrixWorld.decompose(t.worldPosition,t.worldQuaternion,t._worldScale),t._parentQuaternionInv.copy(t._parentQuaternion).invert(),t._worldQuaternionInv.copy(t.worldQuaternion).invert()),t.camera.updateMatrixWorld(),t.camera.matrixWorld.decompose(t.cameraPosition,t.cameraQuaternion,t._cameraScale),t.camera.isOrthographicCamera?t.camera.getWorldDirection(t.eye).negate():t.eye.copy(t.cameraPosition).sub(t.worldPosition).normalize(),super.updateMatrixWorld(e)}}class Ql extends Ki{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const e=new Tn({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new Ls({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),i=e.clone();i.opacity=.15;const s=t.clone();s.opacity=.5;const r=e.clone();r.color.setHex(16711680);const a=e.clone();a.color.setHex(65280);const o=e.clone();o.color.setHex(255);const l=e.clone();l.color.setHex(16711680),l.opacity=.5;const h=e.clone();h.color.setHex(65280),h.opacity=.5;const c=e.clone();c.color.setHex(255),c.opacity=.5;const d=e.clone();d.opacity=.25;const f=e.clone();f.color.setHex(16776960),f.opacity=.25,e.clone().color.setHex(16776960);const m=e.clone();m.color.setHex(7895160);const u=new oe(0,.04,.1,12);u.translate(0,.05,0);const g=new te(.08,.08,.08);g.translate(0,.04,0);const x=new jt;x.setAttribute("position",new Xn([0,0,0,1,0,0],3));const _=new oe(.0075,.0075,.5,3);_.translate(0,.25,0);function v(O,G){const F=new zt(O,.0075,3,64,G*Math.PI*2);return F.rotateY(Math.PI/2),F.rotateX(Math.PI/2),F}function w(){const O=new jt;return O.setAttribute("position",new Xn([0,0,0,1,1,1],3)),O}const y={X:[[new A(u,r),[.5,0,0],[0,0,-Math.PI/2]],[new A(u,r),[-.5,0,0],[0,0,Math.PI/2]],[new A(_,r),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new A(u,a),[0,.5,0]],[new A(u,a),[0,-.5,0],[Math.PI,0,0]],[new A(_,a)]],Z:[[new A(u,o),[0,0,.5],[Math.PI/2,0,0]],[new A(u,o),[0,0,-.5],[-Math.PI/2,0,0]],[new A(_,o),null,[Math.PI/2,0,0]]],XYZ:[[new A(new hi(.1,0),d.clone()),[0,0,0]]],XY:[[new A(new te(.15,.15,.01),c.clone()),[.15,.15,0]]],YZ:[[new A(new te(.15,.15,.01),l.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new A(new te(.15,.15,.01),h.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},S={X:[[new A(new oe(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new A(new oe(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new A(new oe(.2,0,.6,4),i),[0,.3,0]],[new A(new oe(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new A(new oe(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new A(new oe(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new A(new hi(.2,0),i)]],XY:[[new A(new te(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new A(new te(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new A(new te(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]]},T={START:[[new A(new hi(.01,2),s),null,null,null,"helper"]],END:[[new A(new hi(.01,2),s),null,null,null,"helper"]],DELTA:[[new ze(w(),s),null,null,null,"helper"]],X:[[new ze(x,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new ze(x,s.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new ze(x,s.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},E={XYZE:[[new A(v(.5,1),m),null,[0,Math.PI/2,0]]],X:[[new A(v(.5,.5),r)]],Y:[[new A(v(.5,.5),a),null,[0,0,-Math.PI/2]]],Z:[[new A(v(.5,.5),o),null,[0,Math.PI/2,0]]],E:[[new A(v(.75,1),f),null,[0,Math.PI/2,0]]]},b={AXIS:[[new ze(x,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},D={XYZE:[[new A(new na(.25,10,8),i)]],X:[[new A(new zt(.5,.1,4,24),i),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new A(new zt(.5,.1,4,24),i),[0,0,0],[Math.PI/2,0,0]]],Z:[[new A(new zt(.5,.1,4,24),i),[0,0,0],[0,0,-Math.PI/2]]],E:[[new A(new zt(.75,.1,2,24),i)]]},H={X:[[new A(g,r),[.5,0,0],[0,0,-Math.PI/2]],[new A(_,r),[0,0,0],[0,0,-Math.PI/2]],[new A(g,r),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new A(g,a),[0,.5,0]],[new A(_,a)],[new A(g,a),[0,-.5,0],[0,0,Math.PI]]],Z:[[new A(g,o),[0,0,.5],[Math.PI/2,0,0]],[new A(_,o),[0,0,0],[Math.PI/2,0,0]],[new A(g,o),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new A(new te(.15,.15,.01),c),[.15,.15,0]]],YZ:[[new A(new te(.15,.15,.01),l),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new A(new te(.15,.15,.01),h),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new A(new te(.1,.1,.1),d.clone())]]},L={X:[[new A(new oe(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new A(new oe(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new A(new oe(.2,0,.6,4),i),[0,.3,0]],[new A(new oe(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new A(new oe(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new A(new oe(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new A(new te(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new A(new te(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new A(new te(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new A(new te(.2,.2,.2),i),[0,0,0]]]},I={X:[[new ze(x,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new ze(x,s.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new ze(x,s.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function B(O){const G=new Ki;for(const F in O)for(let q=O[F].length;q--;){const j=O[F][q][0].clone(),Ce=O[F][q][1],Pe=O[F][q][2],xe=O[F][q][3],oi=O[F][q][4];j.name=F,j.tag=oi,Ce&&j.position.set(Ce[0],Ce[1],Ce[2]),Pe&&j.rotation.set(Pe[0],Pe[1],Pe[2]),xe&&j.scale.set(xe[0],xe[1],xe[2]),j.updateMatrix();const ye=j.geometry.clone();ye.applyMatrix4(j.matrix),j.geometry=ye,j.renderOrder=1/0,j.position.set(0,0,0),j.rotation.set(0,0,0),j.scale.set(1,1,1),G.add(j)}return G}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=B(y)),this.add(this.gizmo.rotate=B(E)),this.add(this.gizmo.scale=B(H)),this.add(this.picker.translate=B(S)),this.add(this.picker.rotate=B(D)),this.add(this.picker.scale=B(L)),this.add(this.helper.translate=B(T)),this.add(this.helper.rotate=B(b)),this.add(this.helper.scale=B(I)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(e){const i=(this.mode==="scale"?"local":this.space)==="local"?this.worldQuaternion:vi;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let s=[];s=s.concat(this.picker[this.mode].children),s=s.concat(this.gizmo[this.mode].children),s=s.concat(this.helper[this.mode].children);for(let r=0;r<s.length;r++){const a=s[r];a.visible=!0,a.rotation.set(0,0,0),a.position.copy(this.worldPosition);let o;if(this.camera.isOrthographicCamera?o=(this.camera.top-this.camera.bottom)/this.camera.zoom:o=this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),a.scale.set(1,1,1).multiplyScalar(o*this.size/4),a.tag==="helper"){a.visible=!1,a.name==="AXIS"?(a.visible=!!this.axis,this.axis==="X"&&(V.setFromEuler(di.set(0,0,0)),a.quaternion.copy(i).multiply(V),Math.abs(z.copy(Yt).applyQuaternion(i).dot(this.eye))>.9&&(a.visible=!1)),this.axis==="Y"&&(V.setFromEuler(di.set(0,0,Math.PI/2)),a.quaternion.copy(i).multiply(V),Math.abs(z.copy(ht).applyQuaternion(i).dot(this.eye))>.9&&(a.visible=!1)),this.axis==="Z"&&(V.setFromEuler(di.set(0,Math.PI/2,0)),a.quaternion.copy(i).multiply(V),Math.abs(z.copy(Xt).applyQuaternion(i).dot(this.eye))>.9&&(a.visible=!1)),this.axis==="XYZE"&&(V.setFromEuler(di.set(0,Math.PI/2,0)),z.copy(this.rotationAxis),a.quaternion.setFromRotationMatrix(ws.lookAt(ys,z,ht)),a.quaternion.multiply(V),a.visible=this.dragging),this.axis==="E"&&(a.visible=!1)):a.name==="START"?(a.position.copy(this.worldPositionStart),a.visible=this.dragging):a.name==="END"?(a.position.copy(this.worldPosition),a.visible=this.dragging):a.name==="DELTA"?(a.position.copy(this.worldPositionStart),a.quaternion.copy(this.worldQuaternionStart),ie.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),ie.applyQuaternion(this.worldQuaternionStart.clone().invert()),a.scale.copy(ie),a.visible=this.dragging):(a.quaternion.copy(i),this.dragging?a.position.copy(this.worldPositionStart):a.position.copy(this.worldPosition),this.axis&&(a.visible=this.axis.search(a.name)!==-1));continue}a.quaternion.copy(i),this.mode==="translate"||this.mode==="scale"?(a.name==="X"&&Math.abs(z.copy(Yt).applyQuaternion(i).dot(this.eye))>.99&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),a.name==="Y"&&Math.abs(z.copy(ht).applyQuaternion(i).dot(this.eye))>.99&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),a.name==="Z"&&Math.abs(z.copy(Xt).applyQuaternion(i).dot(this.eye))>.99&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),a.name==="XY"&&Math.abs(z.copy(Xt).applyQuaternion(i).dot(this.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),a.name==="YZ"&&Math.abs(z.copy(Yt).applyQuaternion(i).dot(this.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),a.name==="XZ"&&Math.abs(z.copy(ht).applyQuaternion(i).dot(this.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1)):this.mode==="rotate"&&(fi.copy(i),z.copy(this.eye).applyQuaternion(V.copy(i).invert()),a.name.search("E")!==-1&&a.quaternion.setFromRotationMatrix(ws.lookAt(this.eye,ys,ht)),a.name==="X"&&(V.setFromAxisAngle(Yt,Math.atan2(-z.y,z.z)),V.multiplyQuaternions(fi,V),a.quaternion.copy(V)),a.name==="Y"&&(V.setFromAxisAngle(ht,Math.atan2(z.x,z.z)),V.multiplyQuaternions(fi,V),a.quaternion.copy(V)),a.name==="Z"&&(V.setFromAxisAngle(Xt,Math.atan2(z.y,z.x)),V.multiplyQuaternions(fi,V),a.quaternion.copy(V))),a.visible=a.visible&&(a.name.indexOf("X")===-1||this.showX),a.visible=a.visible&&(a.name.indexOf("Y")===-1||this.showY),a.visible=a.visible&&(a.name.indexOf("Z")===-1||this.showZ),a.visible=a.visible&&(a.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),a.material._color=a.material._color||a.material.color.clone(),a.material._opacity=a.material._opacity||a.material.opacity,a.material.color.copy(a.material._color),a.material.opacity=a.material._opacity,this.enabled&&this.axis&&(a.name===this.axis||this.axis.split("").some(function(l){return a.name===l}))&&(a.material.color.setHex(16776960),a.material.opacity=1)}super.updateMatrixWorld(e)}}class Wl extends A{constructor(){super(new sa(1e5,1e5,2,2),new Tn({visible:!1,wireframe:!0,side:Gt,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(t="local"),pi.copy(Yt).applyQuaternion(t==="local"?this.worldQuaternion:vi),Nt.copy(ht).applyQuaternion(t==="local"?this.worldQuaternion:vi),Ht.copy(Xt).applyQuaternion(t==="local"?this.worldQuaternion:vi),z.copy(Nt),this.mode){case"translate":case"scale":switch(this.axis){case"X":z.copy(this.eye).cross(pi),De.copy(pi).cross(z);break;case"Y":z.copy(this.eye).cross(Nt),De.copy(Nt).cross(z);break;case"Z":z.copy(this.eye).cross(Ht),De.copy(Ht).cross(z);break;case"XY":De.copy(Ht);break;case"YZ":De.copy(pi);break;case"XZ":z.copy(Ht),De.copy(Nt);break;case"XYZ":case"E":De.set(0,0,0);break}break;case"rotate":default:De.set(0,0,0)}De.length()===0?this.quaternion.copy(this.cameraQuaternion):(bs.lookAt(ie.set(0,0,0),De,z),this.quaternion.setFromRotationMatrix(bs)),super.updateMatrixWorld(e)}}const Xr=document.querySelector(".snap-container");function vn(n=null,e=null){const t=Xr.scrollTop,i=window.innerHeight;if(n&&e){const s=n.offsetTop,a=e.offsetTop-s,o=Math.min(Math.max(t-s,0),a);return a>0?o/a:1}else if(n){const r=n.offsetTop,a=Math.min(Math.max(t,0),r);return r>0?a/r:1}else{const s=document.documentElement.scrollHeight-i;return s>0?t/s:1}}function Zl(n){const e=Xr.scrollTop,t=n.length-1;for(let i=0;i<t;i++){const s=n[i].offsetTop,r=i<t-1?n[i+1].offsetTop:1/0;if(e>=s&&e<r)return i}return 0}const Ss=1,Ts=0,jl=document.querySelector(".snap-container");class ql{constructor(e,t,i,s,r,a){this.model=e,this.camera=s,this.canvas=r,this.scene=a,this.positionPoints=t,this.posSectionRange=[],this.numOfPosSections=0;for(let o=0;o<this.positionPoints.length;o++)this.positionPoints[o].keyframe&&this.numOfPosSections++;for(let o=0;o<this.numOfPosSections;o++)this.positionPoints[o].keyframe?this.posSectionRange.push(new Object({min:o*(1/this.numOfPosSections),max:(o+1)*(1/this.numOfPosSections)})):this.posSectionRange[o-1].max+=1/this.numOfPosSections;this.rotationPoints=i,this.rotSectionRange=[],this.numOfRotSections=0;for(let o=0;o<this.rotationPoints.length;o++)this.rotationPoints[o].keyframe&&this.numOfRotSections++;for(let o=0;o<this.numOfRotSections;o++)this.rotationPoints[o].keyframe?this.rotSectionRange.push(new Object({min:o*(1/this.numOfRotSections),max:(o+1)*(1/this.numOfRotSections)})):this.rotSectionRange[o-1].max+=1/this.numOfRotSections;this.curveHandles=[],this.lerpValue=.1,this.action=Ts,this.initCurves(t,i),this.positionLine=this.createPositionLine(),this.initRaycaster(),this.addScrollListener()}addKeyframes(e){this.keyframe=e,this.updateTargetTransformKeyframe(this.keyframe.currentSection,this.keyframe.progress[this.keyframe.currentSection])}initCurves(e,t){this.createHandles(e),this.positionSpline=new Qn(this.curveHandles.map(i=>i.position)),this.rotationSpline=new Qn(t.map(i=>new R(i.x,i.y,i.z))),this.targetPosition=new R,this.targetQuaternion=new Me,this.targetRotation=new Is}createHandles(e){e.forEach(t=>{const i=new A(new te(.1,.1,.1),new Tn({color:6710886}));i.position.copy(t),this.curveHandles.push(i)})}createPositionLine(){const t=this.positionSpline.getPoints(50);return new ze(new jt().setFromPoints(t),new Ls({color:3355647}))}initRaycaster(){this.mouse=new pe,this.rayCaster=new Os,this.control=new Nl(this.camera,this.canvas),this.control.addEventListener("dragging-changed",e=>{e.value||this.updateLineGeometry()}),window.addEventListener("mousedown",this.handleMouseDown.bind(this))}updateLineGeometry(){const e=this.positionSpline.getPoints(50);this.positionLine.geometry.setFromPoints(e)}handleMouseDown(e){this.action=Ss,this.mouse.x=e.clientX/window.innerWidth*2-1,this.mouse.y=-(e.clientY/window.innerHeight)*2+1}updateTransformControls(){if(this.action===Ss){this.rayCaster.setFromCamera(this.mouse,this.camera),this.action=Ts;const e=this.rayCaster.intersectObjects(this.curveHandles,!1);if(e.length){const t=e[0].object;this.control.attach(t),this.scene.add(this.control.getHelper())}}}updateTargetTransform(e,t){console.log(e,t),this.targetPosition.copy(this.positionSpline.getPoint(e)),this.targetRotation.setFromVector3(this.rotationSpline.getPoint(t)),this.targetQuaternion.setFromEuler(this.targetRotation)}updateTargetTransformKeyframe(e,t){const i=Math.min(this.numOfPosSections-2,e),s=this.posSectionRange[i].min,r=this.posSectionRange[i].max,a=wi.mapLinear(t,0,1,s,r),o=this.rotSectionRange[i].min,l=this.rotSectionRange[i].max,h=wi.mapLinear(t,0,1,o,l);this.updateTargetTransform(a,h)}updateModelTransform(){this.model.position.lerp(this.targetPosition,this.lerpValue),this.model.quaternion.slerp(this.targetQuaternion,this.lerpValue)}addHandlesToScene(){this.curveHandles.forEach(e=>this.scene.add(e)),this.scene.add(this.positionLine)}removeHandlesFromScene(){this.curveHandles.forEach(e=>this.scene.remove(e)),this.scene.remove(this.positionLine),this.scene.remove(this.control.getHelper())}addScrollListener(){jl.addEventListener("scroll",()=>{this.updateTargetTransformKeyframe(this.keyframe.currentSection,this.keyframe.progress[this.keyframe.currentSection])})}update(){this.updateModelTransform(),this.updateTransformControls()}getPositionPoints(){return this.positionSpline.points}}class Kl{constructor(e){this.geometry=e,this.initialGeometry=new jt().copy(this.geometry),this.maxDistance=this.initialGeometry.boundingBox.max.x,this.waveLength=.002,this.waveAmplitude=.00125,this.waveSpeed=5}morph(e){const t=this.geometry.getAttribute("position"),i=this.initialGeometry.getAttribute("position"),s=e.getElapsedTime();for(let r=0;r<t.count;r++){const a=t.getX(r),o=t.getZ(r),l=Math.hypot(a,o),h=(this.maxDistance-l)/this.maxDistance,c=Math.sin(a*(1/this.waveLength)+s*this.waveSpeed)*this.waveAmplitude*h;t.setY(r,i.getY(r)+c)}this.geometry.computeVertexNormals(),t.needsUpdate=!0}}const Jl=document.querySelector(".snap-container");class eh{constructor(e){this.elements=e,this.numOfSection=e.length-1,this.currentSection=0,this.progress=new Array(this.numOfSection),this.wholeProgress=0,this.update(),Jl.addEventListener("scroll",()=>{this.update()})}update(){this.wholeProgress=vn();const e=Zl(this.elements);this.currentSection=e;for(let t=0;t<this.elements.length-1;t++){const i=this.elements[t],s=this.elements[t+1],r=vn(i,s);this.progress[t]=r}console.log(this.currentSection,this.progress,this.wholeProgress)}}const Es=.001,th=.001,Pi=-.01,xn=.05,yn=-100,As=-yn;let dt=Pi,ot,Ms,qe,wn;const ih=[],Qr={},nh=new ra,Oe=document.querySelector("#canvas"),sh=document.querySelector(".snap-container"),ri=new xi,Ke=new Di(30,Oe.clientWidth/Oe.clientHeight,.1,1e3);Ke.position.z=5;const Ot=new Bs({canvas:Oe,powerPreference:"high-performance",stencil:!1,depth:!1});Ot.setClearColor(13289157,1);Ot.setSize(Oe.clientWidth,Oe.clientHeight,!1);Ot.setAnimationLoop(ch);rh();function rh(){const n=new zs("white",.5);ri.add(n),[{color:"white",intensity:2,position:[.3,1,.2]},{color:"pink",intensity:.5,position:[0,-1,0]},{color:"salmon",intensity:.7,position:[1,0,-1]},{color:"slateblue",intensity:.3,position:[-1,-.5,.5]},{color:"white",intensity:2,position:[-1,0,.5]}].forEach(({color:t,intensity:i,position:s})=>{const r=new Us(t,i);r.position.set(...s),ri.add(r)})}const Bt=new bl(Ke,{worldFocusDistance:5,worldFocusRange:10,bokehScale:10});console.log(Bt);ah();function ah(){const n=new Po(Ot);n.addPass(new Al(ri,Ke)),n.addPass(new ps(Ke,Bt)),n.addPass(new ps(Ke,new El)),Qr.composer=n}oh();async function oh(){const[n,e]=await Promise.all([lh(),hh()]);ot=n.scene,console.log(ot);const t=new Ns({roughness:1,reflectivity:1});ot.traverse(i=>{i.isMesh&&(i.material=t)}),ot.scale.multiplyScalar(15),Ms=ot.children.find(i=>i.name=="top"),wn=new Kl(Ms.geometry),ri.add(ot),qe=new ql(ot,e.positionPoints,e.quaternionPoints,Ke,Oe,ri),qe.addKeyframes(ph),console.log(qe)}async function lh(){return await new Hs().loadAsync("../toy-project-2/disc.glb")}async function hh(){return await(await fetch("../toy-project-2/config.json")).json()}function ch(){qe&&wn&&(qe.update(),wn.morph(nh)),uh(),Qr.composer.render()}function uh(){ih.forEach(n=>{n.position.y+=dt,n.position.y<yn&&(n.position.y=As),n.position.y>As&&(n.position.y=yn),n.rotation.x+=Es,n.rotation.y+=Es}),dt=wi.clamp(dt+Math.sign(Pi-dt)*th,Pi,xn)}window.addEventListener("resize",()=>{Ke.aspect=Oe.clientWidth/Oe.clientHeight,Ke.updateProjectionMatrix(),Ot.setSize(Oe.clientWidth,Oe.clientHeight,!1),Ot.setPixelRatio(Math.min(window.devicePixelRatio,2))});let Cs=0;sh.addEventListener("scroll",()=>{dh()});function dh(){const n=vn(),e=Math.sign(n-Cs);dt+=e*Pi,dt=wi.clamp(dt,-xn,xn),Cs=n}const fh=document.querySelectorAll(".keyframe"),ph=new eh(fh),Ii=new Vn;Ii.show(!1);const Wr={logPositionPoints:function(){console.log(qe.positionSpline.points)},showTransformControls:!1};Ii.add(Wr,"logPositionPoints");Ii.add(Wr,"showTransformControls").onChange(n=>{n?qe.addHandlesToScene():qe.removeHandlesFromScene()});const Bi=Ii.addFolder("DepthOfField");Bi.add(Bt.cocMaterial,"worldFocusDistance",0,100,.1);Bi.add(Bt.cocMaterial,"worldFocusRange",0,10,.1);Bi.add(Bt,"bokehScale",0,10,.1);Bi.add(Bt.blendMode,"blendFunction",0,50,1);const mh=[{title:"17C 아이보리 포슬린",rgb:{r:245,g:235,b:225},description:"밝고 쿨한 느낌의 아이보리 색상으로 맑고 깨끗한 톤을 표현합니다.",materialConfig:{color:new Ae(245/255,235/255,225/255),metalness:.1,roughness:.8,reflectivity:.4}},{title:"19N 페어 베이지",rgb:{r:240,g:224,b:207},description:"뉴트럴 톤의 밝은 베이지로, 투명하고 자연스러운 색상입니다.",materialConfig:{color:new Ae(240/255,224/255,207/255),metalness:.1,roughness:.75,reflectivity:.5}},{title:"21C 라이트 누드",rgb:{r:235,g:215,b:200},description:"쿨톤의 밝은 누드 컬러로 차분하면서도 자연스러운 피부 톤입니다.",materialConfig:{color:new Ae(235/255,215/255,200/255),metalness:.2,roughness:.7,reflectivity:.5}},{title:"21W 소프트 샌드",rgb:{r:230,g:210,b:190},description:"웜톤의 밝은 베이지로 따뜻한 느낌을 주는 색상입니다.",materialConfig:{color:new Ae(230/255,210/255,190/255),metalness:.15,roughness:.65,reflectivity:.6}},{title:"23N 내추럴 베이지",rgb:{r:220,g:200,b:180},description:"뉴트럴 톤의 중간 베이지로, 대부분의 피부 톤에 잘 맞는 클래식한 색상입니다.",materialConfig:{color:new Ae(220/255,200/255,180/255),metalness:.2,roughness:.6,reflectivity:.65}},{title:"23W 웜 허니",rgb:{r:210,g:185,b:160},description:"웜톤의 건강한 베이지 톤으로 따뜻함을 강조하는 색상입니다.",materialConfig:{color:new Ae(210/255,185/255,160/255),metalness:.25,roughness:.5,reflectivity:.7}},{title:"25N 골든 베이지",rgb:{r:200,g:170,b:145},description:"뉴트럴 톤의 골드빛 베이지로, 자연스러운 태닝된 피부를 표현합니다.",materialConfig:{color:new Ae(200/255,170/255,145/255),metalness:.3,roughness:.45,reflectivity:.75}},{title:"27W 탠 카라멜",rgb:{r:180,g:140,b:110},description:"웜톤의 깊은 카라멜 브라운으로 중간 톤의 피부에 잘 맞는 색상입니다.",materialConfig:{color:new Ae(180/255,140/255,110/255),metalness:.35,roughness:.4,reflectivity:.8}},{title:"31N 딥 아몬드",rgb:{r:150,g:110,b:90},description:"뉴트럴 톤의 깊고 부드러운 아몬드 브라운으로 어두운 피부 톤에 적합합니다.",materialConfig:{color:new Ae(150/255,110/255,90/255),metalness:.4,roughness:.35,reflectivity:.85}},{title:"33C 리치 에스프레소",rgb:{r:90,g:60,b:50},description:"쿨톤의 다크 브라운으로, 깊고 풍부한 어두운 피부 톤을 위한 색상입니다.",materialConfig:{color:new Ae(90/255,60/255,50/255),metalness:.5,roughness:.3,reflectivity:.9}}],gh=new Hs;let bn;gh.load("../toy-project-2/shadeDisc.glb",n=>{bn=n.scene.children[0].geometry,_h(mh),console.log(bn)});function _h(n){const e=document.querySelector("#shadeCardContainer");n.forEach(({title:t,description:i,materialConfig:s})=>{const r=document.createElement("div");r.classList.add("shade-card");const a=document.createElement("div");a.classList.add("shade-canvas","border"),r.appendChild(a);const o=document.createElement("div");o.classList.add("shade-card-title"),o.textContent=t,r.appendChild(o);const l=document.createElement("div");l.classList.add("shade-card-description"),l.textContent=i,r.appendChild(l),e.appendChild(r),vh(a,s)})}function vh(n,e){const t=new xi,i=new Di(20,n.clientWidth/n.clientHeight,.1,1e3);i.position.z=10;const s=new Bs({antialias:!0,alpha:!0});s.setSize(n.clientWidth,n.clientHeight),s.setClearColor(0,0),n.appendChild(s.domElement);const r=new Ns(e),a=new A(bn,r);a.rotateX(Math.PI/4),a.rotateZ(Math.PI/2.5),t.add(a);const o=new zs(16777215,2);t.add(o),[{color:"white",intensity:1,position:[.3,1,.2]},{color:"pink",intensity:.5,position:[0,-1,0]},{color:"salmon",intensity:.7,position:[1,0,-1]},{color:"slateblue",intensity:.3,position:[-1,-.5,.5]},{color:"white",intensity:1,position:[-1,0,.5]}].forEach(({color:c,intensity:d,position:f})=>{const p=new Us(c,d);p.position.set(...f),t.add(p)});function h(){requestAnimationFrame(h),s.render(t,i)}h(),window.addEventListener("resize",()=>{const c=n.clientWidth,d=n.clientHeight;s.setSize(c,d),i.aspect=c/d,i.updateProjectionMatrix()})}
